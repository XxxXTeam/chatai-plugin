import{a6 as B,w as i,a7 as D,a8 as E,a9 as a,aa as t,O as F,ab as b,ac as I,ad as o,ae as R,ah as T,af as u,ai as r,N as v,B as f,al as m,ag as V}from"./index-DXh3Z4_f.js";import{b as N,M as A}from"./ModelSelector-CcjaxuBy.js";import"./Checkbox-C_x1OZs5.js";const H={__name:"ModelConfig",setup(O){const p=B(),C=i(!1),y=i(!1),d=i({llm:{defaultModel:"",embeddingModel:"",chatModel:"",codeModel:"",translationModel:""}}),k=i([]),M=i(!1),g=i("");async function $(){C.value=!0;try{const n=await b.get("/api/config");if(n.data.code===0){const e=n.data.data;d.value.llm={...d.value.llm,...e.llm}}const l=await b.get("/api/channels/list");if(l.data.code===0){const e=l.data.data,w=new Set;e.forEach(x=>{x.models&&x.models.forEach(z=>w.add(z))}),k.value=Array.from(w).sort()}}catch{p.error("获取数据失败")}finally{C.value=!1}}async function S(){y.value=!0;try{const n=await b.post("/api/config",{llm:d.value.llm});n.data.code===0?p.success("保存成功"):p.error(n.data.message)}catch{p.error("保存失败")}finally{y.value=!1}}function s(n){g.value=n,M.value=!0}function U(n){n.length>0&&(d.value.llm[g.value]=n[0]),M.value=!1}return D(()=>{$()}),(n,l)=>(I(),E(t(F),{vertical:""},{default:a(()=>[o(t(R),{title:"模型配置"},{default:a(()=>[o(t(T),{"label-placement":"left","label-width":"120"},{default:a(()=>[o(t(N),{"title-placement":"left"},{default:a(()=>[...l[16]||(l[16]=[u("全局默认",-1)])]),_:1}),o(t(r),{label:"默认模型"},{default:a(()=>[o(t(v),{value:d.value.llm.defaultModel,"onUpdate:value":l[1]||(l[1]=e=>d.value.llm.defaultModel=e),placeholder:"选择或输入模型名称",readonly:"",onClick:l[2]||(l[2]=e=>s("defaultModel"))},{suffix:a(()=>[o(t(f),{size:"small",onClick:l[0]||(l[0]=m(e=>s("defaultModel"),["stop"]))},{default:a(()=>[...l[17]||(l[17]=[u("选择",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),o(t(r),{label:"嵌入模型"},{default:a(()=>[o(t(v),{value:d.value.llm.embeddingModel,"onUpdate:value":l[4]||(l[4]=e=>d.value.llm.embeddingModel=e),placeholder:"选择或输入模型名称",readonly:"",onClick:l[5]||(l[5]=e=>s("embeddingModel"))},{suffix:a(()=>[o(t(f),{size:"small",onClick:l[3]||(l[3]=m(e=>s("embeddingModel"),["stop"]))},{default:a(()=>[...l[18]||(l[18]=[u("选择",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),o(t(N),{"title-placement":"left"},{default:a(()=>[...l[19]||(l[19]=[u("场景模式模型",-1)])]),_:1}),o(t(r),{label:"对话模式"},{default:a(()=>[o(t(v),{value:d.value.llm.chatModel,"onUpdate:value":l[7]||(l[7]=e=>d.value.llm.chatModel=e),placeholder:"默认使用全局模型",readonly:"",onClick:l[8]||(l[8]=e=>s("chatModel"))},{suffix:a(()=>[o(t(f),{size:"small",onClick:l[6]||(l[6]=m(e=>s("chatModel"),["stop"]))},{default:a(()=>[...l[20]||(l[20]=[u("选择",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),o(t(r),{label:"代码模式"},{default:a(()=>[o(t(v),{value:d.value.llm.codeModel,"onUpdate:value":l[10]||(l[10]=e=>d.value.llm.codeModel=e),placeholder:"默认使用全局模型",readonly:"",onClick:l[11]||(l[11]=e=>s("codeModel"))},{suffix:a(()=>[o(t(f),{size:"small",onClick:l[9]||(l[9]=m(e=>s("codeModel"),["stop"]))},{default:a(()=>[...l[21]||(l[21]=[u("选择",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),o(t(r),{label:"翻译模式"},{default:a(()=>[o(t(v),{value:d.value.llm.translationModel,"onUpdate:value":l[13]||(l[13]=e=>d.value.llm.translationModel=e),placeholder:"默认使用全局模型",readonly:"",onClick:l[14]||(l[14]=e=>s("translationModel"))},{suffix:a(()=>[o(t(f),{size:"small",onClick:l[12]||(l[12]=m(e=>s("translationModel"),["stop"]))},{default:a(()=>[...l[22]||(l[22]=[u("选择",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),o(t(r),null,{default:a(()=>[o(t(f),{type:"primary",onClick:S,loading:y.value},{default:a(()=>[...l[23]||(l[23]=[u("保存配置",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1}),o(t(V),{show:M.value,"onUpdate:show":l[15]||(l[15]=e=>M.value=e),preset:"card",title:"选择模型",style:{width:"800px","max-height":"85vh"}},{default:a(()=>[o(A,{"all-models":k.value,value:d.value.llm[g.value]?[d.value.llm[g.value]]:[],multiple:!1,"onUpdate:value":U},null,8,["all-models","value"])]),_:1},8,["show"])]),_:1}))}};export{H as default};
