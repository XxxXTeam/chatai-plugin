import{d as G,h as u,c as w,a as me,b as E,e as F,f as ee,u as oe,g as Be,i as be,p as ke,j as xe,r as Ae,k as Pe,l as Ce,m as Re,n as Te,o as De,q as Ne,N as q,s as de,B as U,t as ve,v as fe,w as C,x as Z,y as Ue,z as le,A as M,C as Ie,D as we,E as re,F as se,G as Ke,H as X,I as Y,J as Oe,K as ze,L as Fe,M as Ve,O as B,P as Me,Q as je,R as Le,_ as qe,S as Ee,T as We,U as Ge,V as i,W as n,X as W,Y as He,Z as r,$ as _e,a0 as L,a1 as ge,a2 as Je,a3 as k,a4 as Qe,a5 as Xe}from"./index-BPZ3RAI7.js";import{N as Ye,a as ie,M as Ze}from"./ModelSelector-DmvH9XzG.js";import{s as ea,r as aa,A as ta,a as la,N as na,b as ye,c as ra}from"./DataTable-Cp9IH1uV.js";import{A as ue,R as sa,N as H}from"./InputNumber-p5CE_I_f.js";import{N as _,a as ae}from"./Switch-h307EVvr.js";import{N as ia}from"./Popconfirm-C1o9AYCO.js";import"./Checkbox-CCWyWjIx.js";const ua=G({name:"ArrowUp",render(){return u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},u("g",{fill:"none"},u("path",{d:"M3.13 9.163a.5.5 0 1 0 .74.674L9.5 3.67V17.5a.5.5 0 0 0 1 0V3.672l5.63 6.165a.5.5 0 0 0 .738-.674l-6.315-6.916a.746.746 0 0 0-.632-.24a.746.746 0 0 0-.476.24L3.131 9.163z",fill:"currentColor"})))}}),y="0!important",Se="-1px!important";function J(l){return E(`${l}-type`,[F("& +",[w("button",{},[E(`${l}-type`,[ee("border",{borderLeftWidth:y}),ee("state-border",{left:Se})])])])])}function Q(l){return E(`${l}-type`,[F("& +",[w("button",[E(`${l}-type`,[ee("border",{borderTopWidth:y}),ee("state-border",{top:Se})])])])])}const oa=w("button-group",`
 flex-wrap: nowrap;
 display: inline-flex;
 position: relative;
`,[me("vertical",{flexDirection:"row"},[me("rtl",[w("button",[F("&:first-child:not(:last-child)",`
 margin-right: ${y};
 border-top-right-radius: ${y};
 border-bottom-right-radius: ${y};
 `),F("&:last-child:not(:first-child)",`
 margin-left: ${y};
 border-top-left-radius: ${y};
 border-bottom-left-radius: ${y};
 `),F("&:not(:first-child):not(:last-child)",`
 margin-left: ${y};
 margin-right: ${y};
 border-radius: ${y};
 `),J("default"),E("ghost",[J("primary"),J("info"),J("success"),J("warning"),J("error")])])])]),E("vertical",{flexDirection:"column"},[w("button",[F("&:first-child:not(:last-child)",`
 margin-bottom: ${y};
 margin-left: ${y};
 margin-right: ${y};
 border-bottom-left-radius: ${y};
 border-bottom-right-radius: ${y};
 `),F("&:last-child:not(:first-child)",`
 margin-top: ${y};
 margin-left: ${y};
 margin-right: ${y};
 border-top-left-radius: ${y};
 border-top-right-radius: ${y};
 `),F("&:not(:first-child):not(:last-child)",`
 margin: ${y};
 border-radius: ${y};
 `),Q("default"),E("ghost",[Q("primary"),Q("info"),Q("success"),Q("warning"),Q("error")])])])]),da={size:{type:String,default:void 0},vertical:Boolean},pa=G({name:"ButtonGroup",props:da,setup(l){const{mergedClsPrefixRef:o,mergedRtlRef:f}=oe(l);return Be("-button-group",oa,o),ke(xe,l),{rtlEnabled:be("ButtonGroup",f,o),mergedClsPrefix:o}},render(){const{mergedClsPrefix:l}=this;return u("div",{class:[`${l}-button-group`,this.rtlEnabled&&`${l}-button-group--rtl`,this.vertical&&`${l}-button-group--vertical`],role:"group"},this.$slots)}}),he=G({name:"RadioButton",props:aa,setup:ea,render(){const{mergedClsPrefix:l}=this;return u("label",{class:[`${l}-radio-button`,this.mergedDisabled&&`${l}-radio-button--disabled`,this.renderSafeChecked&&`${l}-radio-button--checked`,this.focus&&[`${l}-radio-button--focus`]]},u("input",{ref:"inputRef",type:"radio",class:`${l}-radio-input`,value:this.value,name:this.mergedName,checked:this.renderSafeChecked,disabled:this.mergedDisabled,onChange:this.handleRadioInputChange,onFocus:this.handleRadioInputFocus,onBlur:this.handleRadioInputBlur}),u("div",{class:`${l}-radio-button__state-border`}),Ae(this.$slots.default,o=>!o&&!this.label?null:u("div",{ref:"labelRef",class:`${l}-radio__label`},o||this.label)))}});function ca(){return De}const ma=Pe({name:"DynamicInput",common:Te,peers:{Input:Re,Button:Ce},self:ca}),pe=Ne("n-dynamic-input"),va=G({name:"DynamicInputInputPreset",props:{clsPrefix:{type:String,required:!0},value:{type:String,default:""},disabled:Boolean,parentPath:String,path:String,onUpdateValue:{type:Function,required:!0}},setup(){const{mergedThemeRef:l,placeholderRef:o}=de(pe);return{mergedTheme:l,placeholder:o}},render(){const{mergedTheme:l,placeholder:o,value:f,clsPrefix:p,onUpdateValue:m,disabled:g}=this;return u("div",{class:`${p}-dynamic-input-preset-input`},u(q,{theme:l.peers.Input,"theme-overrides":l.peerOverrides.Input,value:f,placeholder:o,onUpdateValue:m,disabled:g}))}}),fa=G({name:"DynamicInputPairPreset",props:{clsPrefix:{type:String,required:!0},value:{type:Object,default:()=>({key:"",value:""})},disabled:Boolean,parentPath:String,path:String,onUpdateValue:{type:Function,required:!0}},setup(l){const{mergedThemeRef:o,keyPlaceholderRef:f,valuePlaceholderRef:p}=de(pe);return{mergedTheme:o,keyPlaceholder:f,valuePlaceholder:p,handleKeyInput(m){l.onUpdateValue({key:m,value:l.value.value})},handleValueInput(m){l.onUpdateValue({key:l.value.key,value:m})}}},render(){const{mergedTheme:l,keyPlaceholder:o,valuePlaceholder:f,value:p,clsPrefix:m,disabled:g}=this;return u("div",{class:`${m}-dynamic-input-preset-pair`},u(q,{theme:l.peers.Input,"theme-overrides":l.peerOverrides.Input,value:p.key,class:`${m}-dynamic-input-pair-input`,placeholder:o,onUpdateValue:this.handleKeyInput,disabled:g}),u(q,{theme:l.peers.Input,"theme-overrides":l.peerOverrides.Input,value:p.value,class:`${m}-dynamic-input-pair-input`,placeholder:f,onUpdateValue:this.handleValueInput,disabled:g}))}}),ga=w("dynamic-input",{width:"100%"},[w("dynamic-input-item",`
 margin-bottom: 10px;
 display: flex;
 flex-wrap: nowrap;
 `,[w("dynamic-input-preset-input",{flex:1,alignItems:"center"}),w("dynamic-input-preset-pair",`
 flex: 1;
 display: flex;
 align-items: center;
 `,[w("dynamic-input-pair-input",[F("&:first-child",{"margin-right":"12px"})])]),ee("action",`
 align-self: flex-start;
 display: flex;
 justify-content: flex-end;
 flex-shrink: 0;
 flex-grow: 0;
 margin: var(--action-margin);
 `,[E("icon",{cursor:"pointer"})]),F("&:last-child",{marginBottom:0})]),w("form-item",`
 padding-top: 0 !important;
 margin-right: 0 !important;
 `,[w("form-item-blank",{paddingTop:"0 !important"})])]),te=new WeakMap,ya=Object.assign(Object.assign({},le.props),{max:Number,min:{type:Number,default:0},value:Array,defaultValue:{type:Array,default:()=>[]},preset:{type:String,default:"input"},keyField:String,itemClass:String,itemStyle:[String,Object],keyPlaceholder:{type:String,default:""},valuePlaceholder:{type:String,default:""},placeholder:{type:String,default:""},disabled:Boolean,showSortButton:Boolean,createButtonProps:Object,onCreate:Function,onRemove:Function,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onClear:Function,onInput:[Function,Array]}),ha=G({name:"DynamicInput",props:ya,setup(l,{slots:o}){const{mergedComponentPropsRef:f,mergedClsPrefixRef:p,mergedRtlRef:m,inlineThemeDisabled:g}=oe(),h=de(Oe,null),P=C(l.defaultValue),V=Z(l,"value"),b=Ue(V,P),I=le("DynamicInput","-dynamic-input",ga,ma,l,p),t=M(()=>{const{value:e}=b;if(Array.isArray(e)){const{max:a}=l;return a!==void 0&&e.length>=a}return!1}),K=M(()=>{const{value:e}=b;return Array.isArray(e)?e.length<=l.min:!0}),S=M(()=>{var e,a;return(a=(e=f?.value)===null||e===void 0?void 0:e.DynamicInput)===null||a===void 0?void 0:a.buttonSize});function T(e){const{onInput:a,"onUpdate:value":d,onUpdateValue:c}=l;a&&Y(a,e),d&&Y(d,e),c&&Y(c,e),P.value=e}function $(e,a){if(e==null||typeof e!="object")return a;const d=re(e)?se(e):e;let c=te.get(d);return c===void 0&&te.set(d,c=Ke()),c}function D(e,a){const{value:d}=b,c=Array.from(d??[]),z=c[e];if(c[e]=a,z&&a&&typeof z=="object"&&typeof a=="object"){const ne=re(z)?se(z):z,$e=re(a)?se(a):a,ce=te.get(ne);ce!==void 0&&te.set($e,ce)}T(c)}function x(){R(-1)}function R(e){const{value:a}=b,{onCreate:d}=l,c=Array.from(a??[]);if(d)c.splice(e+1,0,d(e+1)),T(c);else if(o.default)c.splice(e+1,0,null),T(c);else switch(l.preset){case"input":c.splice(e+1,0,""),T(c);break;case"pair":c.splice(e+1,0,{key:"",value:""}),T(c);break}}function A(e){const{value:a}=b;if(!Array.isArray(a))return;const{min:d}=l;if(a.length<=d)return;const{onRemove:c}=l;c&&c(e);const z=Array.from(a);z.splice(e,1),T(z)}function v(e,a,d){if(a<0||d<0||a>=e.length||d>=e.length||a===d)return;const c=e[a];e[a]=e[d],e[d]=c}function N(e,a){const{value:d}=b;if(!Array.isArray(d))return;const c=Array.from(d);e==="up"&&v(c,a,a-1),e==="down"&&v(c,a,a+1),T(c)}ke(pe,{mergedThemeRef:I,keyPlaceholderRef:Z(l,"keyPlaceholder"),valuePlaceholderRef:Z(l,"valuePlaceholder"),placeholderRef:Z(l,"placeholder")});const j=be("DynamicInput",m,p),O=M(()=>{const{self:{actionMargin:e,actionMarginRtl:a}}=I.value;return{"--action-margin":e,"--action-margin-rtl":a}}),s=g?Ie("dynamic-input",void 0,O,l):void 0;return{locale:we("DynamicInput").localeRef,rtlEnabled:j,buttonSize:S,mergedClsPrefix:p,NFormItem:h,uncontrolledValue:P,mergedValue:b,insertionDisabled:t,removeDisabled:K,handleCreateClick:x,ensureKey:$,handleValueChange:D,remove:A,move:N,createItem:R,mergedTheme:I,cssVars:g?void 0:O,themeClass:s?.themeClass,onRender:s?.onRender}},render(){const{$slots:l,itemClass:o,buttonSize:f,mergedClsPrefix:p,mergedValue:m,locale:g,mergedTheme:h,keyField:P,itemStyle:V,preset:b,showSortButton:I,NFormItem:t,ensureKey:K,handleValueChange:S,remove:T,createItem:$,move:D,onRender:x,disabled:R}=this;return x?.(),u("div",{class:[`${p}-dynamic-input`,this.rtlEnabled&&`${p}-dynamic-input--rtl`,this.themeClass],style:this.cssVars},!Array.isArray(m)||m.length===0?u(U,Object.assign({block:!0,ghost:!0,dashed:!0,size:f},this.createButtonProps,{disabled:this.insertionDisabled||R,theme:h.peers.Button,themeOverrides:h.peerOverrides.Button,onClick:this.handleCreateClick}),{default:()=>ve(l["create-button-default"],()=>[g.create]),icon:()=>ve(l["create-button-icon"],()=>[u(X,{clsPrefix:p},{default:()=>u(ue,null)})])}):m.map((A,v)=>u("div",{key:P?A[P]:K(A,v),"data-key":P?A[P]:K(A,v),class:[`${p}-dynamic-input-item`,o],style:V},fe(l.default,{value:m[v],index:v},()=>[b==="input"?u(va,{disabled:R,clsPrefix:p,value:m[v],parentPath:t?t.path.value:void 0,path:t?.path.value?`${t.path.value}[${v}]`:void 0,onUpdateValue:N=>{S(v,N)}}):b==="pair"?u(fa,{disabled:R,clsPrefix:p,value:m[v],parentPath:t?t.path.value:void 0,path:t?.path.value?`${t.path.value}[${v}]`:void 0,onUpdateValue:N=>{S(v,N)}}):null]),fe(l.action,{value:m[v],index:v,create:$,remove:T,move:D},()=>[u("div",{class:`${p}-dynamic-input-item__action`},u(pa,{size:f},{default:()=>[u(U,{disabled:this.removeDisabled||R,theme:h.peers.Button,themeOverrides:h.peerOverrides.Button,circle:!0,onClick:()=>{T(v)}},{icon:()=>u(X,{clsPrefix:p},{default:()=>u(sa,null)})}),u(U,{disabled:this.insertionDisabled||R,circle:!0,theme:h.peers.Button,themeOverrides:h.peerOverrides.Button,onClick:()=>{$(v)}},{icon:()=>u(X,{clsPrefix:p},{default:()=>u(ue,null)})}),I?u(U,{disabled:v===0||R,circle:!0,theme:h.peers.Button,themeOverrides:h.peerOverrides.Button,onClick:()=>{D("up",v)}},{icon:()=>u(X,{clsPrefix:p},{default:()=>u(ua,null)})}):null,I?u(U,{disabled:v===m.length-1||R,circle:!0,theme:h.peers.Button,themeOverrides:h.peerOverrides.Button,onClick:()=>{D("down",v)}},{icon:()=>u(X,{clsPrefix:p},{default:()=>u(ta,null)})}):null]}))]))))}}),ba=Pe({name:"DynamicTags",common:Te,peers:{Input:Re,Button:Ce,Tag:Fe,Space:ze},self(){return{inputWidth:"64px"}}}),ka=w("dynamic-tags",[w("input",{minWidth:"var(--n-input-width)"})]),Pa=Object.assign(Object.assign(Object.assign({},le.props),Le),{size:{type:String,default:"medium"},closable:{type:Boolean,default:!0},defaultValue:{type:Array,default:()=>[]},value:Array,inputClass:String,inputStyle:[String,Object],inputProps:Object,max:Number,tagClass:String,tagStyle:[String,Object],renderTag:Function,onCreate:{type:Function,default:l=>l},"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onChange:[Function,Array]}),Ca=G({name:"DynamicTags",props:Pa,slots:Object,setup(l){const{mergedClsPrefixRef:o,inlineThemeDisabled:f}=oe(l),{localeRef:p}=we("DynamicTags"),m=Me(l),{mergedDisabledRef:g}=m,h=C(""),P=C(!1),V=C(!0),b=C(null),I=le("DynamicTags","-dynamic-tags",ka,ba,l,o),t=C(l.defaultValue),K=Z(l,"value"),S=Ue(K,t),T=M(()=>p.value.add),$=M(()=>la(l.size)),D=M(()=>g.value||!!l.max&&S.value.length>=l.max);function x(e){const{onChange:a,"onUpdate:value":d,onUpdateValue:c}=l,{nTriggerFormInput:z,nTriggerFormChange:ne}=m;a&&Y(a,e),c&&Y(c,e),d&&Y(d,e),t.value=e,z(),ne()}function R(e){const a=S.value.slice(0);a.splice(e,1),x(a)}function A(e){switch(e.key){case"Enter":v()}}function v(e){const a=e??h.value;if(a){const d=S.value.slice(0);d.push(l.onCreate(a)),x(d)}P.value=!1,V.value=!0,h.value=""}function N(){v()}function j(){P.value=!0,je(()=>{var e;(e=b.value)===null||e===void 0||e.focus(),V.value=!1})}const O=M(()=>{const{self:{inputWidth:e}}=I.value;return{"--n-input-width":e}}),s=f?Ie("dynamic-tags",void 0,O,l):void 0;return{mergedClsPrefix:o,inputInstRef:b,localizedAdd:T,inputSize:$,inputValue:h,showInput:P,inputForceFocused:V,mergedValue:S,mergedDisabled:g,triggerDisabled:D,handleInputKeyDown:A,handleAddClick:j,handleInputBlur:N,handleCloseClick:R,handleInputConfirm:v,mergedTheme:I,cssVars:f?void 0:O,themeClass:s?.themeClass,onRender:s?.onRender}},render(){const{mergedTheme:l,cssVars:o,mergedClsPrefix:f,onRender:p,renderTag:m}=this;return p?.(),u(B,{class:[`${f}-dynamic-tags`,this.themeClass],size:"small",style:o,theme:l.peers.Space,themeOverrides:l.peerOverrides.Space,itemStyle:"display: flex;"},{default:()=>{const{mergedTheme:g,tagClass:h,tagStyle:P,type:V,round:b,size:I,color:t,closable:K,mergedDisabled:S,showInput:T,inputValue:$,inputClass:D,inputStyle:x,inputSize:R,inputForceFocused:A,triggerDisabled:v,handleInputKeyDown:N,handleInputBlur:j,handleAddClick:O,handleCloseClick:s,handleInputConfirm:e,$slots:a}=this;return this.mergedValue.map((d,c)=>m?m(d,c):u(Ve,{key:c,theme:g.peers.Tag,themeOverrides:g.peerOverrides.Tag,class:h,style:P,type:V,round:b,size:I,color:t,closable:K,disabled:S,onClose:()=>{s(c)}},{default:()=>typeof d=="string"?d:d.label})).concat(T?a.input?a.input({submit:e,deactivate:j}):u(q,Object.assign({placeholder:"",size:R,style:x,class:D,autosize:!0},this.inputProps,{ref:"inputInstRef",value:$,onUpdateValue:d=>{this.inputValue=d},theme:g.peers.Input,themeOverrides:g.peerOverrides.Input,onKeydown:N,onBlur:j,internalForceFocus:A})):a.trigger?a.trigger({activate:O,disabled:v}):u(U,{dashed:!0,disabled:v,theme:g.peers.Button,themeOverrides:g.peerOverrides.Button,size:R,onClick:O},{icon:()=>u(X,{clsPrefix:f},{default:()=>u(ue,null)})}))}})}}),Ra={style:{display:"flex","align-items":"center",width:"100%",gap:"10px"}},Ta={__name:"Channels",setup(l){const o=Ee(),f=C([]),p=C(!1),m=C(!1);C(!1);const g=C(!1),h=C(!1),P=C(""),V=C([]),b=C([]);C("");const I=C(null),t=C({name:"",adapterType:"openai",baseUrl:"",apiKey:"",apiKeys:[],strategy:"round-robin",models:[],priority:1,enabled:!0,advanced:{streaming:{enabled:!1,chunkSize:1024},thinking:{enableReasoning:!1,defaultLevel:"medium",adaptThinking:!0,sendThinkingAsMessage:!1},llm:{temperature:.7,maxTokens:4e3,topP:1,frequencyPenalty:0,presencePenalty:0}}}),K={name:{required:!0,message:"请输入名称",trigger:"blur"},adapterType:{required:!0,message:"请选择类型",trigger:"change"},baseUrl:{required:!0,message:"请输入BaseURL",trigger:"blur"},apiKey:{required:!0,message:"请输入API Key",trigger:"blur"}},S=[{title:"名称",key:"name"},{title:"类型",key:"adapterType"},{title:"BaseURL",key:"baseUrl",ellipsis:{tooltip:!0}},{title:"启用",key:"enabled",width:80,render(s){return u(_,{value:s.enabled,onUpdateValue:e=>T(s,e)})}},{title:"状态",key:"status",width:80,render(s){return u(Ve,{type:s.status==="active"?"success":s.status==="error"?"error":"default",size:"small"},{default:()=>s.status||"idle"})}},{title:"优先级",key:"priority",width:80,sorter:(s,e)=>s.priority-e.priority},{title:"操作",key:"actions",width:180,render(s){return u(B,{},{default:()=>[u(U,{size:"small",onClick:()=>A(s)},{default:()=>"测试"}),u(U,{size:"small",onClick:()=>x(s)},{default:()=>"编辑"}),u(ia,{onPositiveClick:()=>R(s)},{trigger:()=>u(U,{size:"small",type:"error"},{default:()=>"删除"}),default:()=>"确定要删除吗？"})]})}}];async function T(s,e){try{const a=await W.put(`/api/channels/${s.id}`,{...s,enabled:e});a.data.code===0?(o.success(e?"渠道已启用":"渠道已禁用"),$()):o.error(a.data.message)}catch(a){o.error("操作失败: "+(a.response?.data?.message||a.message))}}async function $(){try{const s=await W.get("/api/channels/list");s.data.code===0&&(f.value=s.data.data)}catch{o.error("获取渠道列表失败")}}function D(){h.value=!1,P.value="",t.value={name:"",adapterType:"openai",baseUrl:"",apiKey:"",apiKeys:[],strategy:"round-robin",models:[],priority:1,enabled:!0,advanced:{streaming:{enabled:!1,chunkSize:1024},thinking:{enableReasoning:!1,defaultLevel:"medium",adaptThinking:!0,sendThinkingAsMessage:!1},llm:{temperature:.7,maxTokens:4e3,topP:1,frequencyPenalty:0,presencePenalty:0}}},p.value=!0}function x(s){h.value=!0,P.value=s.id,t.value={...s,apiKey:s.apiKey||"",apiKeys:s.apiKeys&&s.apiKeys.length>0?s.apiKeys:s.apiKey?[{key:s.apiKey,enabled:!0}]:[],strategy:s.strategy||"round-robin",advanced:s.advanced||{streaming:{enabled:!1,chunkSize:1024},thinking:{enableReasoning:!1,defaultLevel:"medium",adaptThinking:!0,sendThinkingAsMessage:!1},llm:{temperature:.7,maxTokens:4e3,topP:1,frequencyPenalty:0,presencePenalty:0}}},p.value=!0}async function R(s){try{const e=await W.delete(`/api/channels/${s.id}`);e.data.code===0?(o.success("删除成功"),$()):o.error(e.data.message)}catch{o.error("删除失败")}}async function A(s){try{const e=await W.post("/api/channels/test",{adapterType:s.adapterType,baseUrl:s.baseUrl,apiKey:s.apiKey,models:s.models||[],advanced:s.advanced||{}});e.data.code===0?o.success(e.data.data.message):o.error(e.data.message)}catch(e){o.error("测试失败: "+(e.response?.data?.message||e.message))}}M(()=>V.value.filter(s=>!t.value.models.includes(s)).length),M(()=>t.value.models.length);async function v(){const s=t.value.apiKeys.find(e=>e.enabled)?.key||t.value.apiKey;if(!t.value.baseUrl||!s){o.warning("请先填写 BaseURL 和至少一个启用的 API Key");return}g.value=!0;try{const e=await W.post("/api/channels/fetch-models",{adapterType:t.value.adapterType,baseUrl:t.value.baseUrl,apiKey:s});e.data.code===0?(V.value=e.data.data.models,b.value=t.value.models||[],m.value=!0,o.success(`获取到 ${e.data.data.models.length} 个模型`)):o.error(e.data.message)}catch(e){o.error("获取模型失败: "+e.message)}finally{g.value=!1}}function N(){t.value.models=[...b.value],m.value=!1,o.success(`已选择 ${b.value.length} 个模型`)}function j(){return{key:"",enabled:!0}}async function O(){I.value?.validate(async s=>{if(!s)try{let e;h.value?e=await W.put(`/api/channels/${P.value}`,t.value):e=await W.post("/api/channels",t.value),e.data.code===0?(o.success("保存成功"),p.value=!1,$()):o.error(e.data.message)}catch{o.error("保存失败")}})}return We(()=>{$()}),(s,e)=>(He(),Ge(n(B),{vertical:""},{default:i(()=>[r(n(_e),{title:"渠道管理"},{"header-extra":i(()=>[r(n(U),{type:"primary",onClick:D},{default:i(()=>[...e[27]||(e[27]=[L("添加渠道",-1)])]),_:1})]),default:i(()=>[r(n(na),{columns:S,data:f.value},null,8,["data"])]),_:1}),r(n(ge),{show:p.value,"onUpdate:show":e[23]||(e[23]=a=>p.value=a),preset:"card",title:"配置渠道",style:{width:"600px"}},{footer:i(()=>[r(n(B),{justify:"end"},{default:i(()=>[r(n(U),{onClick:e[22]||(e[22]=a=>p.value=!1)},{default:i(()=>[...e[31]||(e[31]=[L("取消",-1)])]),_:1}),r(n(U),{type:"primary",onClick:O},{default:i(()=>[...e[32]||(e[32]=[L("保存",-1)])]),_:1})]),_:1})]),default:i(()=>[r(n(Je),{ref_key:"formRef",ref:I,model:t.value,rules:K,"label-placement":"left","label-width":"100"},{default:i(()=>[r(n(k),{label:"名称",path:"name"},{default:i(()=>[r(n(q),{value:t.value.name,"onUpdate:value":e[0]||(e[0]=a=>t.value.name=a),placeholder:"请输入名称"},null,8,["value"])]),_:1}),r(n(k),{label:"类型",path:"adapterType"},{default:i(()=>[r(n(ye),{value:t.value.adapterType,"onUpdate:value":e[1]||(e[1]=a=>t.value.adapterType=a),options:[{label:"OpenAI",value:"openai"},{label:"Gemini",value:"gemini"},{label:"Claude",value:"claude"}]},null,8,["value"])]),_:1}),r(n(k),{label:"BaseURL",path:"baseUrl"},{default:i(()=>[r(n(q),{value:t.value.baseUrl,"onUpdate:value":e[2]||(e[2]=a=>t.value.baseUrl=a),placeholder:"请输入BaseURL"},null,8,["value"])]),_:1}),r(n(k),{label:"轮询策略",path:"strategy"},{default:i(()=>[r(n(ra),{value:t.value.strategy,"onUpdate:value":e[3]||(e[3]=a=>t.value.strategy=a)},{default:i(()=>[r(n(he),{value:"round-robin",label:"轮询 (Round Robin)"}),r(n(he),{value:"random",label:"随机 (Random)"})]),_:1},8,["value"])]),_:1}),r(n(k),{label:"API Keys",path:"apiKeys"},{default:i(()=>[r(n(ha),{value:t.value.apiKeys,"onUpdate:value":e[4]||(e[4]=a=>t.value.apiKeys=a),"on-create":j},{default:i(({value:a})=>[Qe("div",Ra,[r(n(q),{value:a.key,"onUpdate:value":d=>a.key=d,placeholder:"sk-...",type:"password","show-password-on":"click"},null,8,["value","onUpdate:value"]),r(n(_),{value:a.enabled,"onUpdate:value":d=>a.enabled=d},{checked:i(()=>[...e[28]||(e[28]=[L("启用",-1)])]),unchecked:i(()=>[...e[29]||(e[29]=[L("禁用",-1)])]),_:1},8,["value","onUpdate:value"])])]),_:1},8,["value"])]),_:1}),r(n(k),{label:"优先级",path:"priority"},{default:i(()=>[r(n(q),{value:t.value.priority,"onUpdate:value":e[5]||(e[5]=a=>t.value.priority=a),type:"number",placeholder:"数字越小优先级越高"},null,8,["value"])]),_:1}),r(n(k),{label:"模型列表",path:"models"},{default:i(()=>[r(n(B),{vertical:"",style:{width:"100%"}},{default:i(()=>[r(n(Ca),{value:t.value.models,"onUpdate:value":e[6]||(e[6]=a=>t.value.models=a)},null,8,["value"]),r(n(U),{block:"",loading:g.value,onClick:v},{default:i(()=>[...e[30]||(e[30]=[L("获取模型列表",-1)])]),_:1},8,["loading"])]),_:1})]),_:1}),r(n(k),{label:"高级设置"},{default:i(()=>[r(n(Ye),{style:{width:"100%"}},{default:i(()=>[r(n(ie),{title:"流式输出设置",name:"streaming"},{default:i(()=>[r(n(B),{vertical:""},{default:i(()=>[r(n(k),{label:"启用流式输出","label-placement":"left"},{default:i(()=>[r(n(_),{value:t.value.advanced.streaming.enabled,"onUpdate:value":e[7]||(e[7]=a=>t.value.advanced.streaming.enabled=a)},null,8,["value"])]),_:1}),r(n(k),{label:"块大小","label-placement":"left"},{default:i(()=>[r(n(H),{value:t.value.advanced.streaming.chunkSize,"onUpdate:value":e[8]||(e[8]=a=>t.value.advanced.streaming.chunkSize=a),min:512,max:8192,step:512,style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1})]),_:1}),r(n(ie),{title:"思考控制设置",name:"thinking"},{default:i(()=>[r(n(B),{vertical:""},{default:i(()=>[r(n(k),{label:"启用推理模式","label-placement":"left"},{default:i(()=>[r(n(_),{value:t.value.advanced.thinking.enableReasoning,"onUpdate:value":e[9]||(e[9]=a=>t.value.advanced.thinking.enableReasoning=a)},null,8,["value"])]),_:1}),r(n(k),{label:"默认思考级别","label-placement":"left"},{default:i(()=>[r(n(ye),{value:t.value.advanced.thinking.defaultLevel,"onUpdate:value":e[10]||(e[10]=a=>t.value.advanced.thinking.defaultLevel=a),options:[{label:"低 (Low)",value:"low"},{label:"中 (Medium)",value:"medium"},{label:"高 (High)",value:"high"}]},null,8,["value"])]),_:1}),r(n(k),{label:"自适应思考","label-placement":"left"},{default:i(()=>[r(n(_),{value:t.value.advanced.thinking.adaptThinking,"onUpdate:value":e[11]||(e[11]=a=>t.value.advanced.thinking.adaptThinking=a)},null,8,["value"])]),_:1}),r(n(k),{label:"发送思考为消息","label-placement":"left"},{default:i(()=>[r(n(_),{value:t.value.advanced.thinking.sendThinkingAsMessage,"onUpdate:value":e[12]||(e[12]=a=>t.value.advanced.thinking.sendThinkingAsMessage=a)},null,8,["value"])]),_:1})]),_:1})]),_:1}),r(n(ie),{title:"LLM 参数设置",name:"llm"},{default:i(()=>[r(n(B),{vertical:""},{default:i(()=>[r(n(k),{label:"Temperature","label-placement":"left"},{default:i(()=>[r(n(B),{vertical:"",style:{width:"100%"}},{default:i(()=>[r(n(ae),{value:t.value.advanced.llm.temperature,"onUpdate:value":e[13]||(e[13]=a=>t.value.advanced.llm.temperature=a),min:0,max:2,step:.1,marks:{0:"0",1:"1",2:"2"}},null,8,["value"]),r(n(H),{value:t.value.advanced.llm.temperature,"onUpdate:value":e[14]||(e[14]=a=>t.value.advanced.llm.temperature=a),min:0,max:2,step:.1,size:"small",style:{width:"100px"}},null,8,["value"])]),_:1})]),_:1}),r(n(k),{label:"Max Tokens","label-placement":"left"},{default:i(()=>[r(n(H),{value:t.value.advanced.llm.maxTokens,"onUpdate:value":e[15]||(e[15]=a=>t.value.advanced.llm.maxTokens=a),min:100,max:128e3,step:100,style:{width:"100%"}},null,8,["value"])]),_:1}),r(n(k),{label:"Top P","label-placement":"left"},{default:i(()=>[r(n(B),{vertical:"",style:{width:"100%"}},{default:i(()=>[r(n(ae),{value:t.value.advanced.llm.topP,"onUpdate:value":e[16]||(e[16]=a=>t.value.advanced.llm.topP=a),min:0,max:1,step:.1,marks:{0:"0",.5:"0.5",1:"1"}},null,8,["value"]),r(n(H),{value:t.value.advanced.llm.topP,"onUpdate:value":e[17]||(e[17]=a=>t.value.advanced.llm.topP=a),min:0,max:1,step:.1,size:"small",style:{width:"100px"}},null,8,["value"])]),_:1})]),_:1}),r(n(k),{label:"Frequency Penalty","label-placement":"left"},{default:i(()=>[r(n(B),{vertical:"",style:{width:"100%"}},{default:i(()=>[r(n(ae),{value:t.value.advanced.llm.frequencyPenalty,"onUpdate:value":e[18]||(e[18]=a=>t.value.advanced.llm.frequencyPenalty=a),min:-2,max:2,step:.1,marks:{"-2":"-2",0:"0",2:"2"}},null,8,["value"]),r(n(H),{value:t.value.advanced.llm.frequencyPenalty,"onUpdate:value":e[19]||(e[19]=a=>t.value.advanced.llm.frequencyPenalty=a),min:-2,max:2,step:.1,size:"small",style:{width:"100px"}},null,8,["value"])]),_:1})]),_:1}),r(n(k),{label:"Presence Penalty","label-placement":"left"},{default:i(()=>[r(n(B),{vertical:"",style:{width:"100%"}},{default:i(()=>[r(n(ae),{value:t.value.advanced.llm.presencePenalty,"onUpdate:value":e[20]||(e[20]=a=>t.value.advanced.llm.presencePenalty=a),min:-2,max:2,step:.1,marks:{"-2":"-2",0:"0",2:"2"}},null,8,["value"]),r(n(H),{value:t.value.advanced.llm.presencePenalty,"onUpdate:value":e[21]||(e[21]=a=>t.value.advanced.llm.presencePenalty=a),min:-2,max:2,step:.1,size:"small",style:{width:"100px"}},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["show"]),r(n(ge),{show:m.value,"onUpdate:show":e[26]||(e[26]=a=>m.value=a),preset:"card",title:"选择模型",style:{width:"800px","max-height":"85vh"},segmented:{content:"soft",footer:"soft"}},{footer:i(()=>[r(n(B),{justify:"end"},{default:i(()=>[r(n(U),{onClick:e[25]||(e[25]=a=>m.value=!1)},{default:i(()=>[...e[33]||(e[33]=[L("取消",-1)])]),_:1}),r(n(U),{type:"primary",onClick:N},{default:i(()=>[L(" 确定 ("+Xe(b.value.length)+") ",1)]),_:1})]),_:1})]),default:i(()=>[r(Ze,{"all-models":V.value,value:b.value,"onUpdate:value":e[24]||(e[24]=a=>b.value=a),multiple:!0},null,8,["all-models","value"])]),_:1},8,["show"])]),_:1}))}},xa=qe(Ta,[["__scopeId","data-v-8906f8b4"]]);export{xa as default};
