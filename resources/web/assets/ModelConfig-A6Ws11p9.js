import{K as x,x as v,C as k,L as C,M as S,O as s,P as a,Q as U,R as b,S as D,T as t,U as O,X as B,V as p,Y as i,B as E,a0 as T,$ as _}from"./index-CDclBwh9.js";import{N as h}from"./Divider-D3EjB1mK.js";import{N as f}from"./Select-lAl1XhHB.js";import{N as q}from"./text-CAG-bBIt.js";const V={__name:"ModelConfig",setup(z){const c=x(),y=v(!1),m=v(!1),u=v({llm:{defaultModel:"",embeddingModel:"",chatModel:"",codeModel:"",translationModel:""}}),g=v([]),d=k(()=>{const o={OpenAI:[],Claude:[],Gemini:[],DeepSeek:[],Qwen:[],其他:[]};g.value.forEach(l=>{const n=l.toLowerCase();n.includes("gpt")||n.includes("o1")||n.includes("o3")?o.OpenAI.push(l):n.includes("claude")?o.Claude.push(l):n.includes("gemini")?o.Gemini.push(l):n.includes("deepseek")?o.DeepSeek.push(l):n.includes("qwen")||n.includes("qwq")?o.Qwen.push(l):o.其他.push(l)});const e=[];return Object.entries(o).forEach(([l,n])=>{n.length>0&&e.push({type:"group",label:l,key:l,children:n.map(r=>({label:r,value:r}))})}),e});async function M(){y.value=!0;try{const o=await b.get("/api/config");if(o.data.code===0){const l=o.data.data;u.value.llm={...u.value.llm,...l.llm}}const e=await b.get("/api/channels/list");if(e.data.code===0){const l=e.data.data,n=new Set;l.forEach(r=>{r.models&&r.models.forEach(N=>n.add(N))}),g.value=Array.from(n).sort()}}catch{c.error("获取数据失败")}finally{y.value=!1}}async function w(){m.value=!0;try{const o=await b.post("/api/config",{llm:u.value.llm});o.data.code===0?c.success("保存成功"):c.error(o.data.message)}catch{c.error("保存失败")}finally{m.value=!1}}return C(()=>{M()}),(o,e)=>(D(),S(a(U),{vertical:"",size:16},{default:s(()=>[t(a(O),{title:"模型配置",size:"medium"},{"header-extra":s(()=>[t(a(T),{type:"info"},{default:s(()=>[p("共 "+_(g.value.length)+" 个模型可用",1)]),_:1})]),default:s(()=>[t(a(B),{"label-placement":"left","label-width":"100",style:{maxWidth:"600px"}},{default:s(()=>[t(a(h),{"title-placement":"left"},{default:s(()=>[...e[5]||(e[5]=[p("全局默认",-1)])]),_:1}),t(a(i),{label:"默认模型"},{default:s(()=>[t(a(f),{value:u.value.llm.defaultModel,"onUpdate:value":e[0]||(e[0]=l=>u.value.llm.defaultModel=l),options:d.value,placeholder:"选择默认模型",filterable:"",clearable:"",style:{width:"100%"}},null,8,["value","options"])]),_:1}),t(a(i),{label:"嵌入模型"},{default:s(()=>[t(a(f),{value:u.value.llm.embeddingModel,"onUpdate:value":e[1]||(e[1]=l=>u.value.llm.embeddingModel=l),options:d.value,placeholder:"用于向量嵌入的模型",filterable:"",clearable:"",style:{width:"100%"}},null,8,["value","options"])]),_:1}),t(a(h),{"title-placement":"left"},{default:s(()=>[...e[6]||(e[6]=[p("场景模式",-1)])]),_:1}),t(a(q),{depth:"3",style:{display:"block","margin-bottom":"16px","font-size":"13px"}},{default:s(()=>[...e[7]||(e[7]=[p(" 留空则使用默认模型 ",-1)])]),_:1}),t(a(i),{label:"对话模式"},{default:s(()=>[t(a(f),{value:u.value.llm.chatModel,"onUpdate:value":e[2]||(e[2]=l=>u.value.llm.chatModel=l),options:d.value,placeholder:"使用默认模型",filterable:"",clearable:"",style:{width:"100%"}},null,8,["value","options"])]),_:1}),t(a(i),{label:"代码模式"},{default:s(()=>[t(a(f),{value:u.value.llm.codeModel,"onUpdate:value":e[3]||(e[3]=l=>u.value.llm.codeModel=l),options:d.value,placeholder:"使用默认模型",filterable:"",clearable:"",style:{width:"100%"}},null,8,["value","options"])]),_:1}),t(a(i),{label:"翻译模式"},{default:s(()=>[t(a(f),{value:u.value.llm.translationModel,"onUpdate:value":e[4]||(e[4]=l=>u.value.llm.translationModel=l),options:d.value,placeholder:"使用默认模型",filterable:"",clearable:"",style:{width:"100%"}},null,8,["value","options"])]),_:1}),t(a(h)),t(a(i),null,{default:s(()=>[t(a(E),{type:"primary",onClick:w,loading:m.value},{default:s(()=>[...e[8]||(e[8]=[p("保存配置",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1}))}};export{V as default};
