import{_ as P,K as M,x as R,L as q,M as b,O as l,R as T,ah as o,S as m,T as a,V as i,Z as _,P as D,aw as F,a2 as K,a3 as Z,a4 as $,$ as j}from"./index-Bsw7oJ13.js";const G={__name:"EventsView",setup(H){const d=M(),p=R(!1),t=R({poke:{enabled:!1,pokeBack:!1,message:"别戳了~"},reaction:{enabled:!1},voiceReply:{enabled:!1,ttsProvider:"system",triggerOnTool:!1,triggerAlways:!1,maxTextLength:500}}),y=R([]);async function w(){p.value=!0;try{const s=await T.get("/api/config");if(s.data.code===0&&s.data.data?.features){const e=s.data.data.features;e.poke&&(t.value.poke={...t.value.poke,...e.poke}),e.reaction&&(t.value.reaction={...t.value.reaction,...e.reaction}),e.voiceReply&&(t.value.voiceReply={...t.value.voiceReply,...e.voiceReply})}}catch(s){d.error("获取配置失败: "+s.message)}finally{p.value=!1}}async function C(){p.value=!0;try{const s=await T.post("/api/config",{features:{poke:t.value.poke,reaction:t.value.reaction,voiceReply:t.value.voiceReply}});s.data.code===0?d.success("保存成功"):d.error("保存失败: "+s.data.message)}catch(s){d.error("保存失败: "+s.message)}finally{p.value=!1}}function z(){y.value=[],d.success("日志已清空")}return q(()=>{w()}),(s,e)=>{const B=o("n-icon"),g=o("n-button"),r=o("n-space"),f=o("n-alert"),c=o("n-switch"),u=o("n-form-item"),L=o("n-input"),k=o("n-form"),v=o("n-card"),x=o("n-tab-pane"),S=o("n-select"),U=o("n-input-number"),V=o("n-tabs"),A=o("n-empty"),I=o("n-tag"),E=o("n-thing"),N=o("n-list-item"),O=o("n-list");return m(),b(r,{vertical:"",size:"large"},{default:l(()=>[a(v,{title:"事件处理配置"},{"header-extra":l(()=>[a(r,null,{default:l(()=>[a(g,{onClick:w,loading:p.value},{icon:l(()=>[a(B,null,{default:l(()=>[a(D(F))]),_:1})]),default:l(()=>[e[7]||(e[7]=i(" 刷新 ",-1))]),_:1},8,["loading"]),a(g,{type:"primary",onClick:C,loading:p.value},{default:l(()=>[...e[8]||(e[8]=[i(" 保存配置 ",-1)])]),_:1},8,["loading"])]),_:1})]),default:l(()=>[a(f,{type:"info",style:{"margin-bottom":"16px"}},{default:l(()=>[...e[9]||(e[9]=[i(" 配置各种事件的响应方式，包括戳一戳、表情回应等。 ",-1)])]),_:1}),a(V,{type:"line"},{default:l(()=>[a(x,{name:"poke",tab:"戳一戳"},{default:l(()=>[a(r,{vertical:"",size:"large"},{default:l(()=>[a(f,{type:"info",style:{"margin-bottom":"8px"}},{default:l(()=>[...e[10]||(e[10]=[i(" 开启后，当有人戳机器人时，会根据当前人设生成回复。 ",-1)])]),_:1}),a(v,{size:"small"},{default:l(()=>[a(k,{"label-placement":"left","label-width":"120"},{default:l(()=>[a(u,{label:"启用响应"},{default:l(()=>[a(c,{value:t.value.poke.enabled,"onUpdate:value":e[0]||(e[0]=n=>t.value.poke.enabled=n)},null,8,["value"]),e[11]||(e[11]=_("span",{style:{"margin-left":"12px",color:"#999"}}," 收到戳一戳时使用AI人设回复 ",-1))]),_:1}),a(u,{label:"自动回戳"},{default:l(()=>[a(c,{value:t.value.poke.pokeBack,"onUpdate:value":e[1]||(e[1]=n=>t.value.poke.pokeBack=n),disabled:!t.value.poke.enabled},null,8,["value","disabled"]),e[12]||(e[12]=_("span",{style:{"margin-left":"12px",color:"#999"}}," 回复后自动戳回去 ",-1))]),_:1}),a(u,{label:"备用回复"},{default:l(()=>[a(L,{value:t.value.poke.message,"onUpdate:value":e[2]||(e[2]=n=>t.value.poke.message=n),type:"textarea",rows:2,placeholder:"AI回复失败时的备用回复",disabled:!t.value.poke.enabled},null,8,["value","disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(x,{name:"reaction",tab:"表情回应"},{default:l(()=>[a(r,{vertical:""},{default:l(()=>[a(f,{type:"info",style:{"margin-bottom":"8px"}},{default:l(()=>[...e[13]||(e[13]=[i(" 开启后，当有人对机器人的消息做出表情回应时，会根据人设决定是否回复。 ",-1)])]),_:1}),a(v,{size:"small"},{default:l(()=>[a(k,{"label-placement":"left","label-width":"120"},{default:l(()=>[a(u,{label:"启用处理"},{default:l(()=>[a(c,{value:t.value.reaction.enabled,"onUpdate:value":e[3]||(e[3]=n=>t.value.reaction.enabled=n)},null,8,["value"]),e[14]||(e[14]=_("span",{style:{"margin-left":"12px",color:"#999"}}," 处理消息的表情回应（使用AI人设） ",-1))]),_:1})]),_:1})]),_:1}),a(f,{type:"warning"},{default:l(()=>[...e[15]||(e[15]=[i(" 表情回应功能需要适配器支持（NapCat 等），icqq 适配器可能无法收到此事件。 ",-1)])]),_:1})]),_:1})]),_:1}),a(x,{name:"voice",tab:"语音回复"},{default:l(()=>[a(r,{vertical:""},{default:l(()=>[a(v,{size:"small"},{default:l(()=>[a(k,{"label-placement":"left","label-width":"120"},{default:l(()=>[a(u,{label:"启用语音"},{default:l(()=>[a(c,{value:t.value.voiceReply.enabled,"onUpdate:value":e[4]||(e[4]=n=>t.value.voiceReply.enabled=n)},null,8,["value"]),e[16]||(e[16]=_("span",{style:{"margin-left":"12px",color:"#999"}}," 启用语音回复功能 ",-1))]),_:1}),a(u,{label:"TTS提供者"},{default:l(()=>[a(S,{value:t.value.voiceReply.ttsProvider,"onUpdate:value":e[5]||(e[5]=n=>t.value.voiceReply.ttsProvider=n),options:[{label:"系统TTS",value:"system"},{label:"Edge TTS",value:"edge"},{label:"OpenAI TTS",value:"openai"}],disabled:!t.value.voiceReply.enabled,style:{width:"200px"}},null,8,["value","disabled"])]),_:1}),a(u,{label:"最大文本长度"},{default:l(()=>[a(U,{value:t.value.voiceReply.maxTextLength,"onUpdate:value":e[6]||(e[6]=n=>t.value.voiceReply.maxTextLength=n),min:100,max:2e3,disabled:!t.value.voiceReply.enabled},null,8,["value","disabled"]),e[17]||(e[17]=_("span",{style:{"margin-left":"12px",color:"#999"}}," 超过此长度不转语音 ",-1))]),_:1})]),_:1})]),_:1}),a(f,{type:"info"},{default:l(()=>[...e[18]||(e[18]=[i(" 语音回复功能需要配置TTS服务。 ",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(v,{title:"事件日志"},{"header-extra":l(()=>[a(g,{size:"small",onClick:z},{default:l(()=>[...e[19]||(e[19]=[i("清空日志",-1)])]),_:1})]),default:l(()=>[y.value.length===0?(m(),b(A,{key:0,description:"暂无事件日志"})):(m(),b(O,{key:1,bordered:""},{default:l(()=>[(m(!0),K(Z,null,$(y.value,n=>(m(),b(N,{key:n.id},{prefix:l(()=>[a(I,{type:n.type==="poke"?"info":"warning",size:"small"},{default:l(()=>[i(j(n.type),1)]),_:2},1032,["type"])]),default:l(()=>[a(E,{title:n.content,description:n.time},null,8,["title","description"])]),_:2},1024))),128))]),_:1}))]),_:1})]),_:1})}}},Q=P(G,[["__scopeId","data-v-2ac1aaf3"]]);export{Q as default};
