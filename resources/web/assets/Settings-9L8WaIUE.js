import{K as h,x as N,a5 as c,C as L,L as ee,M as G,O as r,P as l,Q as P,R as z,a6 as le,S as w,T as t,a7 as O,V as i,U as x,X as k,a1 as C,a2 as q,Y as o,a3 as D,Z as m,$ as te,N as g,a8 as d,a9 as ae,aa as A,B as U,ab as M,W as re}from"./index-BlGFC_7o.js";import{M as ue}from"./ModelSelector-CB_aqA-X.js";import{N as p}from"./Divider-BRLRNZu0.js";import{N as s}from"./Switch-D_pdGs5P.js";import{N as oe}from"./Select-CWjjOVcG.js";import{N as $}from"./Slider-CuDGEqMq.js";import{N as Q}from"./DynamicTags-DteiU6QU.js";import{N as R}from"./InputNumber-BO-DBVrj.js";import"./SearchOutlined-D0-NXRiG.js";import"./text-DZcZfpKw.js";import"./Add-Df6mcjB1.js";import"./prop-NnGblK-3.js";const we={__name:"Settings",setup(ie){const S=h(),B=N(!1),j=N(!1),a=c({basic:{commandPrefix:"#ai",debug:!1,showThinkingMessage:!0,debugToConsoleOnly:!0,quoteReply:!0,autoRecall:{enabled:!1,delay:60,recallError:!0}},admin:{masterQQ:[],loginNotifyPrivate:!0,sensitiveCommandMasterOnly:!0},llm:{defaultModel:"",models:{chat:"",roleplay:"",toolCall:"",search:"",reasoning:""},chatModel:"",codeModel:"",translationModel:""},bym:{enable:!1,probability:.02,temperature:.9,maxTokens:100,recall:!1,model:"",systemPrompt:"",inheritPersonality:!0,exclusiveFeatures:["groupSummary","userPortrait"]},tools:{showCallLogs:!0,useForwardMsg:!0,parallelExecution:!0,sendIntermediateReply:!0},personality:{isolateContext:{enabled:!1,clearOnSwitch:!1}},thinking:{showThinkingContent:!0,useForwardMsg:!0},features:{groupSummary:{enabled:!0,maxMessages:100},userPortrait:{enabled:!0,minMessages:10},poke:{enabled:!1,pokeBack:!1,message:"别戳了~"},reaction:{enabled:!1},imageGen:{enabled:!0,apiUrl:"https://business.928100.xyz/v1/chat/completions",apiKey:"X-Free",model:"gemini-3-pro-image"}},memory:{enabled:!1,autoExtract:!0},trigger:{private:{enabled:!0,mode:"always"},group:{enabled:!0,at:!0,prefix:!0,keyword:!1,random:!1,randomRate:.05},prefixes:["#chat"],prefixPersonas:[],keywords:[],collectGroupMsg:!0,blacklistUsers:[],whitelistUsers:[],blacklistGroups:[],whitelistGroups:[]}}),W=[{label:"总是响应",value:"always"},{label:"需要前缀",value:"prefix"},{label:"关闭",value:"off"}],F=L({get:()=>(a.trigger.prefixes||[]).join(", "),set:n=>{a.trigger.prefixes=n.split(/[,，]\s*/).filter(Boolean)}}),E=L({get:()=>(a.trigger.keywords||[]).join(", "),set:n=>{a.trigger.keywords=n.split(/[,，]\s*/).filter(Boolean)}}),K=N([]),I=N(!1),V=N("defaultModel"),T=N("");function X(){const n=T.value.trim();n?a.admin.masterQQ=n.split(/[,，\s]+/).filter(Boolean):a.admin.masterQQ=[]}function Y(){T.value=(a.admin.masterQQ||[]).join(", ")}async function Z(){B.value=!0;try{const n=await z.get("/api/config");if(n.data.code===0){const e=n.data.data;if(e.basic&&(Object.assign(a.basic,e.basic),e.basic.autoRecall&&Object.assign(a.basic.autoRecall,e.basic.autoRecall)),e.llm&&(Object.assign(a.llm,e.llm),e.llm.models&&Object.assign(a.llm.models,e.llm.models)),e.admin&&Object.assign(a.admin,e.admin),e.bym&&Object.assign(a.bym,e.bym),e.tools&&Object.assign(a.tools,e.tools),e.thinking&&Object.assign(a.thinking,e.thinking),e.personality?.isolateContext&&(a.personality.isolateContext={...a.personality.isolateContext,...e.personality.isolateContext}),e.features&&(e.features.groupSummary&&Object.assign(a.features.groupSummary,e.features.groupSummary),e.features.userPortrait&&Object.assign(a.features.userPortrait,e.features.userPortrait),e.features.poke&&Object.assign(a.features.poke,e.features.poke),e.features.reaction&&Object.assign(a.features.reaction,e.features.reaction)),e.memory&&Object.assign(a.memory,e.memory),e.trigger){a.trigger.private=e.trigger.private||{enabled:!0,mode:"always"},a.trigger.group=e.trigger.group||{enabled:!0,at:!0,prefix:!0,keyword:!1,random:!1,randomRate:.05};const u=e.trigger.prefixes||["#chat"];a.trigger.prefixes=(Array.isArray(u)?u:[u]).filter(b=>b&&typeof b=="string"&&b.trim());const v=e.trigger.keywords||[];a.trigger.keywords=(Array.isArray(v)?v:[v]).filter(b=>b&&typeof b=="string"&&b.trim()),a.trigger.collectGroupMsg=e.trigger.collectGroupMsg??!0,a.trigger.blacklistUsers=e.trigger.blacklistUsers||[],a.trigger.whitelistUsers=e.trigger.whitelistUsers||[],a.trigger.blacklistGroups=e.trigger.blacklistGroups||[],a.trigger.whitelistGroups=e.trigger.whitelistGroups||[]}const y=await z.get("/api/channels/list");if(y.data.code===0){const u=y.data.data,v=new Set;u.forEach(b=>{b.models&&b.models.forEach(_=>v.add(_))}),K.value=Array.from(v).sort()}Y()}}catch(n){S.error("加载配置失败: "+n.message)}finally{B.value=!1}}async function H(){j.value=!0;try{const n={...a.trigger};n.prefixes=(a.trigger.prefixes||[]).filter(u=>u&&typeof u=="string"&&u.trim()),n.keywords=(a.trigger.keywords||[]).filter(u=>u&&typeof u=="string"&&u.trim());const e={basic:{...a.basic},admin:{...a.admin},llm:{...a.llm},bym:{...a.bym},tools:{...a.tools},thinking:{...a.thinking},features:{...a.features},memory:{...a.memory},trigger:n,personality:{...a.personality}},y=await z.post("/api/config",e);y.data.code===0?S.success("✓ 配置已保存",{duration:2e3}):S.error("保存失败: "+y.data.message)}catch(n){S.error("保存失败: "+n.message)}finally{j.value=!1}}function f(n){V.value=n,I.value=!0}function J(n){if(n.length>0){const e=V.value;if(e==="bymModel")a.bym.model=n[0];else if(e.startsWith("models.")){const y=e.replace("models.","");a.llm.models[y]=n[0]}else a.llm[e]=n[0]}I.value=!1}return ee(()=>{Z()}),(n,e)=>{const y=le("n-dynamic-input");return w(),G(l(P),{vertical:"",size:"large"},{default:r(()=>[t(l(O),{type:"info",title:"提示",style:{"margin-bottom":"16px"}},{default:r(()=>[...e[79]||(e[79]=[i(" API Key 和渠道配置请前往「渠道管理」页面进行设置 ",-1)])]),_:1}),t(l(x),{title:"AI触发配置"},{default:r(()=>[t(l(O),{type:"info",style:{"margin-bottom":"16px"}},{default:r(()=>[...e[80]||(e[80]=[i(" 配置机器人何时响应消息。私聊和群聊可独立配置触发方式。 ",-1)])]),_:1}),t(l(k),{"label-placement":"left","label-width":"140"},{default:r(()=>[t(l(p),{"title-placement":"left"},{default:r(()=>[...e[81]||(e[81]=[i("私聊触发",-1)])]),_:1}),t(l(o),{label:"响应私聊"},{default:r(()=>[t(l(s),{value:a.trigger.private.enabled,"onUpdate:value":e[0]||(e[0]=u=>a.trigger.private.enabled=u)},null,8,["value"])]),_:1}),a.trigger.private.enabled?(w(),G(l(o),{key:0,label:"私聊模式"},{default:r(()=>[t(l(oe),{value:a.trigger.private.mode,"onUpdate:value":e[1]||(e[1]=u=>a.trigger.private.mode=u),options:W,style:{width:"180px"}},null,8,["value"])]),_:1})):C("",!0),t(l(p),{"title-placement":"left"},{default:r(()=>[...e[82]||(e[82]=[i("群聊触发",-1)])]),_:1}),t(l(o),{label:"响应群聊"},{default:r(()=>[t(l(s),{value:a.trigger.group.enabled,"onUpdate:value":e[2]||(e[2]=u=>a.trigger.group.enabled=u)},null,8,["value"])]),_:1}),a.trigger.group.enabled?(w(),q(D,{key:1},[t(l(o),{label:"@机器人触发"},{default:r(()=>[t(l(s),{value:a.trigger.group.at,"onUpdate:value":e[3]||(e[3]=u=>a.trigger.group.at=u)},null,8,["value"])]),_:1}),t(l(o),{label:"前缀触发"},{default:r(()=>[t(l(s),{value:a.trigger.group.prefix,"onUpdate:value":e[4]||(e[4]=u=>a.trigger.group.prefix=u)},null,8,["value"])]),_:1}),t(l(o),{label:"关键词触发"},{default:r(()=>[t(l(s),{value:a.trigger.group.keyword,"onUpdate:value":e[5]||(e[5]=u=>a.trigger.group.keyword=u)},null,8,["value"])]),_:1}),t(l(o),{label:"随机触发"},{default:r(()=>[t(l(P),{align:"center"},{default:r(()=>[t(l(s),{value:a.trigger.group.random,"onUpdate:value":e[6]||(e[6]=u=>a.trigger.group.random=u)},null,8,["value"]),a.trigger.group.random?(w(),q(D,{key:0},[t(l($),{value:a.trigger.group.randomRate,"onUpdate:value":e[7]||(e[7]=u=>a.trigger.group.randomRate=u),min:0,max:.5,step:.01,style:{width:"120px"}},null,8,["value"]),m("span",null,te((a.trigger.group.randomRate*100).toFixed(0))+"%",1)],64)):C("",!0)]),_:1})]),_:1})],64)):C("",!0),t(l(p),{"title-placement":"left"},{default:r(()=>[...e[83]||(e[83]=[i("触发词",-1)])]),_:1}),t(l(o),{label:"触发前缀"},{default:r(()=>[t(l(g),{value:F.value,"onUpdate:value":e[8]||(e[8]=u=>F.value=u),placeholder:"多个用逗号分隔，如: #chat, 小助手"},null,8,["value"])]),_:1}),a.trigger.group.keyword?(w(),G(l(o),{key:2,label:"触发关键词"},{default:r(()=>[t(l(g),{value:E.value,"onUpdate:value":e[9]||(e[9]=u=>E.value=u),placeholder:"消息包含这些词时触发"},null,8,["value"])]),_:1})):C("",!0),t(l(p),{"title-placement":"left"},{default:r(()=>[...e[84]||(e[84]=[i("前缀人格",-1)])]),_:1}),t(l(O),{type:"info",style:{"margin-bottom":"12px"}},{default:r(()=>[...e[85]||(e[85]=[i(" 设置特定前缀触发独立人格，该前缀仅使用此人格，不影响其他对话 ",-1)])]),_:1}),t(l(o),{label:"前缀人格列表"},{default:r(()=>[t(y,{value:a.trigger.prefixPersonas,"onUpdate:value":e[10]||(e[10]=u=>a.trigger.prefixPersonas=u),"on-create":()=>({prefix:"",preset:""})},{default:r(({value:u})=>[t(l(P),null,{default:r(()=>[t(l(g),{value:u.prefix,"onUpdate:value":v=>u.prefix=v,placeholder:"触发前缀，如: 猫娘",style:{width:"120px"}},null,8,["value","onUpdate:value"]),t(l(g),{value:u.preset,"onUpdate:value":v=>u.preset=v,placeholder:"人格提示词",style:{width:"300px"},type:"textarea",autosize:{minRows:1,maxRows:3}},null,8,["value","onUpdate:value"])]),_:2},1024)]),_:1},8,["value"])]),_:1}),t(l(p),{"title-placement":"left"},{default:r(()=>[...e[86]||(e[86]=[i("其他",-1)])]),_:1}),t(l(o),{label:"采集群消息"},{default:r(()=>[t(l(d),{trigger:"hover"},{trigger:r(()=>[t(l(s),{value:a.trigger.collectGroupMsg,"onUpdate:value":e[11]||(e[11]=u=>a.trigger.collectGroupMsg=u)},null,8,["value"])]),default:r(()=>[e[87]||(e[87]=i(" 用于记忆和上下文分析 ",-1))]),_:1})]),_:1}),t(l(p),{"title-placement":"left"},{default:r(()=>[...e[88]||(e[88]=[i("访问控制",-1)])]),_:1}),t(l(ae),{cols:2,"x-gap":24,responsive:"screen","collapsed-cols":1},{default:r(()=>[t(l(A),null,{default:r(()=>[t(l(o),{label:"群白名单"},{default:r(()=>[t(l(Q),{value:a.trigger.whitelistGroups,"onUpdate:value":e[12]||(e[12]=u=>a.trigger.whitelistGroups=u)},null,8,["value"])]),_:1})]),_:1}),t(l(A),null,{default:r(()=>[t(l(o),{label:"群黑名单"},{default:r(()=>[t(l(Q),{value:a.trigger.blacklistGroups,"onUpdate:value":e[13]||(e[13]=u=>a.trigger.blacklistGroups=u)},null,8,["value"])]),_:1})]),_:1}),t(l(A),null,{default:r(()=>[t(l(o),{label:"用户白名单"},{default:r(()=>[t(l(Q),{value:a.trigger.whitelistUsers,"onUpdate:value":e[14]||(e[14]=u=>a.trigger.whitelistUsers=u)},null,8,["value"])]),_:1})]),_:1}),t(l(A),null,{default:r(()=>[t(l(o),{label:"用户黑名单"},{default:r(()=>[t(l(Q),{value:a.trigger.blacklistUsers,"onUpdate:value":e[15]||(e[15]=u=>a.trigger.blacklistUsers=u)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(l(x),{title:"基础配置"},{default:r(()=>[t(l(k),{"label-placement":"left","label-width":"140"},{default:r(()=>[t(l(o),{label:"命令前缀"},{default:r(()=>[t(l(d),{trigger:"hover"},{trigger:r(()=>[t(l(g),{value:a.basic.commandPrefix,"onUpdate:value":e[16]||(e[16]=u=>a.basic.commandPrefix=u),placeholder:"#ai"},null,8,["value"])]),default:r(()=>[e[89]||(e[89]=i(" 管理命令的前缀，如 #ai帮助、#ai状态 等 ",-1))]),_:1})]),_:1}),t(l(o),{label:"思考提示"},{default:r(()=>[t(l(d),{trigger:"hover"},{trigger:r(()=>[t(l(s),{value:a.basic.showThinkingMessage,"onUpdate:value":e[17]||(e[17]=u=>a.basic.showThinkingMessage=u)},null,8,["value"])]),default:r(()=>[e[90]||(e[90]=i(' 开启后，AI处理时会先发送"思考中..."提示 ',-1))]),_:1})]),_:1}),t(l(o),{label:"引用回复"},{default:r(()=>[t(l(d),{trigger:"hover"},{trigger:r(()=>[t(l(s),{value:a.basic.quoteReply,"onUpdate:value":e[18]||(e[18]=u=>a.basic.quoteReply=u)},null,8,["value"])]),default:r(()=>[e[91]||(e[91]=i(" 开启后，AI回复会引用触发消息 ",-1))]),_:1})]),_:1}),t(l(o),{label:"调试模式"},{default:r(()=>[t(l(s),{value:a.basic.debug,"onUpdate:value":e[19]||(e[19]=u=>a.basic.debug=u)},null,8,["value"])]),_:1}),a.basic.debug?(w(),G(l(o),{key:0,label:"调试仅控制台"},{default:r(()=>[t(l(s),{value:a.basic.debugToConsoleOnly,"onUpdate:value":e[20]||(e[20]=u=>a.basic.debugToConsoleOnly=u)},null,8,["value"])]),_:1})):C("",!0),t(l(p),{"title-placement":"left"},{default:r(()=>[...e[92]||(e[92]=[i("自动撤回",-1)])]),_:1}),t(l(o),{label:"启用自动撤回"},{default:r(()=>[t(l(s),{value:a.basic.autoRecall.enabled,"onUpdate:value":e[21]||(e[21]=u=>a.basic.autoRecall.enabled=u)},null,8,["value"])]),_:1}),a.basic.autoRecall.enabled?(w(),G(l(o),{key:1,label:"撤回延迟(秒)"},{default:r(()=>[t(l(R),{value:a.basic.autoRecall.delay,"onUpdate:value":e[22]||(e[22]=u=>a.basic.autoRecall.delay=u),min:5,max:300},null,8,["value"])]),_:1})):C("",!0),a.basic.autoRecall.enabled?(w(),G(l(o),{key:2,label:"撤回错误消息"},{default:r(()=>[t(l(s),{value:a.basic.autoRecall.recallError,"onUpdate:value":e[23]||(e[23]=u=>a.basic.autoRecall.recallError=u)},null,8,["value"])]),_:1})):C("",!0)]),_:1})]),_:1}),t(l(x),{title:"管理配置"},{default:r(()=>[t(l(k),{"label-placement":"left","label-width":"140"},{default:r(()=>[t(l(o),{label:"主人QQ"},{default:r(()=>[t(l(g),{value:T.value,"onUpdate:value":e[24]||(e[24]=u=>T.value=u),placeholder:"多个用逗号分隔，留空使用Yunzai配置",onBlur:X},null,8,["value"])]),_:1}),t(l(o),{label:"登录链接私聊推送"},{default:r(()=>[t(l(d),{trigger:"hover"},{trigger:r(()=>[t(l(s),{value:a.admin.loginNotifyPrivate,"onUpdate:value":e[25]||(e[25]=u=>a.admin.loginNotifyPrivate=u)},null,8,["value"])]),default:r(()=>[e[93]||(e[93]=i(" 开启后，群聊中触发管理面板命令时会私聊推送登录链接 ",-1))]),_:1})]),_:1}),t(l(o),{label:"敏感命令仅主人"},{default:r(()=>[t(l(d),{trigger:"hover"},{trigger:r(()=>[t(l(s),{value:a.admin.sensitiveCommandMasterOnly,"onUpdate:value":e[26]||(e[26]=u=>a.admin.sensitiveCommandMasterOnly=u)},null,8,["value"])]),default:r(()=>[e[94]||(e[94]=i(" 开启后，敏感命令（如管理面板）仅限主人使用 ",-1))]),_:1})]),_:1})]),_:1})]),_:1}),t(l(x),{title:"模型配置"},{default:r(()=>[t(l(k),{"label-placement":"left","label-width":"140"},{default:r(()=>[t(l(o),{label:"默认模型"},{default:r(()=>[t(l(g),{value:a.llm.defaultModel,"onUpdate:value":e[28]||(e[28]=u=>a.llm.defaultModel=u),placeholder:"选择模型",readonly:"",onClick:e[29]||(e[29]=u=>f("defaultModel"))},{suffix:r(()=>[t(l(U),{size:"small",onClick:e[27]||(e[27]=M(u=>f("defaultModel"),["stop"]))},{default:r(()=>[...e[95]||(e[95]=[i("选择",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),t(l(p),{"title-placement":"left"},{default:r(()=>[...e[96]||(e[96]=[i("模型分类 (可选，留空使用默认模型)",-1)])]),_:1}),t(l(o),{label:"对话模型"},{default:r(()=>[t(l(g),{value:a.llm.models.chat,"onUpdate:value":e[31]||(e[31]=u=>a.llm.models.chat=u),placeholder:"普通聊天使用的模型",readonly:"",onClick:e[32]||(e[32]=u=>f("models.chat"))},{suffix:r(()=>[t(l(U),{size:"small",onClick:e[30]||(e[30]=M(u=>f("models.chat"),["stop"]))},{default:r(()=>[...e[97]||(e[97]=[i("选择",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),t(l(o),{label:"伪人模型"},{default:r(()=>[t(l(g),{value:a.llm.models.roleplay,"onUpdate:value":e[34]||(e[34]=u=>a.llm.models.roleplay=u),placeholder:"模拟真人回复的模型",readonly:"",onClick:e[35]||(e[35]=u=>f("models.roleplay"))},{suffix:r(()=>[t(l(U),{size:"small",onClick:e[33]||(e[33]=M(u=>f("models.roleplay"),["stop"]))},{default:r(()=>[...e[98]||(e[98]=[i("选择",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),t(l(o),{label:"工具调用模型"},{default:r(()=>[t(l(g),{value:a.llm.models.toolCall,"onUpdate:value":e[37]||(e[37]=u=>a.llm.models.toolCall=u),placeholder:"Function Calling 模型",readonly:"",onClick:e[38]||(e[38]=u=>f("models.toolCall"))},{suffix:r(()=>[t(l(U),{size:"small",onClick:e[36]||(e[36]=M(u=>f("models.toolCall"),["stop"]))},{default:r(()=>[...e[99]||(e[99]=[i("选择",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),t(l(o),{label:"搜索模型"},{default:r(()=>[t(l(g),{value:a.llm.models.search,"onUpdate:value":e[40]||(e[40]=u=>a.llm.models.search=u),placeholder:"联网搜索使用的模型",readonly:"",onClick:e[41]||(e[41]=u=>f("models.search"))},{suffix:r(()=>[t(l(U),{size:"small",onClick:e[39]||(e[39]=M(u=>f("models.search"),["stop"]))},{default:r(()=>[...e[100]||(e[100]=[i("选择",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),t(l(o),{label:"思考模型"},{default:r(()=>[t(l(g),{value:a.llm.models.reasoning,"onUpdate:value":e[43]||(e[43]=u=>a.llm.models.reasoning=u),placeholder:"深度推理使用的模型",readonly:"",onClick:e[44]||(e[44]=u=>f("models.reasoning"))},{suffix:r(()=>[t(l(U),{size:"small",onClick:e[42]||(e[42]=M(u=>f("models.reasoning"),["stop"]))},{default:r(()=>[...e[101]||(e[101]=[i("选择",-1)])]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),t(l(x),{title:"伪人模式"},{default:r(()=>[t(l(k),{"label-placement":"left","label-width":"140"},{default:r(()=>[t(l(o),{label:"启用"},{default:r(()=>[t(l(s),{value:a.bym.enable,"onUpdate:value":e[45]||(e[45]=u=>a.bym.enable=u)},null,8,["value"])]),_:1}),t(l(o),{label:"触发概率"},{default:r(()=>[t(l(P),{vertical:"",style:{width:"100%"}},{default:r(()=>[t(l($),{value:a.bym.probability,"onUpdate:value":e[46]||(e[46]=u=>a.bym.probability=u),min:0,max:1,step:.01,marks:{0:"0%",.5:"50%",1:"100%"}},null,8,["value"]),t(l(R),{value:a.bym.probability,"onUpdate:value":e[47]||(e[47]=u=>a.bym.probability=u),min:0,max:1,step:.01,size:"small",style:{width:"120px"}},null,8,["value"])]),_:1})]),_:1}),t(l(o),{label:"回复温度"},{default:r(()=>[t(l(P),{vertical:"",style:{width:"100%"}},{default:r(()=>[t(l($),{value:a.bym.temperature,"onUpdate:value":e[48]||(e[48]=u=>a.bym.temperature=u),min:0,max:2,step:.1,marks:{0:"0",1:"1",2:"2"}},null,8,["value"]),t(l(R),{value:a.bym.temperature,"onUpdate:value":e[49]||(e[49]=u=>a.bym.temperature=u),min:0,max:2,step:.1,size:"small",style:{width:"120px"}},null,8,["value"])]),_:1})]),_:1}),t(l(o),{label:"最大 Token"},{default:r(()=>[t(l(R),{value:a.bym.maxTokens,"onUpdate:value":e[50]||(e[50]=u=>a.bym.maxTokens=u),min:10,max:1e3,step:10,style:{width:"100%"}},null,8,["value"])]),_:1}),t(l(o),{label:"启用记忆"},{default:r(()=>[t(l(s),{value:a.bym.recall,"onUpdate:value":e[51]||(e[51]=u=>a.bym.recall=u)},null,8,["value"])]),_:1}),t(l(o),{label:"使用模型"},{default:r(()=>[t(l(g),{value:a.bym.model,"onUpdate:value":e[53]||(e[53]=u=>a.bym.model=u),placeholder:"留空使用默认模型",readonly:"",onClick:e[54]||(e[54]=u=>f("bymModel"))},{suffix:r(()=>[t(l(U),{size:"small",onClick:e[52]||(e[52]=M(u=>f("bymModel"),["stop"]))},{default:r(()=>[...e[102]||(e[102]=[i("选择",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),t(l(o),{label:"系统提示词"},{default:r(()=>[t(l(g),{value:a.bym.systemPrompt,"onUpdate:value":e[55]||(e[55]=u=>a.bym.systemPrompt=u),type:"textarea",autosize:{minRows:3,maxRows:6},placeholder:"伪人模式的系统提示词"},null,8,["value"])]),_:1})]),_:1})]),_:1}),t(l(x),{title:"工具调用"},{default:r(()=>[t(l(k),{"label-placement":"left","label-width":"140"},{default:r(()=>[t(l(o),{label:"显示调用日志"},{default:r(()=>[t(l(d),{trigger:"hover"},{trigger:r(()=>[t(l(s),{value:a.tools.showCallLogs,"onUpdate:value":e[56]||(e[56]=u=>a.tools.showCallLogs=u)},null,8,["value"])]),default:r(()=>[e[103]||(e[103]=i(" 开启后，显示工具调用的详细日志 ",-1))]),_:1})]),_:1}),t(l(o),{label:"日志合并转发"},{default:r(()=>[t(l(d),{trigger:"hover"},{trigger:r(()=>[t(l(s),{value:a.tools.useForwardMsg,"onUpdate:value":e[57]||(e[57]=u=>a.tools.useForwardMsg=u)},null,8,["value"])]),default:r(()=>[e[104]||(e[104]=i(" 开启后，工具调用日志使用合并转发发送 ",-1))]),_:1})]),_:1}),t(l(o),{label:"并行执行"},{default:r(()=>[t(l(d),{trigger:"hover"},{trigger:r(()=>[t(l(s),{value:a.tools.parallelExecution,"onUpdate:value":e[58]||(e[58]=u=>a.tools.parallelExecution=u)},null,8,["value"])]),default:r(()=>[e[105]||(e[105]=i(" 开启后，多个无依赖的工具调用会并行执行，提升响应速度 ",-1))]),_:1})]),_:1}),t(l(o),{label:"发送中间回复"},{default:r(()=>[t(l(d),{trigger:"hover"},{trigger:r(()=>[t(l(s),{value:a.tools.sendIntermediateReply,"onUpdate:value":e[59]||(e[59]=u=>a.tools.sendIntermediateReply=u)},null,8,["value"])]),default:r(()=>[e[106]||(e[106]=i(' 开启后，工具调用前会先发送模型的文本回复（如"好的，我来帮你..."） ',-1))]),_:1})]),_:1})]),_:1})]),_:1}),t(l(x),{title:"人格上下文"},{default:r(()=>[t(l(O),{type:"info",style:{"margin-bottom":"16px"}},{default:r(()=>[...e[107]||(e[107]=[i(" 配置独立人格的上下文隔离行为。启用后，不同人格将拥有独立的对话历史。 ",-1)])]),_:1}),t(l(k),{"label-placement":"left","label-width":"140"},{default:r(()=>[t(l(o),{label:"独立上下文"},{default:r(()=>[t(l(d),{trigger:"hover"},{trigger:r(()=>[t(l(s),{value:a.personality.isolateContext.enabled,"onUpdate:value":e[60]||(e[60]=u=>a.personality.isolateContext.enabled=u)},null,8,["value"])]),default:r(()=>[e[108]||(e[108]=i(" 启用后，不同人格的对话历史相互独立，不共享上下文 ",-1))]),_:1})]),_:1}),t(l(o),{label:"切换时清除"},{default:r(()=>[t(l(d),{trigger:"hover"},{trigger:r(()=>[t(l(s),{value:a.personality.isolateContext.clearOnSwitch,"onUpdate:value":e[61]||(e[61]=u=>a.personality.isolateContext.clearOnSwitch=u),disabled:!a.personality.isolateContext.enabled},null,8,["value","disabled"])]),default:r(()=>[e[109]||(e[109]=i(" 切换人格时是否清除原人格的上下文历史 ",-1))]),_:1})]),_:1})]),_:1})]),_:1}),t(l(x),{title:"深度思考"},{default:r(()=>[t(l(k),{"label-placement":"left","label-width":"140"},{default:r(()=>[t(l(o),{label:"显示思考内容"},{default:r(()=>[t(l(d),{trigger:"hover"},{trigger:r(()=>[t(l(s),{value:a.thinking.showThinkingContent,"onUpdate:value":e[62]||(e[62]=u=>a.thinking.showThinkingContent=u)},null,8,["value"])]),default:r(()=>[e[110]||(e[110]=i(" 开启后，显示AI的思考过程 ",-1))]),_:1})]),_:1}),t(l(o),{label:"思考合并转发"},{default:r(()=>[t(l(d),{trigger:"hover"},{trigger:r(()=>[t(l(s),{value:a.thinking.useForwardMsg,"onUpdate:value":e[63]||(e[63]=u=>a.thinking.useForwardMsg=u)},null,8,["value"])]),default:r(()=>[e[111]||(e[111]=i(" 开启后，思考内容使用合并转发发送 ",-1))]),_:1})]),_:1})]),_:1})]),_:1}),t(l(x),{title:"高级功能"},{default:r(()=>[t(l(k),{"label-placement":"left","label-width":"140"},{default:r(()=>[t(l(p),{"title-placement":"left"},{default:r(()=>[...e[112]||(e[112]=[i("群聊总结",-1)])]),_:1}),t(l(o),{label:"启用"},{default:r(()=>[t(l(s),{value:a.features.groupSummary.enabled,"onUpdate:value":e[64]||(e[64]=u=>a.features.groupSummary.enabled=u)},null,8,["value"])]),_:1}),t(l(o),{label:"最大消息数"},{default:r(()=>[t(l(d),{trigger:"hover"},{trigger:r(()=>[t(l(R),{value:a.features.groupSummary.maxMessages,"onUpdate:value":e[65]||(e[65]=u=>a.features.groupSummary.maxMessages=u),min:10,max:500,step:10,style:{width:"150px"}},null,8,["value"])]),default:r(()=>[e[113]||(e[113]=i(" 总结时分析的最大消息数量 ",-1))]),_:1})]),_:1}),t(l(p),{"title-placement":"left"},{default:r(()=>[...e[114]||(e[114]=[i("个人画像",-1)])]),_:1}),t(l(o),{label:"启用"},{default:r(()=>[t(l(s),{value:a.features.userPortrait.enabled,"onUpdate:value":e[66]||(e[66]=u=>a.features.userPortrait.enabled=u)},null,8,["value"])]),_:1}),t(l(o),{label:"最少消息数"},{default:r(()=>[t(l(d),{trigger:"hover"},{trigger:r(()=>[t(l(R),{value:a.features.userPortrait.minMessages,"onUpdate:value":e[67]||(e[67]=u=>a.features.userPortrait.minMessages=u),min:5,max:100,step:5,style:{width:"150px"}},null,8,["value"])]),default:r(()=>[e[115]||(e[115]=i(" 生成画像需要的最少消息数量 ",-1))]),_:1})]),_:1}),t(l(p),{"title-placement":"left"},{default:r(()=>[...e[116]||(e[116]=[i("戳一戳响应",-1)])]),_:1}),t(l(o),{label:"启用"},{default:r(()=>[t(l(d),{trigger:"hover"},{trigger:r(()=>[t(l(s),{value:a.features.poke.enabled,"onUpdate:value":e[68]||(e[68]=u=>a.features.poke.enabled=u)},null,8,["value"])]),default:r(()=>[e[117]||(e[117]=i(" 开启后，被戳时会使用AI人设回复 ",-1))]),_:1})]),_:1}),t(l(o),{label:"自动回戳"},{default:r(()=>[t(l(d),{trigger:"hover"},{trigger:r(()=>[t(l(s),{value:a.features.poke.pokeBack,"onUpdate:value":e[69]||(e[69]=u=>a.features.poke.pokeBack=u),disabled:!a.features.poke.enabled},null,8,["value","disabled"])]),default:r(()=>[e[118]||(e[118]=i(" 回复后自动戳回去 ",-1))]),_:1})]),_:1}),t(l(o),{label:"备用回复"},{default:r(()=>[t(l(g),{value:a.features.poke.message,"onUpdate:value":e[70]||(e[70]=u=>a.features.poke.message=u),placeholder:"AI回复失败时的备用回复",disabled:!a.features.poke.enabled},null,8,["value","disabled"])]),_:1}),t(l(p),{"title-placement":"left"},{default:r(()=>[...e[119]||(e[119]=[i("表情回应",-1)])]),_:1}),t(l(o),{label:"启用"},{default:r(()=>[t(l(d),{trigger:"hover"},{trigger:r(()=>[t(l(s),{value:a.features.reaction.enabled,"onUpdate:value":e[71]||(e[71]=u=>a.features.reaction.enabled=u)},null,8,["value"])]),default:r(()=>[e[120]||(e[120]=i(" 开启后，收到表情回应时会使用AI人设处理（需适配器支持） ",-1))]),_:1})]),_:1}),t(l(p),{"title-placement":"left"},{default:r(()=>[...e[121]||(e[121]=[i("AI 图片生成",-1)])]),_:1}),t(l(o),{label:"启用"},{default:r(()=>[t(l(d),{trigger:"hover"},{trigger:r(()=>[t(l(s),{value:a.features.imageGen.enabled,"onUpdate:value":e[72]||(e[72]=u=>a.features.imageGen.enabled=u)},null,8,["value"])]),default:r(()=>[e[122]||(e[122]=i(" 开启后可使用 #文生图、#图生图、#手办化 等命令 ",-1))]),_:1})]),_:1}),t(l(o),{label:"API地址"},{default:r(()=>[t(l(g),{value:a.features.imageGen.apiUrl,"onUpdate:value":e[73]||(e[73]=u=>a.features.imageGen.apiUrl=u),placeholder:"图片生成API地址",disabled:!a.features.imageGen.enabled},null,8,["value","disabled"])]),_:1}),t(l(o),{label:"API密钥"},{default:r(()=>[t(l(g),{value:a.features.imageGen.apiKey,"onUpdate:value":e[74]||(e[74]=u=>a.features.imageGen.apiKey=u),type:"password","show-password-on":"click",placeholder:"API密钥",disabled:!a.features.imageGen.enabled},null,8,["value","disabled"])]),_:1}),t(l(o),{label:"模型名称"},{default:r(()=>[t(l(g),{value:a.features.imageGen.model,"onUpdate:value":e[75]||(e[75]=u=>a.features.imageGen.model=u),placeholder:"gemini-3-pro-image",disabled:!a.features.imageGen.enabled},null,8,["value","disabled"])]),_:1}),t(l(p),{"title-placement":"left"},{default:r(()=>[...e[123]||(e[123]=[i("长期记忆",-1)])]),_:1}),t(l(o),{label:"启用记忆"},{default:r(()=>[t(l(d),{trigger:"hover"},{trigger:r(()=>[t(l(s),{value:a.memory.enabled,"onUpdate:value":e[76]||(e[76]=u=>a.memory.enabled=u)},null,8,["value"])]),default:r(()=>[e[124]||(e[124]=i(" 启用后，AI会记住用户透露的个人信息和偏好 ",-1))]),_:1})]),_:1}),t(l(o),{label:"自动提取"},{default:r(()=>[t(l(d),{trigger:"hover"},{trigger:r(()=>[t(l(s),{value:a.memory.autoExtract,"onUpdate:value":e[77]||(e[77]=u=>a.memory.autoExtract=u),disabled:!a.memory.enabled},null,8,["value","disabled"])]),default:r(()=>[e[125]||(e[125]=i(" 自动从对话中提取值得记忆的信息 ",-1))]),_:1})]),_:1})]),_:1})]),_:1}),t(l(O),{type:"info",title:"命令提示",style:{"margin-top":"8px"}},{default:r(()=>[...e[126]||(e[126]=[m("div",null,[i("• "),m("strong",null,"#群聊总结"),i(" - 总结群聊消息")],-1),m("div",null,[i("• "),m("strong",null,"#个人画像"),i(" - 分析自己的用户画像")],-1),m("div",null,[i("• "),m("strong",null,"#分析 @用户"),i(" - 分析指定用户的画像")],-1),m("div",null,[i("• "),m("strong",null,"#文生图 描述"),i(" - 文字生成图片")],-1),m("div",null,[i("• "),m("strong",null,"#图生图 描述"),i(" - 图片转换处理 (需引用/发送图片)")],-1),m("div",null,[i("• "),m("strong",null,"#手办化 / #Q版 / #动漫化"),i(" - 预设效果 (需图片)")],-1)])]),_:1}),t(l(P),{justify:"end",style:{"margin-top":"16px",position:"sticky",bottom:"16px",background:"var(--n-color)",padding:"12px","border-radius":"8px","box-shadow":"0 -2px 8px rgba(0,0,0,0.1)"}},{default:r(()=>[t(l(U),{type:"primary",size:"large",onClick:H,loading:j.value},{default:r(()=>[...e[127]||(e[127]=[i(" 保存配置 ",-1)])]),_:1},8,["loading"])]),_:1}),t(l(re),{show:I.value,"onUpdate:show":e[78]||(e[78]=u=>I.value=u),preset:"card",title:"选择模型",style:{width:"800px","max-height":"85vh"}},{default:r(()=>[t(ue,{"all-models":K.value,value:[],multiple:!1,"onUpdate:value":J},null,8,["all-models"])]),_:1},8,["show"])]),_:1})}}};export{we as default};
