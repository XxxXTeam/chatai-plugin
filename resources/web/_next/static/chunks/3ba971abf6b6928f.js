(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,5945,e=>{"use strict";var a=e.i(33169),i=e.i(60844),l=e.i(8422),s=e.i(17171),t=e.i(91132),n=e.i(51200),r=e.i(72029),o=e.i(30243),d=e.i(99573),c=e.i(13107),m=e.i(20308),h=e.i(20650),b=e.i(81080),x=e.i(10201),u=e.i(79342),g=e.i(64625),p=e.i(89908),y=e.i(5850),j=e.i(40204),v=e.i(96173),C=e.i(15204),f=e.i(63959),N=e.i(98858),P=e.i(74940),T=e.i(17286),E=e.i(10273),w=e.i(70620),M=e.i(32308),S=e.i(79923),k=e.i(10148),I=e.i(57345),L=e.i(36393),_=e.i(72024),G=e.i(60001),R=e.i(60713),K=e.i(35771),V=e.i(14775);let U=(0,e.i(50974).default)("mouse-pointer-2",[["path",{d:"M4.037 4.688a.495.495 0 0 1 .651-.651l16 6.5a.5.5 0 0 1-.063.947l-6.124 1.58a2 2 0 0 0-1.438 1.435l-1.579 6.126a.5.5 0 0 1-.947.063z",key:"edeuup"}]]);var B=e.i(82251),A=e.i(75979);function H({icon:e,title:i,desc:l,value:s,onChange:t,children:n}){return(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 rounded-md bg-muted",children:e}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:i}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:l})]})]}),(0,a.jsxs)(x.Select,{value:s,onValueChange:t,children:[(0,a.jsx)(x.SelectTrigger,{className:"w-24",children:(0,a.jsx)(x.SelectValue,{})}),(0,a.jsxs)(x.SelectContent,{children:[(0,a.jsx)(x.SelectItem,{value:"inherit",children:"ç»§æ‰¿"}),(0,a.jsx)(x.SelectItem,{value:"on",children:"å¼€å¯"}),(0,a.jsx)(x.SelectItem,{value:"off",children:"å…³é—­"})]})]})]}),n]})}var z=e.i(84519);function D({label:e="æ¦‚çŽ‡",value:i,onChange:l,disabled:s=!1,className:t}){let n="inherit"===i?1:i;return(0,a.jsxs)("div",{className:`flex items-center gap-2 ${t} ${s?"opacity-50 pointer-events-none":""}`,children:[(0,a.jsx)(d.Label,{className:"text-xs w-16",children:e}),(0,a.jsx)(z.Slider,{value:[n],onValueChange:([e])=>l(e),min:0,max:1,step:.05,disabled:s,className:"flex-1"}),(0,a.jsxs)("span",{className:"text-xs w-10 text-right",children:[Math.round(100*n),"%"]})]})}function F({icon:e,title:i,enabled:l,onEnabledChange:s,probability:t,onProbabilityChange:n,children:r}){return(0,a.jsxs)("div",{className:"rounded-lg border overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-muted/30",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[e,(0,a.jsx)("span",{className:"text-sm font-medium",children:i})]}),(0,a.jsxs)(x.Select,{value:l,onValueChange:s,children:[(0,a.jsx)(x.SelectTrigger,{className:"w-24 h-8",children:(0,a.jsx)(x.SelectValue,{})}),(0,a.jsxs)(x.SelectContent,{children:[(0,a.jsx)(x.SelectItem,{value:"inherit",children:"ç»§æ‰¿"}),(0,a.jsx)(x.SelectItem,{value:"on",children:"å¼€å¯"}),(0,a.jsx)(x.SelectItem,{value:"off",children:"å…³é—­"})]})]})]}),"on"===l&&(0,a.jsxs)("div",{className:"p-3 space-y-3 border-t",children:[(0,a.jsx)(D,{value:t,onChange:n}),r]})]})}function Q({label:e,value:i,onChange:l,min:t,max:n,step:r,placeholder:c,className:m,containerClassName:h,description:b,...x}){return(0,a.jsxs)("div",{className:(0,s.cn)("space-y-1",h),children:[(0,a.jsx)(d.Label,{className:"text-xs",children:e}),(0,a.jsx)(o.Input,{type:"number",value:i,onChange:l,min:t,max:n,step:r,placeholder:c,className:(0,s.cn)("h-8",m),...x}),b&&(0,a.jsx)("p",{className:"text-[10px] text-muted-foreground",children:b})]})}function O({label:e,value:i,models:l,onChange:t,placeholder:n="ä½¿ç”¨å…¨å±€é…ç½®",className:r}){return(0,a.jsxs)("div",{className:(0,s.cn)("space-y-1",r),children:[(0,a.jsx)(d.Label,{className:"text-xs",children:e}),(0,a.jsxs)(x.Select,{value:i||"__default__",onValueChange:e=>t("__default__"===e?"":e),children:[(0,a.jsx)(x.SelectTrigger,{children:(0,a.jsx)(x.SelectValue,{placeholder:n})}),(0,a.jsxs)(x.SelectContent,{className:"max-h-[200px]",children:[(0,a.jsx)(x.SelectItem,{value:"__default__",children:n}),l.map(e=>(0,a.jsx)(x.SelectItem,{value:e,children:e},e))]})]})]})}var $=e.i(13795);function q({id:e}){let z=(0,l.useRouter)(),q=(0,t.useIsMobile)(),X="new"===e,[Z,J]=(0,i.useState)(!X),[W,Y]=(0,i.useState)(!1),[ee,ea]=(0,i.useState)("basic"),[ei,el]=(0,i.useState)([]),[es,et]=(0,i.useState)([]),[en,er]=(0,i.useState)([]),[eo,ed]=(0,i.useState)(!1),[ec,em]=(0,i.useState)(null),[eh,eb]=(0,i.useState)({name:"",baseUrl:"",apiKey:"",adapterType:"openai",models:"",enabled:!0,priority:0,modelsPath:"",chatPath:"",imageTransferMode:"auto",imageCompress:!0,imageQuality:85,imageMaxSize:4096}),[ex,eu]=(0,i.useState)({groupId:"",groupName:"",enabled:!0,presetId:"",systemPrompt:"",triggerMode:"default",customPrefix:"",chatModel:"",summaryModel:"",bymModel:"",gameModel:"",imageGenModel:"",gameProbability:"inherit",gameEnableTools:"inherit",gameTemperature:"inherit",gameMaxTokens:"inherit",toolsEnabled:"inherit",imageGenEnabled:"inherit",summaryEnabled:"inherit",eventEnabled:"inherit",bymEnabled:"inherit",bymPresetId:"",bymPrompt:"",bymProbability:"inherit",bymTemperature:"inherit",bymMaxTokens:"inherit",bymReplyLength:"medium",bymUseEmoji:!0,proactiveChatEnabled:"inherit",proactiveChatProbability:"inherit",proactiveChatCooldown:"inherit",proactiveChatMaxDaily:"inherit",proactiveChatMinMessages:5,proactiveChatTimeStart:8,proactiveChatTimeEnd:23,welcomeEnabled:"inherit",welcomeMessage:"",welcomePrompt:"",welcomeProbability:"inherit",goodbyeEnabled:"inherit",goodbyePrompt:"",goodbyeProbability:"inherit",pokeEnabled:"inherit",pokeBack:!1,pokeProbability:"inherit",recallEnabled:"inherit",recallProbability:"inherit",banEnabled:"inherit",banProbability:"inherit",luckyKingEnabled:"inherit",luckyKingProbability:"inherit",honorEnabled:"inherit",honorProbability:"inherit",essenceEnabled:"inherit",essenceProbability:"inherit",adminEnabled:"inherit",adminProbability:"inherit",emojiThiefEnabled:"inherit",emojiThiefSeparateFolder:!0,emojiThiefMaxCount:500,emojiThiefStealRate:1,emojiThiefTriggerRate:.05,emojiThiefTriggerMode:"off",chatContextLength:20,chatStreamReply:!0,chatQuoteReply:!1,chatShowThinking:!0,listMode:"none",blacklist:[],whitelist:[],summaryPushEnabled:!1,summaryPushIntervalType:"day",summaryPushIntervalValue:1,summaryPushHour:20,summaryPushMessageCount:100,independentChannels:[],forbidGlobalModel:!1,dailyGroupLimit:0,dailyUserLimit:0,usageLimitMessage:"",knowledgeIds:[]});(0,i.useEffect)(()=>{eg()},[e]);let eg=async()=>{try{let[a,i,l]=await Promise.all([A.presetsApi.list(),A.channelsApi.list(),A.knowledgeApi.list()]);el(a?.data||[]),et((l?.data||[]).map(e=>({id:e.id,name:e.name})));let s=new Set;if((i?.data||[]).forEach(e=>{Array.isArray(e.models)&&e.models.forEach(e=>s.add(e))}),er(Array.from(s).sort()),!X){let a=await A.scopeApi.getGroups(),i=(a?.data||[]).find(a=>a.groupId===e);if(i){let e=i.settings||{};eu({groupId:i.groupId,groupName:i.groupName||"",enabled:!1!==i.enabled,presetId:i.presetId||"",systemPrompt:i.systemPrompt||"",triggerMode:e.triggerMode||"default",customPrefix:e.customPrefix||"",chatModel:e.chatModel||"",summaryModel:e.summaryModel||"",bymModel:e.bymModel||"",gameModel:e.gameModel||"",imageGenModel:e.imageGenModel||"",gameProbability:void 0===e.gameProbability||"inherit"===e.gameProbability?"inherit":Number(e.gameProbability),gameEnableTools:void 0===e.gameEnableTools?"inherit":e.gameEnableTools?"on":"off",gameTemperature:void 0===e.gameTemperature||"inherit"===e.gameTemperature?"inherit":Number(e.gameTemperature),gameMaxTokens:void 0===e.gameMaxTokens||"inherit"===e.gameMaxTokens?"inherit":Number(e.gameMaxTokens),toolsEnabled:void 0===e.toolsEnabled?"inherit":e.toolsEnabled?"on":"off",imageGenEnabled:void 0===e.imageGenEnabled?"inherit":e.imageGenEnabled?"on":"off",summaryEnabled:void 0===e.summaryEnabled?"inherit":e.summaryEnabled?"on":"off",eventEnabled:void 0===e.eventEnabled?"inherit":e.eventEnabled?"on":"off",bymEnabled:void 0===e.bymEnabled?"inherit":e.bymEnabled?"on":"off",bymPresetId:e.bymPresetId||"",bymPrompt:e.bymPrompt||"",bymProbability:void 0===e.bymProbability||"inherit"===e.bymProbability?"inherit":Number(e.bymProbability),bymTemperature:void 0===e.bymTemperature||"inherit"===e.bymTemperature?"inherit":Number(e.bymTemperature),bymMaxTokens:void 0===e.bymMaxTokens||"inherit"===e.bymMaxTokens?"inherit":Number(e.bymMaxTokens),proactiveChatEnabled:void 0===e.proactiveChatEnabled?"inherit":e.proactiveChatEnabled?"on":"off",proactiveChatProbability:e.proactiveChatProbability??"inherit",proactiveChatCooldown:e.proactiveChatCooldown??"inherit",proactiveChatMaxDaily:e.proactiveChatMaxDaily??"inherit",welcomeEnabled:void 0===e.welcomeEnabled?"inherit":e.welcomeEnabled?"on":"off",welcomeMessage:e.welcomeMessage||"",welcomePrompt:e.welcomePrompt||"",welcomeProbability:e.welcomeProbability??"inherit",goodbyeEnabled:void 0===e.goodbyeEnabled?"inherit":e.goodbyeEnabled?"on":"off",goodbyePrompt:e.goodbyePrompt||"",goodbyeProbability:e.goodbyeProbability??"inherit",pokeEnabled:void 0===e.pokeEnabled?"inherit":e.pokeEnabled?"on":"off",pokeBack:e.pokeBack||!1,pokeProbability:e.pokeProbability??"inherit",recallEnabled:void 0===e.recallEnabled?"inherit":e.recallEnabled?"on":"off",recallProbability:e.recallProbability??"inherit",banEnabled:void 0===e.banEnabled?"inherit":e.banEnabled?"on":"off",banProbability:e.banProbability??"inherit",luckyKingEnabled:void 0===e.luckyKingEnabled?"inherit":e.luckyKingEnabled?"on":"off",luckyKingProbability:e.luckyKingProbability??"inherit",honorEnabled:void 0===e.honorEnabled?"inherit":e.honorEnabled?"on":"off",honorProbability:e.honorProbability??"inherit",essenceEnabled:void 0===e.essenceEnabled?"inherit":e.essenceEnabled?"on":"off",essenceProbability:e.essenceProbability??"inherit",adminEnabled:void 0===e.adminEnabled?"inherit":e.adminEnabled?"on":"off",adminProbability:e.adminProbability??"inherit",emojiThiefEnabled:void 0===e.emojiThiefEnabled?"inherit":e.emojiThiefEnabled?"on":"off",emojiThiefSeparateFolder:e.emojiThiefSeparateFolder??!0,emojiThiefMaxCount:e.emojiThiefMaxCount??500,emojiThiefStealRate:e.emojiThiefStealRate??1,emojiThiefTriggerRate:e.emojiThiefTriggerRate??.05,emojiThiefTriggerMode:e.emojiThiefTriggerMode||"off",bymReplyLength:e.bymReplyLength||"medium",bymUseEmoji:e.bymUseEmoji??!0,proactiveChatMinMessages:e.proactiveChatMinMessages??5,proactiveChatTimeStart:e.proactiveChatTimeStart??8,proactiveChatTimeEnd:e.proactiveChatTimeEnd??23,chatContextLength:e.chatContextLength??20,chatStreamReply:e.chatStreamReply??!0,chatQuoteReply:e.chatQuoteReply??!1,chatShowThinking:e.chatShowThinking??!0,listMode:e.listMode||"none",blacklist:e.blacklist||[],whitelist:e.whitelist||[],summaryPushEnabled:e.summaryPushEnabled??!1,summaryPushIntervalType:e.summaryPushIntervalType||"day",summaryPushIntervalValue:e.summaryPushIntervalValue??1,summaryPushHour:e.summaryPushHour??20,summaryPushMessageCount:e.summaryPushMessageCount??100,independentChannels:e.independentChannels||[],forbidGlobalModel:e.forbidGlobalModel||!1,dailyGroupLimit:e.usageLimit?.dailyGroupLimit||0,dailyUserLimit:e.usageLimit?.dailyUserLimit||0,usageLimitMessage:e.usageLimit?.limitMessage||"",knowledgeIds:i.knowledgeIds||[]})}}}catch(e){console.error("åŠ è½½æ•°æ®å¤±è´¥",e),u.toast.error("åŠ è½½æ•°æ®å¤±è´¥")}finally{J(!1)}},ep=async()=>{if(!ex.groupId)return void u.toast.error("è¯·å¡«å†™ç¾¤å·");Y(!0);try{await A.scopeApi.updateGroup(ex.groupId,{groupName:ex.groupName,presetId:ex.presetId||void 0,systemPrompt:ex.systemPrompt||void 0,enabled:ex.enabled,knowledgeIds:ex.knowledgeIds.length>0?ex.knowledgeIds:void 0,triggerMode:ex.triggerMode,customPrefix:ex.customPrefix||void 0,chatModel:ex.chatModel||void 0,summaryModel:ex.summaryModel||void 0,bymModel:ex.bymModel||void 0,gameModel:ex.gameModel||void 0,imageGenModel:ex.imageGenModel||void 0,gameProbability:"inherit"===ex.gameProbability?void 0:ex.gameProbability,gameEnableTools:"inherit"===ex.gameEnableTools?void 0:"on"===ex.gameEnableTools,gameTemperature:"inherit"===ex.gameTemperature?void 0:ex.gameTemperature,gameMaxTokens:"inherit"===ex.gameMaxTokens?void 0:ex.gameMaxTokens,toolsEnabled:"inherit"===ex.toolsEnabled?void 0:"on"===ex.toolsEnabled,imageGenEnabled:"inherit"===ex.imageGenEnabled?void 0:"on"===ex.imageGenEnabled,summaryEnabled:"inherit"===ex.summaryEnabled?void 0:"on"===ex.summaryEnabled,eventEnabled:"inherit"===ex.eventEnabled?void 0:"on"===ex.eventEnabled,bymEnabled:"inherit"===ex.bymEnabled?void 0:"on"===ex.bymEnabled,bymPresetId:ex.bymPresetId||void 0,bymPrompt:ex.bymPrompt||void 0,bymProbability:"inherit"===ex.bymProbability?void 0:ex.bymProbability,bymTemperature:"inherit"===ex.bymTemperature?void 0:ex.bymTemperature,bymMaxTokens:"inherit"===ex.bymMaxTokens?void 0:ex.bymMaxTokens,proactiveChatEnabled:"inherit"===ex.proactiveChatEnabled?void 0:"on"===ex.proactiveChatEnabled,proactiveChatProbability:"inherit"===ex.proactiveChatProbability?void 0:ex.proactiveChatProbability,proactiveChatCooldown:"inherit"===ex.proactiveChatCooldown?void 0:ex.proactiveChatCooldown,proactiveChatMaxDaily:"inherit"===ex.proactiveChatMaxDaily?void 0:ex.proactiveChatMaxDaily,welcomeEnabled:"inherit"===ex.welcomeEnabled?void 0:"on"===ex.welcomeEnabled,welcomeMessage:ex.welcomeMessage||void 0,welcomePrompt:ex.welcomePrompt||void 0,welcomeProbability:"inherit"===ex.welcomeProbability?void 0:ex.welcomeProbability,goodbyeEnabled:"inherit"===ex.goodbyeEnabled?void 0:"on"===ex.goodbyeEnabled,goodbyePrompt:ex.goodbyePrompt||void 0,goodbyeProbability:"inherit"===ex.goodbyeProbability?void 0:ex.goodbyeProbability,pokeEnabled:"inherit"===ex.pokeEnabled?void 0:"on"===ex.pokeEnabled,pokeBack:ex.pokeBack,pokeProbability:"inherit"===ex.pokeProbability?void 0:ex.pokeProbability,recallEnabled:"inherit"===ex.recallEnabled?void 0:"on"===ex.recallEnabled,recallProbability:"inherit"===ex.recallProbability?void 0:ex.recallProbability,banEnabled:"inherit"===ex.banEnabled?void 0:"on"===ex.banEnabled,banProbability:"inherit"===ex.banProbability?void 0:ex.banProbability,luckyKingEnabled:"inherit"===ex.luckyKingEnabled?void 0:"on"===ex.luckyKingEnabled,luckyKingProbability:"inherit"===ex.luckyKingProbability?void 0:ex.luckyKingProbability,honorEnabled:"inherit"===ex.honorEnabled?void 0:"on"===ex.honorEnabled,honorProbability:"inherit"===ex.honorProbability?void 0:ex.honorProbability,essenceEnabled:"inherit"===ex.essenceEnabled?void 0:"on"===ex.essenceEnabled,essenceProbability:"inherit"===ex.essenceProbability?void 0:ex.essenceProbability,adminEnabled:"inherit"===ex.adminEnabled?void 0:"on"===ex.adminEnabled,adminProbability:"inherit"===ex.adminProbability?void 0:ex.adminProbability,emojiThiefEnabled:"inherit"===ex.emojiThiefEnabled?void 0:"on"===ex.emojiThiefEnabled,emojiThiefSeparateFolder:ex.emojiThiefSeparateFolder,emojiThiefMaxCount:ex.emojiThiefMaxCount,emojiThiefStealRate:ex.emojiThiefStealRate,emojiThiefTriggerRate:ex.emojiThiefTriggerRate,emojiThiefTriggerMode:ex.emojiThiefTriggerMode,bymReplyLength:ex.bymReplyLength,bymUseEmoji:ex.bymUseEmoji,proactiveChatMinMessages:ex.proactiveChatMinMessages,proactiveChatTimeStart:ex.proactiveChatTimeStart,proactiveChatTimeEnd:ex.proactiveChatTimeEnd,chatContextLength:ex.chatContextLength,chatStreamReply:ex.chatStreamReply,chatQuoteReply:ex.chatQuoteReply,chatShowThinking:ex.chatShowThinking,listMode:"none"!==ex.listMode?ex.listMode:void 0,blacklist:ex.blacklist.length>0?ex.blacklist:void 0,whitelist:ex.whitelist.length>0?ex.whitelist:void 0,summaryPushEnabled:ex.summaryPushEnabled,summaryPushIntervalType:ex.summaryPushIntervalType,summaryPushIntervalValue:ex.summaryPushIntervalValue,summaryPushHour:ex.summaryPushHour,summaryPushMessageCount:ex.summaryPushMessageCount,independentChannels:ex.independentChannels.length>0?ex.independentChannels:void 0,forbidGlobalModel:ex.forbidGlobalModel,usageLimit:{dailyGroupLimit:ex.dailyGroupLimit,dailyUserLimit:ex.dailyUserLimit,limitMessage:ex.usageLimitMessage||void 0}}),u.toast.success("ä¿å­˜æˆåŠŸ"),X&&z.push("/groups")}catch(e){console.error("ä¿å­˜å¤±è´¥",e),u.toast.error("ä¿å­˜å¤±è´¥")}finally{Y(!1)}};if(Z)return(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)(p.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})});let ey=[{id:"basic",label:"åŸºç¡€",icon:(0,a.jsx)(j.Settings,{className:"h-4 w-4"})},{id:"features",label:"åŠŸèƒ½",icon:(0,a.jsx)(v.Zap,{className:"h-4 w-4"})},{id:"bym",label:"ä¼ªäºº",icon:(0,a.jsx)(L.Smile,{className:"h-4 w-4"})},{id:"game",label:"æ¸¸æˆ",icon:(0,a.jsx)(B.Gamepad2,{className:"h-4 w-4"})},{id:"channel",label:"æ¸ é“",icon:(0,a.jsx)(_.Server,{className:"h-4 w-4"})},{id:"advanced",label:"é«˜çº§",icon:(0,a.jsx)(C.Sparkles,{className:"h-4 w-4"})}];return(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-4 space-y-4 flex-1 h-full flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0",children:[(0,a.jsx)(r.Button,{variant:"ghost",size:"icon",className:"shrink-0",onClick:()=>z.push("/groups"),children:(0,a.jsx)(g.ArrowLeft,{className:"h-5 w-5"})}),(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsx)("h1",{className:"text-xl sm:text-2xl font-bold truncate",children:X?"æ·»åŠ ç¾¤ç»„":"ç¼–è¾‘ç¾¤ç»„"}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-muted-foreground truncate",children:X?"é…ç½®æ–°ç¾¤ç»„çš„ä¸ªæ€§åŒ–è®¾ç½®":`ç¾¤å·: ${ex.groupId}`})]})]}),(0,a.jsxs)(r.Button,{onClick:ep,disabled:W,size:"sm",className:"shrink-0",children:[W?(0,a.jsx)(p.Loader2,{className:"h-4 w-4 sm:mr-2 animate-spin"}):(0,a.jsx)(y.Save,{className:"h-4 w-4 sm:mr-2"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"ä¿å­˜"})]})]}),(0,a.jsxs)(b.Tabs,{value:ee,onValueChange:ea,className:(0,s.cn)(!q&&"flex gap-6","flex-1 min-h-0"),children:[q?(0,a.jsx)(b.TabsList,{className:"grid w-full grid-cols-6 h-auto mb-3",children:ey.map(e=>(0,a.jsx)(b.TabsTrigger,{value:e.id,className:"text-xs px-1 py-2",children:e.icon},e.id))}):(0,a.jsx)("nav",{className:"w-48 shrink-0",children:(0,a.jsx)("div",{className:"sticky top-4 space-y-1",children:ey.map(e=>(0,a.jsxs)("button",{onClick:()=>ea(e.id),className:(0,s.cn)("w-full flex items-center gap-2.5 px-3 py-2.5 rounded-lg text-sm font-medium transition-all",ee===e.id?"bg-primary text-primary-foreground shadow-sm":"text-muted-foreground hover:text-foreground hover:bg-muted"),children:[e.icon,e.label]},e.id))})}),(0,a.jsxs)("div",{className:(0,s.cn)(!q&&"flex-1 min-w-0"),children:[(0,a.jsxs)(b.TabsContent,{value:"basic",className:"space-y-4",children:[(0,a.jsxs)(n.Card,{children:[(0,a.jsx)(n.CardHeader,{children:(0,a.jsxs)(n.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(M.Users,{className:"h-4 w-4"}),"åŸºæœ¬ä¿¡æ¯"]})}),(0,a.jsxs)(n.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{children:"ç¾¤å· *"}),(0,a.jsx)(o.Input,{value:ex.groupId,onChange:e=>eu({...ex,groupId:e.target.value}),placeholder:"è¾“å…¥ç¾¤å·",disabled:!X})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{children:"ç¾¤åç§°"}),(0,a.jsx)(o.Input,{value:ex.groupName,onChange:e=>eu({...ex,groupName:e.target.value}),placeholder:"ç¾¤åç§°ï¼ˆå¯é€‰ï¼‰"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(N.Power,{className:"h-4 w-4 text-green-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:"å¯ç”¨æœ¬ç¾¤"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"å…³é—­åŽæœºå™¨äººå°†ä¸å“åº”æœ¬ç¾¤æ¶ˆæ¯"})]})]}),(0,a.jsx)(m.Switch,{checked:ex.enabled,onCheckedChange:e=>eu({...ex,enabled:e})})]})]})]}),(0,a.jsxs)(n.Card,{children:[(0,a.jsx)(n.CardHeader,{children:(0,a.jsxs)(n.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(E.MessageSquare,{className:"h-4 w-4"}),"è§¦å‘è®¾ç½®"]})}),(0,a.jsxs)(n.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{children:"è§¦å‘æ¨¡å¼"}),(0,a.jsxs)(x.Select,{value:ex.triggerMode,onValueChange:e=>eu({...ex,triggerMode:e}),children:[(0,a.jsx)(x.SelectTrigger,{children:(0,a.jsx)(x.SelectValue,{})}),(0,a.jsxs)(x.SelectContent,{children:[(0,a.jsx)(x.SelectItem,{value:"default",children:"é»˜è®¤ï¼ˆ@æˆ–å‰ç¼€ï¼‰"}),(0,a.jsx)(x.SelectItem,{value:"at",children:"ä»…@è§¦å‘"}),(0,a.jsx)(x.SelectItem,{value:"prefix",children:"ä»…å‰ç¼€è§¦å‘"}),(0,a.jsx)(x.SelectItem,{value:"all",children:"æ‰€æœ‰æ¶ˆæ¯è§¦å‘"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{children:"è‡ªå®šä¹‰å‰ç¼€"}),(0,a.jsx)(o.Input,{value:ex.customPrefix,onChange:e=>eu({...ex,customPrefix:e.target.value}),placeholder:"ç•™ç©ºä½¿ç”¨å…¨å±€å‰ç¼€"})]})]})]}),(0,a.jsxs)(n.Card,{children:[(0,a.jsx)(n.CardHeader,{children:(0,a.jsxs)(n.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(f.BookOpen,{className:"h-4 w-4"}),"äººè®¾ä¸Žé¢„è®¾"]})}),(0,a.jsxs)(n.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{children:"é€‰æ‹©é¢„è®¾"}),(0,a.jsxs)(x.Select,{value:ex.presetId||"__none__",onValueChange:e=>eu({...ex,presetId:"__none__"===e?"":e}),children:[(0,a.jsx)(x.SelectTrigger,{children:(0,a.jsx)(x.SelectValue,{placeholder:"ä¸ä½¿ç”¨é¢„è®¾"})}),(0,a.jsxs)(x.SelectContent,{children:[(0,a.jsx)(x.SelectItem,{value:"__none__",children:"ä¸ä½¿ç”¨é¢„è®¾"}),ei.map(e=>(0,a.jsx)(x.SelectItem,{value:e.id,children:e.name},e.id))]})]})]}),(0,a.jsx)("div",{className:"space-y-2",children:(0,a.jsx)(O,{label:"å¯¹è¯æ¨¡åž‹",value:ex.chatModel,models:en,onChange:e=>eu({...ex,chatModel:e}),placeholder:"ä½¿ç”¨å…¨å±€"})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{children:"ç³»ç»Ÿæç¤ºè¯"}),(0,a.jsx)(h.Textarea,{value:ex.systemPrompt,onChange:e=>eu({...ex,systemPrompt:e.target.value}),placeholder:"ç•™ç©ºä½¿ç”¨é¢„è®¾æˆ–å…¨å±€æç¤ºè¯",rows:3})]})]})]}),(0,a.jsxs)(n.Card,{children:[(0,a.jsx)(n.CardHeader,{children:(0,a.jsxs)(n.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(E.MessageSquare,{className:"h-4 w-4"}),"èŠå¤©é…ç½®"]})}),(0,a.jsx)(n.CardContent,{className:"space-y-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-3",children:[(0,a.jsx)(Q,{label:"ä¸Šä¸‹æ–‡é•¿åº¦",min:1,max:100,value:ex.chatContextLength,onChange:e=>eu({...ex,chatContextLength:parseInt(e.target.value)||20})}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(d.Label,{className:"text-xs",children:"æµå¼å›žå¤"}),(0,a.jsx)(m.Switch,{checked:ex.chatStreamReply,onCheckedChange:e=>eu({...ex,chatStreamReply:e})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(d.Label,{className:"text-xs",children:"å¼•ç”¨å›žå¤"}),(0,a.jsx)(m.Switch,{checked:ex.chatQuoteReply,onCheckedChange:e=>eu({...ex,chatQuoteReply:e})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(d.Label,{className:"text-xs",children:"æ˜¾ç¤ºæ€è€ƒ"}),(0,a.jsx)(m.Switch,{checked:ex.chatShowThinking,onCheckedChange:e=>eu({...ex,chatShowThinking:e})})]})]})})]})]}),(0,a.jsxs)(b.TabsContent,{value:"features",className:"space-y-4",children:[(0,a.jsxs)(n.Card,{children:[(0,a.jsx)(n.CardHeader,{children:(0,a.jsx)(n.CardTitle,{className:"text-base",children:"åŠŸèƒ½å¼€å…³"})}),(0,a.jsxs)(n.CardContent,{className:"space-y-3",children:[(0,a.jsx)(H,{icon:(0,a.jsx)(v.Zap,{className:"h-4 w-4 text-yellow-500"}),title:"å·¥å…·è°ƒç”¨",desc:"å…è®¸AIè°ƒç”¨å¤–éƒ¨å·¥å…·",value:ex.toolsEnabled,onChange:e=>eu({...ex,toolsEnabled:e})}),(0,a.jsx)(H,{icon:(0,a.jsx)(T.Image,{className:"h-4 w-4 text-pink-500"}),title:"ç»˜å›¾åŠŸèƒ½",desc:"æ–‡ç”Ÿå›¾ã€å›¾ç”Ÿå›¾ç­‰",value:ex.imageGenEnabled,onChange:e=>eu({...ex,imageGenEnabled:e})}),"on"===ex.imageGenEnabled&&(0,a.jsx)("div",{className:"ml-12 p-3 rounded-lg bg-muted/50 space-y-2",children:(0,a.jsx)(O,{label:"ç»˜å›¾æ¨¡åž‹",value:ex.imageGenModel,models:en.filter(e=>e.includes("dall")||e.includes("flux")||e.includes("image")),onChange:e=>eu({...ex,imageGenModel:e}),placeholder:"ç»§æ‰¿å…¨å±€"})}),(0,a.jsx)(H,{icon:(0,a.jsx)(f.BookOpen,{className:"h-4 w-4 text-blue-500"}),title:"ç¾¤èŠæ€»ç»“",desc:"è‡ªåŠ¨æ€»ç»“ç¾¤èŠå†…å®¹",value:ex.summaryEnabled,onChange:e=>eu({...ex,summaryEnabled:e})}),"on"===ex.summaryEnabled&&(0,a.jsxs)("div",{className:"ml-12 p-3 rounded-lg bg-muted/50 space-y-3",children:[(0,a.jsx)("div",{className:"space-y-2",children:(0,a.jsx)(O,{label:"æ€»ç»“æ¨¡åž‹",value:ex.summaryModel,models:en,onChange:e=>eu({...ex,summaryModel:e}),placeholder:"ç»§æ‰¿å…¨å±€"})}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:"å®šæ—¶æŽ¨é€"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"è‡ªåŠ¨å®šæ—¶æŽ¨é€ç¾¤èŠæ€»ç»“"})]}),(0,a.jsx)(m.Switch,{checked:ex.summaryPushEnabled,onCheckedChange:e=>eu({...ex,summaryPushEnabled:e})})]}),ex.summaryPushEnabled&&(0,a.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(d.Label,{className:"text-xs",children:"é—´éš”ç±»åž‹"}),(0,a.jsxs)(x.Select,{value:ex.summaryPushIntervalType,onValueChange:e=>eu({...ex,summaryPushIntervalType:e}),children:[(0,a.jsx)(x.SelectTrigger,{className:"h-9",children:(0,a.jsx)(x.SelectValue,{})}),(0,a.jsxs)(x.SelectContent,{children:[(0,a.jsx)(x.SelectItem,{value:"hour",children:"æ¯Xå°æ—¶"}),(0,a.jsx)(x.SelectItem,{value:"day",children:"æ¯Xå¤©"})]})]})]}),(0,a.jsx)(Q,{label:"é—´éš”å€¼",min:1,value:ex.summaryPushIntervalValue,onChange:e=>eu({...ex,summaryPushIntervalValue:parseInt(e.target.value)||1})}),"day"===ex.summaryPushIntervalType&&(0,a.jsx)(Q,{label:"æŽ¨é€æ—¶é—´(ç‚¹)",min:0,max:23,value:ex.summaryPushHour,onChange:e=>eu({...ex,summaryPushHour:parseInt(e.target.value)||20})}),(0,a.jsx)(Q,{label:"æ¶ˆæ¯æ•°é‡",min:10,value:ex.summaryPushMessageCount,onChange:e=>eu({...ex,summaryPushMessageCount:parseInt(e.target.value)||100})})]})]}),(0,a.jsx)(H,{icon:(0,a.jsx)(C.Sparkles,{className:"h-4 w-4 text-purple-500"}),title:"äº‹ä»¶å“åº”",desc:"å…¥ç¾¤ã€é€€ç¾¤ã€æˆ³ä¸€æˆ³ç­‰ï¼ˆå¼€å¯åŽåœ¨ä¸‹æ–¹é…ç½®è¯¦æƒ…ï¼‰",value:ex.eventEnabled,onChange:e=>eu({...ex,eventEnabled:e})}),(0,a.jsx)(H,{icon:(0,a.jsx)(V.Palette,{className:"h-4 w-4 text-cyan-500"}),title:"è¡¨æƒ…åŒ…å°å·",desc:"è‡ªåŠ¨æ”¶é›†å’Œå‘é€è¡¨æƒ…åŒ…",value:ex.emojiThiefEnabled,onChange:e=>eu({...ex,emojiThiefEnabled:e})}),"on"===ex.emojiThiefEnabled&&(0,a.jsxs)("div",{className:"ml-12 p-4 rounded-lg bg-muted/30 border space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border bg-card",children:[(0,a.jsxs)("div",{className:"space-y-0.5",children:[(0,a.jsx)(d.Label,{className:"text-sm font-medium",children:"ç‹¬ç«‹å­˜å‚¨"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"æœ¬ç¾¤è¡¨æƒ…åŒ…ç‹¬ç«‹å­˜å‚¨ï¼Œä¸ä¸Žå…¶ä»–ç¾¤å…±äº«"})]}),(0,a.jsx)(m.Switch,{checked:ex.emojiThiefSeparateFolder,onCheckedChange:e=>eu({...ex,emojiThiefSeparateFolder:e})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)(Q,{label:"æœ€å¤§æ”¶é›†æ•°",min:10,max:5e3,value:ex.emojiThiefMaxCount,onChange:e=>eu({...ex,emojiThiefMaxCount:parseInt(e.target.value)||500})}),(0,a.jsx)("div",{className:"flex items-end h-full pb-1",children:(0,a.jsx)(D,{label:"æ”¶é›†æ¦‚çŽ‡",value:ex.emojiThiefStealRate,onChange:e=>eu({...ex,emojiThiefStealRate:e}),className:"w-full"})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{className:"text-xs",children:"éšæœºå‘å›¾æ¨¡å¼"}),(0,a.jsxs)(x.Select,{value:ex.emojiThiefTriggerMode,onValueChange:e=>eu({...ex,emojiThiefTriggerMode:e}),children:[(0,a.jsx)(x.SelectTrigger,{className:"h-9",children:(0,a.jsx)(x.SelectValue,{})}),(0,a.jsxs)(x.SelectContent,{children:[(0,a.jsx)(x.SelectItem,{value:"off",children:"å…³é—­è‡ªåŠ¨å‘é€"}),(0,a.jsx)(x.SelectItem,{value:"chat_follow",children:"å¯¹è¯è·Ÿéš"}),(0,a.jsx)(x.SelectItem,{value:"chat_random",children:"å¯¹è¯éšæœº"}),(0,a.jsx)(x.SelectItem,{value:"bym_follow",children:"ä¼ªäººè·Ÿéš"}),(0,a.jsx)(x.SelectItem,{value:"bym_random",children:"ä¼ªäººéšæœº"})]})]})]}),(0,a.jsx)("div",{className:"flex items-end h-full pb-1",children:(0,a.jsx)(D,{label:"å‘é€æ¦‚çŽ‡",value:ex.emojiThiefTriggerRate,onChange:e=>eu({...ex,emojiThiefTriggerRate:e}),disabled:"off"===ex.emojiThiefTriggerMode||"chat_follow"===ex.emojiThiefTriggerMode||"bym_follow"===ex.emojiThiefTriggerMode,className:"w-full"})})]}),(0,a.jsx)("p",{className:"text-[10px] text-muted-foreground bg-muted/50 p-2 rounded",children:"ðŸ’¡ è§¦å‘æ¨¡å¼100%å‘é€ï¼Œéšæœºæ¨¡å¼æŒ‰æ¦‚çŽ‡å‘é€ã€‚"})]})]})]}),"off"!==ex.eventEnabled&&(0,a.jsxs)(n.Card,{children:[(0,a.jsxs)(n.CardHeader,{children:[(0,a.jsxs)(n.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(C.Sparkles,{className:"h-4 w-4"}),"äº‹ä»¶é…ç½®"]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"æ¯ä¸ªäº‹ä»¶å¯ç‹¬ç«‹é…ç½®å“åº”æ¦‚çŽ‡ï¼Œå¼€å¯åŽé»˜è®¤100%"})]}),(0,a.jsxs)(n.CardContent,{className:"space-y-4",children:[(0,a.jsxs)(F,{icon:(0,a.jsx)(k.UserPlus,{className:"h-4 w-4 text-green-500"}),title:"å…¥ç¾¤æ¬¢è¿Ž",enabled:ex.welcomeEnabled,onEnabledChange:e=>{let a={welcomeEnabled:e};"on"===e&&"inherit"===ex.welcomeProbability&&(a.welcomeProbability=1),eu({...ex,...a})},probability:ex.welcomeProbability,onProbabilityChange:e=>eu({...ex,welcomeProbability:e}),children:[(0,a.jsx)(o.Input,{value:ex.welcomeMessage,onChange:e=>eu({...ex,welcomeMessage:e.target.value}),placeholder:"å›ºå®šæ¬¢è¿Žè¯­ï¼ˆç•™ç©ºä½¿ç”¨AIç”Ÿæˆï¼‰",className:"h-8 text-sm"}),(0,a.jsx)(h.Textarea,{value:ex.welcomePrompt,onChange:e=>eu({...ex,welcomePrompt:e.target.value}),placeholder:"AIæ¬¢è¿Žæç¤ºè¯",rows:2,className:"text-sm"})]}),(0,a.jsx)(F,{icon:(0,a.jsx)(I.UserMinus,{className:"h-4 w-4 text-red-500"}),title:"é€€ç¾¤å‘Šåˆ«",enabled:ex.goodbyeEnabled,onEnabledChange:e=>{let a={goodbyeEnabled:e};"on"===e&&"inherit"===ex.goodbyeProbability&&(a.goodbyeProbability=1),eu({...ex,...a})},probability:ex.goodbyeProbability,onProbabilityChange:e=>eu({...ex,goodbyeProbability:e}),children:(0,a.jsx)(h.Textarea,{value:ex.goodbyePrompt,onChange:e=>eu({...ex,goodbyePrompt:e.target.value}),placeholder:"AIå‘Šåˆ«æç¤ºè¯",rows:2,className:"text-sm"})}),(0,a.jsx)(F,{icon:(0,a.jsx)(U,{className:"h-4 w-4 text-orange-500"}),title:"æˆ³ä¸€æˆ³",enabled:ex.pokeEnabled,onEnabledChange:e=>{let a={pokeEnabled:e};"on"===e&&"inherit"===ex.pokeProbability&&(a.pokeProbability=1),eu({...ex,...a})},probability:ex.pokeProbability,onProbabilityChange:e=>eu({...ex,pokeProbability:e}),children:(0,a.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t",children:[(0,a.jsx)(d.Label,{className:"text-xs",children:"æˆ³å›žåŽ»"}),(0,a.jsx)(m.Switch,{checked:ex.pokeBack,onCheckedChange:e=>eu({...ex,pokeBack:e})})]})}),(0,a.jsx)(F,{icon:(0,a.jsx)("span",{className:"text-sm",children:"ðŸ”„"}),title:"æ’¤å›žå“åº”",enabled:ex.recallEnabled,onEnabledChange:e=>{let a={recallEnabled:e};"on"===e&&"inherit"===ex.recallProbability&&(a.recallProbability=1),eu({...ex,...a})},probability:ex.recallProbability,onProbabilityChange:e=>eu({...ex,recallProbability:e})}),(0,a.jsx)(F,{icon:(0,a.jsx)("span",{className:"text-sm",children:"ðŸ”‡"}),title:"ç¦è¨€å“åº”",enabled:ex.banEnabled,onEnabledChange:e=>{let a={banEnabled:e};"on"===e&&"inherit"===ex.banProbability&&(a.banProbability=1),eu({...ex,...a})},probability:ex.banProbability,onProbabilityChange:e=>eu({...ex,banProbability:e})}),(0,a.jsx)(F,{icon:(0,a.jsx)("span",{className:"text-sm",children:"ðŸ§§"}),title:"è¿æ°”çŽ‹å“åº”",enabled:ex.luckyKingEnabled,onEnabledChange:e=>{let a={luckyKingEnabled:e};"on"===e&&"inherit"===ex.luckyKingProbability&&(a.luckyKingProbability=1),eu({...ex,...a})},probability:ex.luckyKingProbability,onProbabilityChange:e=>eu({...ex,luckyKingProbability:e})}),(0,a.jsx)(F,{icon:(0,a.jsx)("span",{className:"text-sm",children:"ðŸ†"}),title:"è£èª‰å˜æ›´",enabled:ex.honorEnabled,onEnabledChange:e=>{let a={honorEnabled:e};"on"===e&&"inherit"===ex.honorProbability&&(a.honorProbability=1),eu({...ex,...a})},probability:ex.honorProbability,onProbabilityChange:e=>eu({...ex,honorProbability:e})}),(0,a.jsx)(F,{icon:(0,a.jsx)("span",{className:"text-sm",children:"â­"}),title:"ç²¾åŽæ¶ˆæ¯",enabled:ex.essenceEnabled,onEnabledChange:e=>{let a={essenceEnabled:e};"on"===e&&"inherit"===ex.essenceProbability&&(a.essenceProbability=1),eu({...ex,...a})},probability:ex.essenceProbability,onProbabilityChange:e=>eu({...ex,essenceProbability:e})}),(0,a.jsx)(F,{icon:(0,a.jsx)("span",{className:"text-sm",children:"ðŸ‘‘"}),title:"ç®¡ç†å‘˜å˜æ›´",enabled:ex.adminEnabled,onEnabledChange:e=>{let a={adminEnabled:e};"on"===e&&"inherit"===ex.adminProbability&&(a.adminProbability=1),eu({...ex,...a})},probability:ex.adminProbability,onProbabilityChange:e=>eu({...ex,adminProbability:e})})]})]})]}),(0,a.jsx)(b.TabsContent,{value:"bym",className:"space-y-4",children:(0,a.jsxs)(n.Card,{children:[(0,a.jsxs)(n.CardHeader,{children:[(0,a.jsxs)(n.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(L.Smile,{className:"h-4 w-4"}),"ä¼ªäººæ¨¡å¼"]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"æ¨¡æ‹ŸçœŸäººèŠå¤©é£Žæ ¼ï¼Œéšæœºå‚ä¸Žç¾¤èŠ"})]}),(0,a.jsxs)(n.CardContent,{className:"space-y-4",children:[(0,a.jsx)(H,{icon:(0,a.jsx)(L.Smile,{className:"h-4 w-4 text-orange-500"}),title:"å¯ç”¨ä¼ªäºº",desc:"å¼€å¯åŽæœºå™¨äººä¼šéšæœºå›žå¤ç¾¤æ¶ˆæ¯",value:ex.bymEnabled,onChange:e=>eu({...ex,bymEnabled:e})}),"off"!==ex.bymEnabled&&(0,a.jsxs)("div",{className:"space-y-4 ml-4 pl-4 border-l-2 border-muted",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{children:"ä¼ªäººé¢„è®¾"}),(0,a.jsxs)(x.Select,{value:ex.bymPresetId||"__none__",onValueChange:e=>eu({...ex,bymPresetId:"__none__"===e?"":e}),children:[(0,a.jsx)(x.SelectTrigger,{children:(0,a.jsx)(x.SelectValue,{placeholder:"ä¸ä½¿ç”¨é¢„è®¾"})}),(0,a.jsxs)(x.SelectContent,{children:[(0,a.jsx)(x.SelectItem,{value:"__none__",children:"ä¸ä½¿ç”¨é¢„è®¾"}),ei.map(e=>(0,a.jsx)(x.SelectItem,{value:e.id,children:e.name},e.id))]})]})]}),(0,a.jsx)("div",{className:"space-y-2",children:(0,a.jsx)(O,{label:"ä¼ªäººæ¨¡åž‹",value:ex.bymModel,models:en,onChange:e=>eu({...ex,bymModel:e}),placeholder:"ä½¿ç”¨å…¨å±€"})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{children:"ä¼ªäººæç¤ºè¯"}),(0,a.jsx)(h.Textarea,{value:ex.bymPrompt,onChange:e=>eu({...ex,bymPrompt:e.target.value}),placeholder:"è‡ªå®šä¹‰ä¼ªäººäººè®¾ï¼ˆç•™ç©ºä½¿ç”¨é¢„è®¾æˆ–å…¨å±€ï¼‰",rows:2})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-3",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(d.Label,{className:"text-xs",children:"å›žå¤æ¦‚çŽ‡"}),(0,a.jsx)(r.Button,{variant:"ghost",size:"sm",className:"h-4 text-[10px] px-1",onClick:()=>eu({...ex,bymProbability:"inherit"===ex.bymProbability?.02:"inherit"}),children:"inherit"===ex.bymProbability?"ç»§æ‰¿":"è‡ªå®šä¹‰"})]}),"inherit"!==ex.bymProbability&&(0,a.jsx)(D,{label:"",value:ex.bymProbability,onChange:e=>eu({...ex,bymProbability:e}),className:"pt-1"}),"inherit"===ex.bymProbability&&(0,a.jsx)("div",{className:"text-xs text-muted-foreground h-8 flex items-center",children:"ä½¿ç”¨å…¨å±€è®¾ç½®"})]}),(0,a.jsx)(Q,{label:"æ¸©åº¦",min:0,max:2,step:.1,value:"inherit"===ex.bymTemperature?"":ex.bymTemperature,onChange:e=>eu({...ex,bymTemperature:""===e.target.value?"inherit":Number(e.target.value)}),placeholder:"ç»§æ‰¿"}),(0,a.jsx)(Q,{label:"æœ€å¤§Token",min:0,value:"inherit"===ex.bymMaxTokens?"":ex.bymMaxTokens,onChange:e=>eu({...ex,bymMaxTokens:""===e.target.value?"inherit":Number(e.target.value)}),placeholder:"ç»§æ‰¿"}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(d.Label,{className:"text-xs",children:"å›žå¤é•¿åº¦"}),(0,a.jsxs)(x.Select,{value:ex.bymReplyLength,onValueChange:e=>eu({...ex,bymReplyLength:e}),children:[(0,a.jsx)(x.SelectTrigger,{children:(0,a.jsx)(x.SelectValue,{})}),(0,a.jsxs)(x.SelectContent,{children:[(0,a.jsx)(x.SelectItem,{value:"short",children:"ç®€çŸ­"}),(0,a.jsx)(x.SelectItem,{value:"medium",children:"é€‚ä¸­"}),(0,a.jsx)(x.SelectItem,{value:"long",children:"è¯¦ç»†"})]})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(d.Label,{className:"text-sm",children:"ä½¿ç”¨è¡¨æƒ…"}),(0,a.jsx)(m.Switch,{checked:ex.bymUseEmoji,onCheckedChange:e=>eu({...ex,bymUseEmoji:e})})]})]}),(0,a.jsx)(H,{icon:(0,a.jsx)(S.Clock,{className:"h-4 w-4 text-blue-500"}),title:"ä¸»åŠ¨å‘è¨€",desc:"æ ¹æ®ç¾¤èŠå†…å®¹ä¸»åŠ¨å‚ä¸Žè®¨è®º",value:ex.proactiveChatEnabled,onChange:e=>eu({...ex,proactiveChatEnabled:e})}),"off"!==ex.proactiveChatEnabled&&(0,a.jsxs)("div",{className:"space-y-3 ml-4 pl-4 border-l-2 border-muted",children:[(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(d.Label,{className:"text-xs",children:"è§¦å‘æ¦‚çŽ‡"}),(0,a.jsx)(r.Button,{variant:"ghost",size:"sm",className:"h-6 text-xs px-2",onClick:()=>eu({...ex,proactiveChatProbability:"inherit"===ex.proactiveChatProbability?.05:"inherit"}),children:"inherit"===ex.proactiveChatProbability?"ç»§æ‰¿":"è‡ªå®šä¹‰"})]}),"inherit"!==ex.proactiveChatProbability&&(0,a.jsx)(D,{label:"",value:ex.proactiveChatProbability,onChange:e=>eu({...ex,proactiveChatProbability:e}),className:"pt-1"})]}),(0,a.jsx)(Q,{label:"å†·å´æ—¶é—´(ç§’)",min:0,value:"inherit"===ex.proactiveChatCooldown?"":ex.proactiveChatCooldown,onChange:e=>eu({...ex,proactiveChatCooldown:""===e.target.value?"inherit":Number(e.target.value)}),placeholder:"ç»§æ‰¿"}),(0,a.jsx)(Q,{label:"æ¯æ—¥ä¸Šé™",min:0,value:"inherit"===ex.proactiveChatMaxDaily?"":ex.proactiveChatMaxDaily,onChange:e=>eu({...ex,proactiveChatMaxDaily:""===e.target.value?"inherit":Number(e.target.value)}),placeholder:"ç»§æ‰¿"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-3 pt-2 border-t",children:[(0,a.jsx)(Q,{label:"æœ€å°‘æ¶ˆæ¯æ•°",min:1,value:ex.proactiveChatMinMessages,onChange:e=>eu({...ex,proactiveChatMinMessages:parseInt(e.target.value)||5})}),(0,a.jsx)(Q,{label:"å¼€å§‹æ—¶é—´",min:0,max:23,value:ex.proactiveChatTimeStart,onChange:e=>eu({...ex,proactiveChatTimeStart:parseInt(e.target.value)||8})}),(0,a.jsx)(Q,{label:"ç»“æŸæ—¶é—´",min:0,max:23,value:ex.proactiveChatTimeEnd,onChange:e=>eu({...ex,proactiveChatTimeEnd:parseInt(e.target.value)||23})})]})]})]})]})}),(0,a.jsx)(b.TabsContent,{value:"game",className:"space-y-4",children:(0,a.jsxs)(n.Card,{children:[(0,a.jsxs)(n.CardHeader,{children:[(0,a.jsxs)(n.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(B.Gamepad2,{className:"h-4 w-4 text-green-500"}),"æ¸¸æˆæ¨¡å¼"]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Galgameç­‰äº’åŠ¨æ¸¸æˆçš„ç¾¤ç»„ç‹¬ç«‹é…ç½®"})]}),(0,a.jsxs)(n.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)(D,{label:"è§¦å‘æ¦‚çŽ‡",value:ex.gameProbability,onChange:e=>eu({...ex,gameProbability:e})}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(d.Label,{className:"text-xs",children:"æ¸¸æˆæ¨¡åž‹"}),(0,a.jsxs)(x.Select,{value:ex.gameModel||"__inherit__",onValueChange:e=>eu({...ex,gameModel:"__inherit__"===e?"":e}),children:[(0,a.jsx)(x.SelectTrigger,{children:(0,a.jsx)(x.SelectValue,{placeholder:"ç»§æ‰¿å…¨å±€"})}),(0,a.jsxs)(x.SelectContent,{children:[(0,a.jsx)(x.SelectItem,{value:"__inherit__",children:"ç»§æ‰¿å…¨å±€"}),en.map(e=>(0,a.jsx)(x.SelectItem,{value:e,children:e},e))]})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)(Q,{label:"æ¸©åº¦",min:0,max:2,step:.1,value:"inherit"===ex.gameTemperature?"":ex.gameTemperature,onChange:e=>eu({...ex,gameTemperature:e.target.value?parseFloat(e.target.value):"inherit"}),placeholder:"ç»§æ‰¿"}),(0,a.jsx)(Q,{label:"æœ€å¤§Token",min:100,max:8e3,value:"inherit"===ex.gameMaxTokens?"":ex.gameMaxTokens,onChange:e=>eu({...ex,gameMaxTokens:e.target.value?parseInt(e.target.value):"inherit"}),placeholder:"ç»§æ‰¿"})]}),(0,a.jsx)(H,{icon:(0,a.jsx)(v.Zap,{className:"h-4 w-4 text-yellow-500"}),title:"å¯ç”¨å·¥å…·",desc:"å…è®¸æ¸¸æˆæ¨¡å¼ä½¿ç”¨MCPå·¥å…·",value:ex.gameEnableTools,onChange:e=>eu({...ex,gameEnableTools:e})})]})]})}),(0,a.jsxs)(b.TabsContent,{value:"channel",className:"space-y-4",children:[(0,a.jsxs)(n.Card,{children:[(0,a.jsx)(n.CardHeader,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(n.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(_.Server,{className:"h-4 w-4"}),"ç¾¤ç‹¬ç«‹æ¸ é“"]}),(0,a.jsxs)(r.Button,{size:"sm",onClick:()=>{em(null),eb({name:`æ¸ é“${ex.independentChannels.length+1}`,baseUrl:"",apiKey:"",adapterType:"openai",models:"",enabled:!0,priority:ex.independentChannels.length,modelsPath:"",chatPath:"",imageTransferMode:"auto",imageCompress:!0,imageQuality:85,imageMaxSize:4096}),ed(!0)},children:[(0,a.jsx)(R.Plus,{className:"h-4 w-4 mr-1"}),"æ·»åŠ æ¸ é“"]})]})}),(0,a.jsxs)(n.CardContent,{className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"ä¸ºæœ¬ç¾¤é…ç½®ç‹¬ç«‹çš„APIæ¸ é“ï¼Œæ”¯æŒå¤šä¸ªæ¸ é“å’ŒèŽ·å–æ¨¡åž‹åˆ—è¡¨"}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border bg-muted/20",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 rounded-md bg-orange-500/10",children:(0,a.jsx)(_.Server,{className:"h-4 w-4 text-orange-500"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:"å¼ºåˆ¶ä½¿ç”¨æœ¬ç¾¤æ¸ é“"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"å¼€å¯åŽæœ¬ç¾¤å°†å®Œå…¨éš”ç¦»å…¨å±€æ¨¡åž‹ï¼Œä»…ä½¿ç”¨ä¸‹æ–¹ç‹¬ç«‹é…ç½®"})]})]}),(0,a.jsx)(m.Switch,{checked:ex.forbidGlobalModel,onCheckedChange:e=>eu({...ex,forbidGlobalModel:e})})]}),0===ex.independentChannels.length?(0,a.jsxs)("div",{className:"text-center py-8 text-muted-foreground border rounded-lg border-dashed",children:[(0,a.jsx)(_.Server,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),(0,a.jsx)("p",{children:"æš‚æ— ç‹¬ç«‹æ¸ é“"}),(0,a.jsx)("p",{className:"text-xs",children:"ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æ·»åŠ æ¸ é“"})]}):(0,a.jsx)("div",{className:"space-y-3",children:ex.independentChannels.map((e,i)=>(0,a.jsx)("div",{className:"p-4 rounded-lg border bg-card",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h4",{className:"font-medium",children:e.name}),(0,a.jsx)(c.Badge,{variant:e.enabled?"default":"secondary",children:e.enabled?"å¯ç”¨":"ç¦ç”¨"}),(0,a.jsx)(c.Badge,{variant:"outline",children:e.adapterType})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1 truncate",children:e.baseUrl||"ä½¿ç”¨é»˜è®¤åœ°å€"}),e.models.length>0&&(0,a.jsxs)("div",{className:"flex flex-wrap gap-1 mt-2",children:[e.models.slice(0,3).map(e=>(0,a.jsx)(c.Badge,{variant:"outline",className:"text-xs",children:e},e)),e.models.length>3&&(0,a.jsxs)(c.Badge,{variant:"outline",className:"text-xs",children:["+",e.models.length-3]})]})]}),(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)(r.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>{em(i),eb({name:e.name,baseUrl:e.baseUrl,apiKey:e.apiKey,adapterType:e.adapterType,models:e.models.join(", "),enabled:e.enabled,priority:e.priority,modelsPath:e.modelsPath||"",chatPath:e.chatPath||"",imageTransferMode:e.imageConfig?.transferMode||"auto",imageCompress:e.imageConfig?.compress??!0,imageQuality:e.imageConfig?.quality??85,imageMaxSize:e.imageConfig?.maxSize??4096}),ed(!0)},children:(0,a.jsx)(j.Settings,{className:"h-4 w-4"})}),(0,a.jsx)(r.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive",onClick:()=>{eu({...ex,independentChannels:ex.independentChannels.filter((e,a)=>a!==i)})},children:(0,a.jsx)(K.Trash2,{className:"h-4 w-4"})})]})]})},e.id))})]})]}),(0,a.jsx)($.ChannelDialog,{open:eo,onOpenChange:ed,channelForm:eh,onChannelFormChange:eb,isEditing:null!==ec,onSave:()=>{if(!eh.name)return void u.toast.error("è¯·å¡«å†™æ¸ é“åç§°");let e={id:null!==ec?ex.independentChannels[ec].id:`ch_${Date.now()}`,name:eh.name,baseUrl:eh.baseUrl,apiKey:eh.apiKey,adapterType:eh.adapterType,models:eh.models.split(",").map(e=>e.trim()).filter(Boolean),enabled:eh.enabled,priority:eh.priority,modelsPath:eh.modelsPath||void 0,chatPath:eh.chatPath||void 0,imageConfig:{transferMode:eh.imageTransferMode,compress:eh.imageCompress,quality:eh.imageQuality,maxSize:eh.imageMaxSize}};if(null!==ec){let a=[...ex.independentChannels];a[ec]=e,eu({...ex,independentChannels:a})}else eu({...ex,independentChannels:[...ex.independentChannels,e]});ed(!1),u.toast.success(null!==ec?"æ¸ é“å·²æ›´æ–°":"æ¸ é“å·²æ·»åŠ ")},onFetchModels:async()=>{if(!eh.apiKey)return void u.toast.error("è¯·å…ˆå¡«å†™ API Key");try{let e=await A.channelsApi.fetchModels({adapterType:eh.adapterType,baseUrl:eh.baseUrl||"",apiKey:eh.apiKey}),a=e?.data?.models||e?.models||[];if(!Array.isArray(a)||!(a.length>0))return u.toast.error("æœªèŽ·å–åˆ°æ¨¡åž‹åˆ—è¡¨"),[];{let e=a.map(e=>"string"==typeof e?e:e?.id||e?.name).filter(Boolean);return u.toast.success(`èŽ·å–åˆ° ${e.length} ä¸ªæ¨¡åž‹`),e}}catch(e){return u.toast.error(e.response?.data?.message||"èŽ·å–æ¨¡åž‹å¤±è´¥"),[]}}}),(0,a.jsxs)(n.Card,{children:[(0,a.jsx)(n.CardHeader,{children:(0,a.jsxs)(n.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(G.Gauge,{className:"h-4 w-4"}),"ä½¿ç”¨é™åˆ¶"]})}),(0,a.jsxs)(n.CardContent,{className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"è®¾ç½®æœ¬ç¾¤æ¯æ—¥ä½¿ç”¨æ¬¡æ•°é™åˆ¶ï¼ˆ0è¡¨ç¤ºæ— é™åˆ¶ï¼‰"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{children:"ç¾¤æ¯æ—¥é™åˆ¶"}),(0,a.jsx)(o.Input,{type:"number",min:0,value:ex.dailyGroupLimit,onChange:e=>eu({...ex,dailyGroupLimit:parseInt(e.target.value)||0}),placeholder:"0 = æ— é™åˆ¶"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{children:"ç”¨æˆ·æ¯æ—¥é™åˆ¶"}),(0,a.jsx)(o.Input,{type:"number",min:0,value:ex.dailyUserLimit,onChange:e=>eu({...ex,dailyUserLimit:parseInt(e.target.value)||0}),placeholder:"0 = æ— é™åˆ¶"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.Label,{children:"è¾¾åˆ°é™åˆ¶æ—¶çš„æç¤º"}),(0,a.jsx)(h.Textarea,{value:ex.usageLimitMessage,onChange:e=>eu({...ex,usageLimitMessage:e.target.value}),placeholder:"ä»Šæ—¥ä½¿ç”¨æ¬¡æ•°å·²è¾¾ä¸Šé™ï¼Œè¯·æ˜Žå¤©å†è¯•",rows:2})]})]})]})]}),(0,a.jsxs)(b.TabsContent,{value:"advanced",className:"space-y-4",children:[(0,a.jsxs)(n.Card,{children:[(0,a.jsx)(n.CardHeader,{children:(0,a.jsxs)(n.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(w.Bot,{className:"h-4 w-4"}),"æ¨¡åž‹é…ç½®"]})}),(0,a.jsxs)(n.CardContent,{className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"ä¸ºæœ¬ç¾¤é…ç½®å„åœºæ™¯ç‹¬ç«‹æ¨¡åž‹ï¼ˆç•™ç©ºä½¿ç”¨å…¨å±€é…ç½®ï¼‰"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsx)(O,{label:"å¯¹è¯æ¨¡åž‹",value:ex.chatModel,models:en,onChange:e=>eu({...ex,chatModel:e})}),(0,a.jsx)(O,{label:"æ€»ç»“æ¨¡åž‹",value:ex.summaryModel,models:en,onChange:e=>eu({...ex,summaryModel:e})}),(0,a.jsx)(O,{label:"ä¼ªäººæ¨¡åž‹",value:ex.bymModel,models:en,onChange:e=>eu({...ex,bymModel:e})}),(0,a.jsx)(O,{label:"ç»˜å›¾æ¨¡åž‹",value:ex.imageGenModel,models:en,onChange:e=>eu({...ex,imageGenModel:e})})]})]})]}),(0,a.jsxs)(n.Card,{children:[(0,a.jsx)(n.CardHeader,{children:(0,a.jsxs)(n.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(f.BookOpen,{className:"h-4 w-4"}),"ç¾¤ç»„çŸ¥è¯†åº“"]})}),(0,a.jsxs)(n.CardContent,{className:"space-y-3",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"ä¸ºæœ¬ç¾¤é…ç½®ä¸“å±žçŸ¥è¯†åº“"}),ex.knowledgeIds.length>0&&(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:ex.knowledgeIds.map(e=>{let i=es.find(a=>a.id===e);return(0,a.jsxs)(c.Badge,{variant:"secondary",className:"gap-1",children:[i?.name||e,(0,a.jsx)("button",{onClick:()=>eu({...ex,knowledgeIds:ex.knowledgeIds.filter(a=>a!==e)}),children:(0,a.jsx)(P.X,{className:"h-3 w-3"})})]},e)})}),(0,a.jsxs)(x.Select,{value:"__placeholder__",onValueChange:e=>e&&"__placeholder__"!==e&&!ex.knowledgeIds.includes(e)&&eu({...ex,knowledgeIds:[...ex.knowledgeIds,e]}),children:[(0,a.jsx)(x.SelectTrigger,{children:(0,a.jsx)(x.SelectValue,{placeholder:"æ·»åŠ çŸ¥è¯†åº“..."})}),(0,a.jsx)(x.SelectContent,{children:es.filter(e=>!ex.knowledgeIds.includes(e.id)).map(e=>(0,a.jsx)(x.SelectItem,{value:e.id,children:e.name},e.id))})]})]})]})]})]})]})]})}e.s(["GroupEditor",()=>q],5945)}]);