(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,19468,e=>{"use strict";var l=e.i(69287),s=e.i(71317),a=e.i(39079),t=e.i(64022),r=e.i(39124),d=e.i(92407),i=e.i(51377),n=e.i(69895),c=e.i(9102),o=e.i(10751),m=e.i(23830),x=e.i(86463),h=e.i(47970),u=e.i(32960),j=e.i(49462),p=e.i(98509),g=e.i(79342),b=e.i(60713),f=e.i(35771),v=e.i(89908),N=e.i(32308),y=e.i(97058),S=e.i(40204),_=e.i(68466),w=e.i(70620),M=e.i(63959),I=e.i(50974);let T=(0,I.default)("git-branch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);var C=e.i(74940),k=e.i(80830),E=e.i(98858),P=e.i(19460),V=e.i(15204),L=e.i(17286),F=e.i(10273);let B=(0,I.default)("party-popper",[["path",{d:"M5.8 11.3 2 22l10.7-3.79",key:"gwxi1d"}],["path",{d:"M4 3h.01",key:"1vcuye"}],["path",{d:"M22 8h.01",key:"1mrtc2"}],["path",{d:"M15 2h.01",key:"1cjtqr"}],["path",{d:"M22 20h.01",key:"1mrys2"}],["path",{d:"m22 2-2.24.75a2.9 2.9 0 0 0-1.96 3.12c.1.86-.57 1.63-1.45 1.63h-.38c-.86 0-1.6.6-1.76 1.44L14 10",key:"hbicv8"}],["path",{d:"m22 13-.82-.33c-.86-.34-1.82.2-1.98 1.11c-.11.7-.72 1.22-1.43 1.22H17",key:"1i94pl"}],["path",{d:"m11 2 .33.82c.34.86-.2 1.82-1.11 1.98C9.52 4.9 9 5.52 9 6.23V7",key:"1cofks"}],["path",{d:"M11 13c1.93 1.93 2.83 4.17 2 5-.83.83-3.07-.07-5-2-1.93-1.93-2.83-4.17-2-5 .83-.83 3.07.07 5 2Z",key:"4kbmks"}]]);var G=e.i(14775),z=e.i(96173),D=e.i(64516),R=e.i(56058),A=e.i(39048);let O={default:"默认",at:"仅@触发",prefix:"仅前缀",all:"全部消息"};function X(){let[e,I]=(0,s.useState)([]),[X,$]=(0,s.useState)([]),[q,H]=(0,s.useState)([]),[,U]=(0,s.useState)([]),[Z,K]=(0,s.useState)(!0),[W,J]=(0,s.useState)(!1),[Q,Y]=(0,s.useState)(null),[ee,el]=(0,s.useState)(!1),[es,ea]=(0,s.useState)(""),[et,er]=(0,s.useState)(!1),[ed,ei]=(0,s.useState)(null),[en,ec]=(0,s.useState)(!1),[eo,em]=(0,s.useState)(!1),[ex,eh]=(0,s.useState)([]),[eu,ej]=(0,s.useState)("all"),[ep,eg]=(0,s.useState)(!1),[eb,ef]=(0,s.useState)("basic"),[ev,eN]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e=()=>eg(window.innerWidth<768);return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let[ey,eS]=(0,s.useState)({groupId:"",groupName:"",presetId:"__default__",systemPrompt:"",modelId:"__default__",chatModel:"",toolModel:"",dispatchModel:"",imageModel:"",drawModel:"",searchModel:"",roleplayModel:"",profileModel:"",enabled:!0,triggerMode:"default",bymEnabled:"inherit",bymPresetId:"__default__",bymPrompt:"",bymProbability:"inherit",bymModel:"",bymTemperature:"inherit",bymMaxTokens:"inherit",emojiThiefEnabled:"inherit",emojiThiefSeparateFolder:!0,emojiThiefMaxCount:500,emojiThiefStealRate:1,emojiThiefTriggerMode:"random",emojiThiefTriggerRate:.05,toolsEnabled:"inherit",imageGenEnabled:"inherit",imageGenModel:"",summaryEnabled:"inherit",summaryModel:"",eventEnabled:"inherit",customPrefix:"",knowledgeIds:[],inheritFrom:[]}),e_=async()=>{try{let[e,l,s,a]=await Promise.all([p.scopeApi.getGroups(),p.presetsApi.list(),p.channelsApi.list(),p.knowledgeApi.list()]);I(e?.data||[]),$(l?.data||[]),H((a?.data||[]).map(e=>({id:e.id,name:e.name}))),U(s?.data||[]);let t=new Set;(s?.data||[]).forEach(e=>{Array.isArray(e.models)&&e.models.forEach(e=>t.add(e))}),eh(Array.from(t).sort())}catch(e){g.toast.error("加载数据失败"),console.error(e)}finally{K(!1)}};(0,s.useEffect)(()=>{e_()},[]);let ew=()=>{eS({groupId:"",groupName:"",presetId:"__default__",systemPrompt:"",modelId:"__default__",chatModel:"",toolModel:"",dispatchModel:"",imageModel:"",drawModel:"",searchModel:"",roleplayModel:"",profileModel:"",enabled:!0,triggerMode:"default",bymEnabled:"inherit",bymPresetId:"__default__",bymPrompt:"",bymProbability:"inherit",bymModel:"",bymTemperature:"inherit",bymMaxTokens:"inherit",emojiThiefEnabled:"inherit",emojiThiefSeparateFolder:!0,emojiThiefMaxCount:500,emojiThiefStealRate:1,emojiThiefTriggerMode:"random",emojiThiefTriggerRate:.05,toolsEnabled:"inherit",imageGenEnabled:"inherit",imageGenModel:"",summaryEnabled:"inherit",summaryModel:"",eventEnabled:"inherit",customPrefix:"",knowledgeIds:[],inheritFrom:[]}),Y(null)},eM=e=>{if(e){Y(e);let l=e.settings||{},s=l.chatModel||l.modelId||e.modelId||"";eS({groupId:e.groupId,groupName:l.groupName||e.groupName||"",presetId:e.presetId||l.presetId||"__default__",systemPrompt:e.systemPrompt||l.systemPrompt||"",modelId:"__default__",chatModel:s,toolModel:l.toolModel||"",dispatchModel:l.dispatchModel||"",imageModel:l.imageModel||"",drawModel:l.drawModel||"",searchModel:l.searchModel||"",roleplayModel:l.roleplayModel||"",profileModel:l.profileModel||"",enabled:e.enabled??l.enabled??!0,triggerMode:l.triggerMode||e.triggerMode||"default",bymEnabled:void 0===l.bymEnabled?"inherit":l.bymEnabled?"on":"off",bymPresetId:l.bymPresetId||"__default__",bymPrompt:l.bymPrompt||"",bymProbability:void 0===l.bymProbability?"inherit":l.bymProbability,bymModel:l.bymModel||"",bymTemperature:void 0===l.bymTemperature?"inherit":l.bymTemperature,bymMaxTokens:void 0===l.bymMaxTokens?"inherit":l.bymMaxTokens,emojiThiefEnabled:void 0===l.emojiThiefEnabled?"inherit":l.emojiThiefEnabled?"on":"off",emojiThiefSeparateFolder:l.emojiThiefSeparateFolder??!0,emojiThiefMaxCount:l.emojiThiefMaxCount??500,emojiThiefStealRate:l.emojiThiefStealRate??1,emojiThiefTriggerMode:l.emojiThiefTriggerMode||"random",emojiThiefTriggerRate:l.emojiThiefTriggerRate??.05,toolsEnabled:void 0===l.toolsEnabled?"inherit":l.toolsEnabled?"on":"off",imageGenEnabled:void 0===l.imageGenEnabled?"inherit":l.imageGenEnabled?"on":"off",imageGenModel:l.imageGenModel||"",summaryEnabled:void 0===l.summaryEnabled?"inherit":l.summaryEnabled?"on":"off",summaryModel:l.summaryModel||"",eventEnabled:void 0===l.eventEnabled?"inherit":l.eventEnabled?"on":"off",customPrefix:l.customPrefix||"",knowledgeIds:e.knowledgeIds||[],inheritFrom:e.inheritFrom||[]})}else ew();J(!0)},eI=async()=>{if(!ey.groupId)return void g.toast.error("请填写群号");el(!0);try{await p.scopeApi.updateGroup(ey.groupId,{groupName:ey.groupName,presetId:"__default__"===ey.presetId?"":ey.presetId,systemPrompt:ey.systemPrompt||null,chatModel:ey.chatModel||void 0,toolModel:ey.toolModel||void 0,dispatchModel:ey.dispatchModel||void 0,imageModel:ey.imageModel||void 0,drawModel:ey.drawModel||void 0,searchModel:ey.searchModel||void 0,roleplayModel:ey.roleplayModel||void 0,profileModel:ey.profileModel||void 0,enabled:ey.enabled,triggerMode:ey.triggerMode,bymEnabled:"inherit"===ey.bymEnabled?void 0:"on"===ey.bymEnabled,bymPresetId:"__default__"===ey.bymPresetId?void 0:ey.bymPresetId,bymPrompt:ey.bymPrompt||void 0,bymProbability:"inherit"===ey.bymProbability?void 0:ey.bymProbability,bymModel:ey.bymModel||void 0,bymTemperature:"inherit"===ey.bymTemperature?void 0:ey.bymTemperature,bymMaxTokens:"inherit"===ey.bymMaxTokens?void 0:ey.bymMaxTokens,emojiThiefEnabled:"inherit"===ey.emojiThiefEnabled?void 0:"on"===ey.emojiThiefEnabled,emojiThiefSeparateFolder:ey.emojiThiefSeparateFolder,emojiThiefMaxCount:ey.emojiThiefMaxCount,emojiThiefStealRate:ey.emojiThiefStealRate,emojiThiefTriggerMode:ey.emojiThiefTriggerMode,emojiThiefTriggerRate:ey.emojiThiefTriggerRate,toolsEnabled:"inherit"===ey.toolsEnabled?void 0:"on"===ey.toolsEnabled,imageGenEnabled:"inherit"===ey.imageGenEnabled?void 0:"on"===ey.imageGenEnabled,imageGenModel:ey.imageGenModel||void 0,summaryEnabled:"inherit"===ey.summaryEnabled?void 0:"on"===ey.summaryEnabled,summaryModel:ey.summaryModel||void 0,eventEnabled:"inherit"===ey.eventEnabled?void 0:"on"===ey.eventEnabled,customPrefix:ey.customPrefix||void 0,knowledgeIds:ey.knowledgeIds.length>0?ey.knowledgeIds:void 0,inheritFrom:ey.inheritFrom.length>0?ey.inheritFrom:void 0}),g.toast.success("群配置已保存"),J(!1),ew(),e_()}catch(e){g.toast.error("保存失败"),console.error(e)}finally{el(!1)}},eT=async()=>{if(ed){ec(!0);try{await p.scopeApi.deleteGroup(ed.groupId),g.toast.success("群配置已删除"),er(!1),ei(null),e_()}catch(e){g.toast.error("删除失败"),console.error(e)}finally{ec(!1)}}},eC=async e=>{let l=!(e.enabled??e.settings?.enabled??!0);eN(e.groupId);try{await p.scopeApi.updateGroup(e.groupId,{enabled:l}),g.toast.success(l?"已启用群组":"已禁用群组"),e_()}catch(e){g.toast.error("切换失败"),console.error(e)}finally{eN(null)}},ek=(0,s.useMemo)(()=>e.filter(e=>{let l=e.groupId.includes(es)||e.groupName?.toLowerCase().includes(es.toLowerCase()),s=e.enabled??e.settings?.enabled??!0,a="all"===eu||"enabled"===eu&&s||"disabled"===eu&&!s;return l&&a}),[e,es,eu]),eE=(0,s.useMemo)(()=>({total:e.length,enabled:e.filter(e=>e.enabled??e.settings?.enabled??!0).length,disabled:e.filter(e=>!(e.enabled??e.settings?.enabled??!0)).length}),[e]);if(Z)return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(n.Skeleton,{className:"h-8 w-32"}),(0,l.jsx)(n.Skeleton,{className:"h-10 w-24"})]}),(0,l.jsx)("div",{className:"space-y-3",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,l.jsx)(a.Card,{children:(0,l.jsx)(a.CardContent,{className:"p-4",children:(0,l.jsx)(n.Skeleton,{className:"h-16 w-full"})})},s))})]});let eP=()=>(0,l.jsxs)(j.Tabs,{value:eb,onValueChange:ef,className:"w-full",children:[(0,l.jsxs)(j.TabsList,{className:"grid w-full grid-cols-4 mb-4",children:[(0,l.jsxs)(j.TabsTrigger,{value:"basic",className:"text-xs sm:text-sm",children:[(0,l.jsx)(S.Settings,{className:"h-3.5 w-3.5 mr-1 hidden sm:inline"}),"基础"]}),(0,l.jsxs)(j.TabsTrigger,{value:"features",className:"text-xs sm:text-sm",children:[(0,l.jsx)(z.Zap,{className:"h-3.5 w-3.5 mr-1 hidden sm:inline"}),"功能"]}),(0,l.jsxs)(j.TabsTrigger,{value:"bym",className:"text-xs sm:text-sm",children:[(0,l.jsx)(V.Sparkles,{className:"h-3.5 w-3.5 mr-1 hidden sm:inline"}),"伪人"]}),(0,l.jsxs)(j.TabsTrigger,{value:"advanced",className:"text-xs sm:text-sm",children:[(0,l.jsx)(M.BookOpen,{className:"h-3.5 w-3.5 mr-1 hidden sm:inline"}),"高级"]})]}),(0,l.jsxs)(j.TabsContent,{value:"basic",className:"space-y-4 mt-0",children:[(0,l.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(d.Label,{htmlFor:"groupId",children:"群号 *"}),(0,l.jsx)(r.Input,{id:"groupId",value:ey.groupId,onChange:e=>eS({...ey,groupId:e.target.value}),placeholder:"123456789",disabled:!!Q})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(d.Label,{htmlFor:"groupName",children:"群名称"}),(0,l.jsx)(r.Input,{id:"groupName",value:ey.groupName,onChange:e=>eS({...ey,groupName:e.target.value}),placeholder:"可选，便于识别"})]})]}),(0,l.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(d.Label,{children:"使用预设"}),(0,l.jsxs)(x.Select,{value:ey.presetId,onValueChange:e=>eS({...ey,presetId:e}),children:[(0,l.jsx)(x.SelectTrigger,{children:(0,l.jsx)(x.SelectValue,{placeholder:"使用默认预设"})}),(0,l.jsxs)(x.SelectContent,{children:[(0,l.jsx)(x.SelectItem,{value:"__default__",children:"使用默认预设"}),X.map(e=>(0,l.jsx)(x.SelectItem,{value:e.id,children:e.name},e.id))]})]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(d.Label,{children:"触发模式"}),(0,l.jsxs)(x.Select,{value:ey.triggerMode,onValueChange:e=>eS({...ey,triggerMode:e}),children:[(0,l.jsx)(x.SelectTrigger,{children:(0,l.jsx)(x.SelectValue,{})}),(0,l.jsxs)(x.SelectContent,{children:[(0,l.jsx)(x.SelectItem,{value:"default",children:"默认"}),(0,l.jsx)(x.SelectItem,{value:"at",children:"仅@触发"}),(0,l.jsx)(x.SelectItem,{value:"prefix",children:"仅前缀触发"}),(0,l.jsx)(x.SelectItem,{value:"all",children:"全部消息"})]})]})]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(d.Label,{children:"自定义前缀"}),(0,l.jsx)(r.Input,{value:ey.customPrefix,onChange:e=>eS({...ey,customPrefix:e.target.value}),placeholder:"留空使用全局前缀，如 #ai"})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(d.Label,{children:"独立人设"}),(0,l.jsx)(u.Textarea,{value:ey.systemPrompt,onChange:e=>eS({...ey,systemPrompt:e.target.value}),placeholder:"不填写则使用预设配置...",rows:3,className:"font-mono text-sm resize-none"})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/50",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(E.Power,{className:"h-4 w-4 text-muted-foreground"}),(0,l.jsx)(d.Label,{className:"font-normal",children:"启用AI响应"})]}),(0,l.jsx)(c.Switch,{checked:ey.enabled,onCheckedChange:e=>eS({...ey,enabled:e})})]})]}),(0,l.jsxs)(j.TabsContent,{value:"features",className:"space-y-3 mt-0",children:[(0,l.jsx)("p",{className:"text-xs text-muted-foreground mb-2",children:"群管理员也可通过命令控制这些功能"}),(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border bg-card",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"p-2 rounded-md bg-muted",children:(0,l.jsx)(z.Zap,{className:"h-4 w-4 text-muted-foreground"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium",children:"工具调用"}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"允许AI使用搜索、代码执行等工具"})]})]}),(0,l.jsxs)(x.Select,{value:ey.toolsEnabled,onValueChange:e=>eS({...ey,toolsEnabled:e}),children:[(0,l.jsx)(x.SelectTrigger,{className:"w-28",children:(0,l.jsx)(x.SelectValue,{})}),(0,l.jsxs)(x.SelectContent,{children:[(0,l.jsx)(x.SelectItem,{value:"inherit",children:"继承"}),(0,l.jsx)(x.SelectItem,{value:"on",children:"开启"}),(0,l.jsx)(x.SelectItem,{value:"off",children:"关闭"})]})]})]}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border bg-card",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"p-2 rounded-md bg-muted",children:(0,l.jsx)(L.Image,{className:"h-4 w-4 text-muted-foreground"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium",children:"绘图功能"}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"文生图、图生图等"})]})]}),(0,l.jsxs)(x.Select,{value:ey.imageGenEnabled,onValueChange:e=>eS({...ey,imageGenEnabled:e}),children:[(0,l.jsx)(x.SelectTrigger,{className:"w-28",children:(0,l.jsx)(x.SelectValue,{})}),(0,l.jsxs)(x.SelectContent,{children:[(0,l.jsx)(x.SelectItem,{value:"inherit",children:"继承"}),(0,l.jsx)(x.SelectItem,{value:"on",children:"开启"}),(0,l.jsx)(x.SelectItem,{value:"off",children:"关闭"})]})]})]}),"on"===ey.imageGenEnabled&&(0,l.jsxs)("div",{className:"ml-4 pl-4 border-l-2 border-muted space-y-2 animate-fade-in",children:[(0,l.jsx)(d.Label,{className:"text-xs",children:"绘图模型"}),(0,l.jsxs)(x.Select,{value:ey.imageGenModel||"__default__",onValueChange:e=>eS({...ey,imageGenModel:"__default__"===e?"":e}),children:[(0,l.jsx)(x.SelectTrigger,{children:(0,l.jsx)(x.SelectValue,{placeholder:"继承全局"})}),(0,l.jsxs)(x.SelectContent,{children:[(0,l.jsx)(x.SelectItem,{value:"__default__",children:"继承全局"}),ex.filter(e=>e.includes("image")||e.includes("gemini")||e.includes("dalle")||e.includes("flux")).map(e=>(0,l.jsx)(x.SelectItem,{value:e,children:e},e))]})]})]})]}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border bg-card",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"p-2 rounded-md bg-muted",children:(0,l.jsx)(F.MessageSquare,{className:"h-4 w-4 text-muted-foreground"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium",children:"群聊总结"}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"允许使用群聊总结"})]})]}),(0,l.jsxs)(x.Select,{value:ey.summaryEnabled,onValueChange:e=>eS({...ey,summaryEnabled:e}),children:[(0,l.jsx)(x.SelectTrigger,{className:"w-28",children:(0,l.jsx)(x.SelectValue,{})}),(0,l.jsxs)(x.SelectContent,{children:[(0,l.jsx)(x.SelectItem,{value:"inherit",children:"继承"}),(0,l.jsx)(x.SelectItem,{value:"on",children:"开启"}),(0,l.jsx)(x.SelectItem,{value:"off",children:"关闭"})]})]})]}),"on"===ey.summaryEnabled&&(0,l.jsxs)("div",{className:"ml-4 pl-4 border-l-2 border-muted space-y-2 animate-fade-in",children:[(0,l.jsx)(d.Label,{className:"text-xs",children:"总结模型"}),(0,l.jsxs)(x.Select,{value:ey.summaryModel||"__default__",onValueChange:e=>eS({...ey,summaryModel:"__default__"===e?"":e}),children:[(0,l.jsx)(x.SelectTrigger,{children:(0,l.jsx)(x.SelectValue,{placeholder:"继承全局"})}),(0,l.jsxs)(x.SelectContent,{children:[(0,l.jsx)(x.SelectItem,{value:"__default__",children:"继承全局"}),ex.map(e=>(0,l.jsx)(x.SelectItem,{value:e,children:e},e))]})]})]})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border bg-card",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"p-2 rounded-md bg-muted",children:(0,l.jsx)(B,{className:"h-4 w-4 text-muted-foreground"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium",children:"事件处理"}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"入群欢迎、退群提醒"})]})]}),(0,l.jsxs)(x.Select,{value:ey.eventEnabled,onValueChange:e=>eS({...ey,eventEnabled:e}),children:[(0,l.jsx)(x.SelectTrigger,{className:"w-28",children:(0,l.jsx)(x.SelectValue,{})}),(0,l.jsxs)(x.SelectContent,{children:[(0,l.jsx)(x.SelectItem,{value:"inherit",children:"继承"}),(0,l.jsx)(x.SelectItem,{value:"on",children:"开启"}),(0,l.jsx)(x.SelectItem,{value:"off",children:"关闭"})]})]})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border bg-card",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"p-2 rounded-md bg-muted",children:(0,l.jsx)(G.Palette,{className:"h-4 w-4 text-muted-foreground"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium",children:"表情小偷"}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"收集并发送表情包"})]})]}),(0,l.jsxs)(x.Select,{value:ey.emojiThiefEnabled,onValueChange:e=>eS({...ey,emojiThiefEnabled:e}),children:[(0,l.jsx)(x.SelectTrigger,{className:"w-28",children:(0,l.jsx)(x.SelectValue,{})}),(0,l.jsxs)(x.SelectContent,{children:[(0,l.jsx)(x.SelectItem,{value:"inherit",children:"继承"}),(0,l.jsx)(x.SelectItem,{value:"on",children:"开启"}),(0,l.jsx)(x.SelectItem,{value:"off",children:"关闭"})]})]})]}),"off"!==ey.emojiThiefEnabled&&(0,l.jsxs)("div",{className:"ml-4 pl-4 border-l-2 border-muted space-y-3 animate-fade-in",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(d.Label,{className:"text-sm",children:"独立存储"}),(0,l.jsx)(c.Switch,{checked:ey.emojiThiefSeparateFolder,onCheckedChange:e=>eS({...ey,emojiThiefSeparateFolder:e})})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)(d.Label,{className:"text-xs",children:"最大数量"}),(0,l.jsx)(r.Input,{type:"number",min:10,max:5e3,value:ey.emojiThiefMaxCount,onChange:e=>eS({...ey,emojiThiefMaxCount:parseInt(e.target.value)||500})})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)(d.Label,{className:"text-xs",children:"偷取概率"}),(0,l.jsx)(r.Input,{type:"number",min:1,max:100,value:Math.round(100*ey.emojiThiefStealRate),onChange:e=>eS({...ey,emojiThiefStealRate:parseInt(e.target.value)/100})})]})]})]})]}),(0,l.jsxs)(j.TabsContent,{value:"bym",className:"space-y-4 mt-0",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border bg-card",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"p-2 rounded-md bg-gradient-to-br from-purple-500/20 to-pink-500/20",children:(0,l.jsx)(V.Sparkles,{className:"h-4 w-4 text-purple-500"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium",children:"伪人模式"}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"随机回复，模拟真人聊天"})]})]}),(0,l.jsxs)(x.Select,{value:ey.bymEnabled,onValueChange:e=>eS({...ey,bymEnabled:e}),children:[(0,l.jsx)(x.SelectTrigger,{className:"w-28",children:(0,l.jsx)(x.SelectValue,{})}),(0,l.jsxs)(x.SelectContent,{children:[(0,l.jsx)(x.SelectItem,{value:"inherit",children:"继承"}),(0,l.jsx)(x.SelectItem,{value:"on",children:"开启"}),(0,l.jsx)(x.SelectItem,{value:"off",children:"关闭"})]})]})]}),"off"!==ey.bymEnabled&&(0,l.jsxs)("div",{className:"space-y-4 animate-fade-in",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(d.Label,{children:"伪人人设"}),(0,l.jsxs)(x.Select,{value:ey.bymPresetId,onValueChange:e=>eS({...ey,bymPresetId:e}),children:[(0,l.jsx)(x.SelectTrigger,{children:(0,l.jsx)(x.SelectValue,{placeholder:"选择人设..."})}),(0,l.jsxs)(x.SelectContent,{children:[(0,l.jsx)(x.SelectItem,{value:"__default__",children:"使用默认预设"}),(0,l.jsx)(x.SelectItem,{value:"__custom__",children:"自定义提示词"}),X.map(e=>(0,l.jsx)(x.SelectItem,{value:e.id,children:e.name},e.id))]})]})]}),"__custom__"===ey.bymPresetId&&(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(d.Label,{children:"自定义提示词"}),(0,l.jsx)(u.Textarea,{value:ey.bymPrompt,onChange:e=>eS({...ey,bymPrompt:e.target.value}),placeholder:"你是一个真实的群友...",rows:3,className:"font-mono text-sm"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(d.Label,{className:"text-sm",children:"触发概率"}),(0,l.jsx)("div",{className:"flex items-center gap-2",children:"inherit"===ey.bymProbability?(0,l.jsx)(t.Button,{variant:"outline",size:"sm",className:"w-full",onClick:()=>eS({...ey,bymProbability:.02}),children:"继承全局"}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.Input,{type:"number",min:0,max:100,value:"number"==typeof ey.bymProbability?Math.round(100*ey.bymProbability):2,onChange:e=>eS({...ey,bymProbability:parseInt(e.target.value)/100}),className:"w-20"}),(0,l.jsx)("span",{className:"text-sm",children:"%"}),(0,l.jsx)(t.Button,{variant:"ghost",size:"sm",onClick:()=>eS({...ey,bymProbability:"inherit"}),children:(0,l.jsx)(C.X,{className:"h-3 w-3"})})]})})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(d.Label,{className:"text-sm",children:"使用模型"}),(0,l.jsxs)(x.Select,{value:ey.bymModel||"__default__",onValueChange:e=>eS({...ey,bymModel:"__default__"===e?"":e}),children:[(0,l.jsx)(x.SelectTrigger,{children:(0,l.jsx)(x.SelectValue,{placeholder:"继承"})}),(0,l.jsxs)(x.SelectContent,{children:[(0,l.jsx)(x.SelectItem,{value:"__default__",children:"继承全局"}),ex.map(e=>(0,l.jsx)(x.SelectItem,{value:e,children:e},e))]})]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(d.Label,{className:"text-sm",children:"温度"}),"inherit"===ey.bymTemperature?(0,l.jsx)(t.Button,{variant:"outline",size:"sm",className:"w-full",onClick:()=>eS({...ey,bymTemperature:.9}),children:"继承全局"}):(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(r.Input,{type:"number",min:0,max:2,step:.1,value:"number"==typeof ey.bymTemperature?ey.bymTemperature:.9,onChange:e=>eS({...ey,bymTemperature:parseFloat(e.target.value)})}),(0,l.jsx)(t.Button,{variant:"ghost",size:"sm",onClick:()=>eS({...ey,bymTemperature:"inherit"}),children:(0,l.jsx)(C.X,{className:"h-3 w-3"})})]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(d.Label,{className:"text-sm",children:"最大Token"}),"inherit"===ey.bymMaxTokens?(0,l.jsx)(t.Button,{variant:"outline",size:"sm",className:"w-full",onClick:()=>eS({...ey,bymMaxTokens:100}),children:"继承全局"}):(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(r.Input,{type:"number",min:10,max:2e3,value:"number"==typeof ey.bymMaxTokens?ey.bymMaxTokens:100,onChange:e=>eS({...ey,bymMaxTokens:parseInt(e.target.value)})}),(0,l.jsx)(t.Button,{variant:"ghost",size:"sm",onClick:()=>eS({...ey,bymMaxTokens:"inherit"}),children:(0,l.jsx)(C.X,{className:"h-3 w-3"})})]})]})]})]})]}),(0,l.jsxs)(j.TabsContent,{value:"advanced",className:"space-y-4 mt-0",children:[(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(w.Bot,{className:"h-4 w-4 text-muted-foreground"}),(0,l.jsx)(d.Label,{children:"模型配置"})]}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"为本群配置各场景独立模型（留空使用全局配置）"}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"space-y-1.5",children:[(0,l.jsxs)(d.Label,{className:"text-xs",children:["对话模型 ",(0,l.jsx)("span",{className:"text-muted-foreground",children:"（主模型）"})]}),(0,l.jsxs)(x.Select,{value:ey.chatModel||"__default__",onValueChange:e=>eS({...ey,chatModel:"__default__"===e?"":e}),children:[(0,l.jsx)(x.SelectTrigger,{children:(0,l.jsx)(x.SelectValue,{placeholder:"使用全局配置"})}),(0,l.jsxs)(x.SelectContent,{className:"max-h-[200px] overflow-y-auto",children:[(0,l.jsx)(x.SelectItem,{value:"__default__",children:"使用全局配置"}),ex.map(e=>(0,l.jsx)(x.SelectItem,{value:e,children:e},e))]})]})]}),(0,l.jsxs)("div",{className:"space-y-1.5",children:[(0,l.jsxs)(d.Label,{className:"text-xs",children:["工具模型 ",(0,l.jsx)("span",{className:"text-muted-foreground",children:"（需要调用工具时）"})]}),(0,l.jsxs)(x.Select,{value:ey.toolModel||"__default__",onValueChange:e=>eS({...ey,toolModel:"__default__"===e?"":e}),children:[(0,l.jsx)(x.SelectTrigger,{children:(0,l.jsx)(x.SelectValue,{placeholder:"使用全局配置"})}),(0,l.jsxs)(x.SelectContent,{className:"max-h-[200px] overflow-y-auto",children:[(0,l.jsx)(x.SelectItem,{value:"__default__",children:"使用全局配置"}),ex.map(e=>(0,l.jsx)(x.SelectItem,{value:e,children:e},e))]})]})]}),(0,l.jsxs)("div",{className:"space-y-1.5",children:[(0,l.jsxs)(d.Label,{className:"text-xs",children:["调度模型 ",(0,l.jsx)("span",{className:"text-muted-foreground",children:"（工具组分类）"})]}),(0,l.jsxs)(x.Select,{value:ey.dispatchModel||"__default__",onValueChange:e=>eS({...ey,dispatchModel:"__default__"===e?"":e}),children:[(0,l.jsx)(x.SelectTrigger,{children:(0,l.jsx)(x.SelectValue,{placeholder:"使用全局配置"})}),(0,l.jsxs)(x.SelectContent,{className:"max-h-[200px] overflow-y-auto",children:[(0,l.jsx)(x.SelectItem,{value:"__default__",children:"使用全局配置"}),ex.map(e=>(0,l.jsx)(x.SelectItem,{value:e,children:e},e))]})]})]}),(0,l.jsxs)("div",{className:"space-y-1.5",children:[(0,l.jsxs)(d.Label,{className:"text-xs",children:["图像理解模型 ",(0,l.jsx)("span",{className:"text-muted-foreground",children:"（分析图片）"})]}),(0,l.jsxs)(x.Select,{value:ey.imageModel||"__default__",onValueChange:e=>eS({...ey,imageModel:"__default__"===e?"":e}),children:[(0,l.jsx)(x.SelectTrigger,{children:(0,l.jsx)(x.SelectValue,{placeholder:"使用全局配置"})}),(0,l.jsxs)(x.SelectContent,{className:"max-h-[200px] overflow-y-auto",children:[(0,l.jsx)(x.SelectItem,{value:"__default__",children:"使用全局配置"}),ex.map(e=>(0,l.jsx)(x.SelectItem,{value:e,children:e},e))]})]})]}),(0,l.jsxs)("div",{className:"space-y-1.5",children:[(0,l.jsxs)(d.Label,{className:"text-xs",children:["绘图模型 ",(0,l.jsx)("span",{className:"text-muted-foreground",children:"（生成图片）"})]}),(0,l.jsxs)(x.Select,{value:ey.drawModel||"__default__",onValueChange:e=>eS({...ey,drawModel:"__default__"===e?"":e}),children:[(0,l.jsx)(x.SelectTrigger,{children:(0,l.jsx)(x.SelectValue,{placeholder:"使用全局配置"})}),(0,l.jsxs)(x.SelectContent,{className:"max-h-[200px] overflow-y-auto",children:[(0,l.jsx)(x.SelectItem,{value:"__default__",children:"使用全局配置"}),ex.map(e=>(0,l.jsx)(x.SelectItem,{value:e,children:e},e))]})]})]}),(0,l.jsxs)("div",{className:"space-y-1.5",children:[(0,l.jsxs)(d.Label,{className:"text-xs",children:["搜索模型 ",(0,l.jsx)("span",{className:"text-muted-foreground",children:"（联网搜索）"})]}),(0,l.jsxs)(x.Select,{value:ey.searchModel||"__default__",onValueChange:e=>eS({...ey,searchModel:"__default__"===e?"":e}),children:[(0,l.jsx)(x.SelectTrigger,{children:(0,l.jsx)(x.SelectValue,{placeholder:"使用全局配置"})}),(0,l.jsxs)(x.SelectContent,{className:"max-h-[200px] overflow-y-auto",children:[(0,l.jsx)(x.SelectItem,{value:"__default__",children:"使用全局配置"}),ex.map(e=>(0,l.jsx)(x.SelectItem,{value:e,children:e},e))]})]})]}),(0,l.jsxs)("div",{className:"space-y-1.5",children:[(0,l.jsxs)(d.Label,{className:"text-xs",children:["伪人模型 ",(0,l.jsx)("span",{className:"text-muted-foreground",children:"（模拟真人）"})]}),(0,l.jsxs)(x.Select,{value:ey.roleplayModel||"__default__",onValueChange:e=>eS({...ey,roleplayModel:"__default__"===e?"":e}),children:[(0,l.jsx)(x.SelectTrigger,{children:(0,l.jsx)(x.SelectValue,{placeholder:"使用全局配置"})}),(0,l.jsxs)(x.SelectContent,{className:"max-h-[200px] overflow-y-auto",children:[(0,l.jsx)(x.SelectItem,{value:"__default__",children:"使用全局配置"}),ex.map(e=>(0,l.jsx)(x.SelectItem,{value:e,children:e},e))]})]})]}),(0,l.jsxs)("div",{className:"space-y-1.5",children:[(0,l.jsxs)(d.Label,{className:"text-xs",children:["总结模型 ",(0,l.jsx)("span",{className:"text-muted-foreground",children:"（群聊总结）"})]}),(0,l.jsxs)(x.Select,{value:ey.summaryModel||"__default__",onValueChange:e=>eS({...ey,summaryModel:"__default__"===e?"":e}),children:[(0,l.jsx)(x.SelectTrigger,{children:(0,l.jsx)(x.SelectValue,{placeholder:"使用全局配置"})}),(0,l.jsxs)(x.SelectContent,{className:"max-h-[200px] overflow-y-auto",children:[(0,l.jsx)(x.SelectItem,{value:"__default__",children:"使用全局配置"}),ex.map(e=>(0,l.jsx)(x.SelectItem,{value:e,children:e},e))]})]})]}),(0,l.jsxs)("div",{className:"space-y-1.5",children:[(0,l.jsxs)(d.Label,{className:"text-xs",children:["画像模型 ",(0,l.jsx)("span",{className:"text-muted-foreground",children:"（用户画像分析）"})]}),(0,l.jsxs)(x.Select,{value:ey.profileModel||"__default__",onValueChange:e=>eS({...ey,profileModel:"__default__"===e?"":e}),children:[(0,l.jsx)(x.SelectTrigger,{children:(0,l.jsx)(x.SelectValue,{placeholder:"使用全局配置"})}),(0,l.jsxs)(x.SelectContent,{className:"max-h-[200px] overflow-y-auto",children:[(0,l.jsx)(x.SelectItem,{value:"__default__",children:"使用全局配置"}),ex.map(e=>(0,l.jsx)(x.SelectItem,{value:e,children:e},e))]})]})]})]})]}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(M.BookOpen,{className:"h-4 w-4 text-muted-foreground"}),(0,l.jsx)(d.Label,{children:"群组知识库"})]}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"为本群配置专属知识库"}),ey.knowledgeIds.length>0&&(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:ey.knowledgeIds.map(e=>{let s=q.find(l=>l.id===e);return(0,l.jsxs)(i.Badge,{variant:"secondary",className:"gap-1",children:[s?.name||e,(0,l.jsx)("button",{onClick:()=>eS({...ey,knowledgeIds:ey.knowledgeIds.filter(l=>l!==e)}),children:(0,l.jsx)(C.X,{className:"h-3 w-3"})})]},e)})}),(0,l.jsxs)(x.Select,{value:"",onValueChange:e=>e&&!ey.knowledgeIds.includes(e)&&eS({...ey,knowledgeIds:[...ey.knowledgeIds,e]}),children:[(0,l.jsx)(x.SelectTrigger,{children:(0,l.jsx)(x.SelectValue,{placeholder:"添加知识库..."})}),(0,l.jsx)(x.SelectContent,{children:q.filter(e=>!ey.knowledgeIds.includes(e.id)).map(e=>(0,l.jsx)(x.SelectItem,{value:e.id,children:e.name},e.id))})]})]}),(0,l.jsxs)("div",{className:"space-y-3 pt-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(T,{className:"h-4 w-4 text-muted-foreground"}),(0,l.jsx)(d.Label,{children:"继承配置"})]}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:"从其他来源继承提示词和知识库"}),ey.inheritFrom.length>0&&(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:ey.inheritFrom.map(s=>{let[a,t]=s.split(":"),r=s;return"preset"===a?r=`预设: ${X.find(e=>e.id===t)?.name||t}`:"group"===a&&(r=`群: ${e.find(e=>e.groupId===t)?.groupName||t}`),(0,l.jsxs)(i.Badge,{variant:"outline",className:"gap-1",children:[r,(0,l.jsx)("button",{onClick:()=>eS({...ey,inheritFrom:ey.inheritFrom.filter(e=>e!==s)}),children:(0,l.jsx)(C.X,{className:"h-3 w-3"})})]},s)})}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,l.jsxs)(x.Select,{value:"",onValueChange:e=>e&&!ey.inheritFrom.includes(e)&&eS({...ey,inheritFrom:[...ey.inheritFrom,e]}),children:[(0,l.jsx)(x.SelectTrigger,{children:(0,l.jsx)(x.SelectValue,{placeholder:"预设..."})}),(0,l.jsx)(x.SelectContent,{children:X.filter(e=>!ey.inheritFrom.includes(`preset:${e.id}`)).map(e=>(0,l.jsx)(x.SelectItem,{value:`preset:${e.id}`,children:e.name},e.id))})]}),(0,l.jsxs)(x.Select,{value:"",onValueChange:e=>e&&!ey.inheritFrom.includes(e)&&eS({...ey,inheritFrom:[...ey.inheritFrom,e]}),children:[(0,l.jsx)(x.SelectTrigger,{children:(0,l.jsx)(x.SelectValue,{placeholder:"群组..."})}),(0,l.jsx)(x.SelectContent,{children:e.filter(e=>e.groupId!==ey.groupId&&!ey.inheritFrom.includes(`group:${e.groupId}`)).map(e=>(0,l.jsx)(x.SelectItem,{value:`group:${e.groupId}`,children:e.groupName||e.groupId},e.groupId))})]})]})]})]})]});return(0,l.jsxs)("div",{className:"space-y-4 sm:space-y-6",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-xl sm:text-2xl font-bold",children:"群组管理"}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground mt-0.5",children:"配置群聊个性化设置和独立人设"})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)(t.Button,{variant:"outline",size:"sm",onClick:e_,className:"gap-1.5",children:[(0,l.jsx)(y.RefreshCw,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"hidden sm:inline",children:"刷新"})]}),(0,l.jsxs)(t.Button,{size:"sm",onClick:()=>{ew(),ef("basic"),J(!0)},className:"gap-1.5",children:[(0,l.jsx)(b.Plus,{className:"h-4 w-4"}),(0,l.jsx)("span",{children:"添加群"})]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-2 sm:gap-4",children:[(0,l.jsxs)("button",{onClick:()=>ej("all"),className:(0,A.cn)("p-3 sm:p-4 rounded-xl border transition-all text-left","all"===eu?"border-primary bg-primary/5 shadow-sm":"hover:border-muted-foreground/30"),children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,l.jsx)(N.Users,{className:"h-4 w-4 text-muted-foreground"}),(0,l.jsx)("span",{className:"text-xs text-muted-foreground",children:"全部"})]}),(0,l.jsx)("p",{className:"text-lg sm:text-2xl font-bold",children:eE.total})]}),(0,l.jsxs)("button",{onClick:()=>ej("enabled"),className:(0,A.cn)("p-3 sm:p-4 rounded-xl border transition-all text-left","enabled"===eu?"border-emerald-500 bg-emerald-500/5 shadow-sm":"hover:border-muted-foreground/30"),children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,l.jsx)(E.Power,{className:"h-4 w-4 text-emerald-500"}),(0,l.jsx)("span",{className:"text-xs text-muted-foreground",children:"已启用"})]}),(0,l.jsx)("p",{className:"text-lg sm:text-2xl font-bold text-emerald-600",children:eE.enabled})]}),(0,l.jsxs)("button",{onClick:()=>ej("disabled"),className:(0,A.cn)("p-3 sm:p-4 rounded-xl border transition-all text-left","disabled"===eu?"border-zinc-500 bg-zinc-500/5 shadow-sm":"hover:border-muted-foreground/30"),children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,l.jsx)(P.PowerOff,{className:"h-4 w-4 text-zinc-400"}),(0,l.jsx)("span",{className:"text-xs text-muted-foreground",children:"已禁用"})]}),(0,l.jsx)("p",{className:"text-lg sm:text-2xl font-bold text-zinc-500",children:eE.disabled})]})]})]}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(k.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,l.jsx)(r.Input,{placeholder:"搜索群号或群名称...",value:es,onChange:e=>ea(e.target.value),className:"pl-9 h-10"}),es&&(0,l.jsx)(t.Button,{variant:"ghost",size:"sm",className:"absolute right-1 top-1/2 -translate-y-1/2 h-7 w-7 p-0",onClick:()=>ea(""),children:(0,l.jsx)(C.X,{className:"h-4 w-4"})})]}),0===ek.length?(0,l.jsx)(a.Card,{className:"border-dashed",children:(0,l.jsxs)(a.CardContent,{className:"flex flex-col items-center justify-center py-12",children:[(0,l.jsx)("div",{className:"p-4 rounded-full bg-muted mb-4",children:(0,l.jsx)(N.Users,{className:"h-8 w-8 text-muted-foreground"})}),(0,l.jsx)("p",{className:"text-lg font-medium mb-1",children:es||"all"!==eu?"未找到匹配的群":"暂无群配置"}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:es?"尝试其他搜索词":"添加群组来配置个性化设置"}),!es&&"all"===eu&&(0,l.jsxs)(t.Button,{onClick:()=>{ew(),ef("basic"),J(!0)},children:[(0,l.jsx)(b.Plus,{className:"mr-2 h-4 w-4"}),"添加第一个群"]})]})}):(0,l.jsx)("div",{className:"space-y-2 sm:space-y-3",children:ek.map(e=>{let s=e.enabled??e.settings?.enabled??!0,r=e.settings?.modelId||e.modelId,d=e.settings||{};return(0,l.jsx)(a.Card,{className:(0,A.cn)("group transition-all hover:shadow-md",!s&&"opacity-60"),children:(0,l.jsx)(a.CardContent,{className:"p-3 sm:p-4",children:(0,l.jsxs)("div",{className:"flex items-start gap-3",children:[(0,l.jsx)("button",{onClick:()=>eC(e),disabled:ev===e.groupId,className:(0,A.cn)("mt-1 flex-shrink-0 w-10 h-10 rounded-xl flex items-center justify-center transition-all",s?"bg-emerald-500/10 text-emerald-600 hover:bg-emerald-500/20":"bg-zinc-500/10 text-zinc-500 hover:bg-zinc-500/20"),children:ev===e.groupId?(0,l.jsx)(v.Loader2,{className:"h-5 w-5 animate-spin"}):s?(0,l.jsx)(E.Power,{className:"h-5 w-5"}):(0,l.jsx)(P.PowerOff,{className:"h-5 w-5"})}),(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,l.jsx)("span",{className:"font-semibold text-base",children:e.groupName||e.groupId}),e.groupName&&(0,l.jsxs)("span",{className:"text-xs text-muted-foreground font-mono",children:["#",e.groupId]}),(0,l.jsx)(i.Badge,{variant:s?"default":"secondary",className:"text-xs",children:s?"已启用":"已禁用"})]}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-1.5 mt-2",children:[e.systemPrompt&&(0,l.jsxs)(i.Badge,{variant:"outline",className:"text-xs gap-1 font-normal",children:[(0,l.jsx)(_.FileText,{className:"h-3 w-3"}),"独立人设"]}),!e.systemPrompt&&(0,l.jsxs)(i.Badge,{variant:"outline",className:"text-xs gap-1 font-normal",children:[(0,l.jsx)(G.Palette,{className:"h-3 w-3"}),X.find(l=>l.id===e.presetId)?.name||"默认预设"]}),r&&(0,l.jsxs)(i.Badge,{variant:"outline",className:"text-xs gap-1 font-normal max-w-[140px] truncate",children:[(0,l.jsx)(w.Bot,{className:"h-3 w-3 flex-shrink-0"}),r]}),(0,l.jsxs)(i.Badge,{variant:"outline",className:"text-xs gap-1 font-normal",children:[(0,l.jsx)(z.Zap,{className:"h-3 w-3"}),O[e.triggerMode||"default"]||"默认"]}),d.bymEnabled&&(0,l.jsxs)(i.Badge,{variant:"outline",className:"text-xs gap-1 font-normal bg-purple-500/10 border-purple-500/30",children:[(0,l.jsx)(V.Sparkles,{className:"h-3 w-3 text-purple-500"}),"伪人"]}),e.knowledgeIds&&e.knowledgeIds.length>0&&(0,l.jsxs)(i.Badge,{variant:"outline",className:"text-xs gap-1 font-normal",children:[(0,l.jsx)(M.BookOpen,{className:"h-3 w-3"}),e.knowledgeIds.length]})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-1 flex-shrink-0",children:[(0,l.jsx)(t.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>eM(e),children:(0,l.jsx)(S.Settings,{className:"h-4 w-4"})}),(0,l.jsxs)(R.DropdownMenu,{children:[(0,l.jsx)(R.DropdownMenuTrigger,{asChild:!0,children:(0,l.jsx)(t.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,l.jsx)(D.MoreHorizontal,{className:"h-4 w-4"})})}),(0,l.jsxs)(R.DropdownMenuContent,{align:"end",children:[(0,l.jsxs)(R.DropdownMenuItem,{onClick:()=>eM(e),children:[(0,l.jsx)(S.Settings,{className:"h-4 w-4 mr-2"}),"编辑配置"]}),(0,l.jsxs)(R.DropdownMenuItem,{onClick:()=>eC(e),children:[s?(0,l.jsx)(P.PowerOff,{className:"h-4 w-4 mr-2"}):(0,l.jsx)(E.Power,{className:"h-4 w-4 mr-2"}),s?"禁用群组":"启用群组"]}),(0,l.jsx)(R.DropdownMenuSeparator,{}),(0,l.jsxs)(R.DropdownMenuItem,{className:"text-destructive",onClick:()=>{ei(e),er(!0)},children:[(0,l.jsx)(f.Trash2,{className:"h-4 w-4 mr-2"}),"删除配置"]})]})]})]})]})})},e.groupId)})}),ep?(0,l.jsx)(m.Sheet,{open:W,onOpenChange:J,children:(0,l.jsxs)(m.SheetContent,{side:"bottom",className:"h-[85vh] rounded-t-2xl",children:[(0,l.jsxs)(m.SheetHeader,{className:"pb-4",children:[(0,l.jsx)(m.SheetTitle,{children:Q?"编辑群配置":"添加群"}),(0,l.jsx)(m.SheetDescription,{children:"配置群聊个性化设置"})]}),(0,l.jsx)(h.ScrollArea,{className:"h-[calc(85vh-180px)] pr-4",children:eP()}),(0,l.jsxs)(m.SheetFooter,{className:"pt-4 flex-row gap-2",children:[(0,l.jsx)(t.Button,{variant:"outline",className:"flex-1",onClick:()=>J(!1),children:"取消"}),(0,l.jsxs)(t.Button,{className:"flex-1",onClick:eI,disabled:ee,children:[ee&&(0,l.jsx)(v.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"保存"]})]})]})}):(0,l.jsx)(o.Dialog,{open:W,onOpenChange:J,children:(0,l.jsxs)(o.DialogContent,{className:"max-w-2xl max-h-[85vh]",children:[(0,l.jsxs)(o.DialogHeader,{children:[(0,l.jsx)(o.DialogTitle,{children:Q?"编辑群配置":"添加群"}),(0,l.jsx)(o.DialogDescription,{children:"配置群聊个性化设置和独立人设"})]}),(0,l.jsx)(h.ScrollArea,{className:"max-h-[60vh] pr-4",children:eP()}),(0,l.jsxs)(o.DialogFooter,{children:[(0,l.jsx)(t.Button,{variant:"outline",onClick:()=>J(!1),children:"取消"}),(0,l.jsxs)(t.Button,{onClick:eI,disabled:ee,children:[ee&&(0,l.jsx)(v.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"保存"]})]})]})}),(0,l.jsx)(o.Dialog,{open:et,onOpenChange:er,children:(0,l.jsxs)(o.DialogContent,{className:"max-w-md",children:[(0,l.jsxs)(o.DialogHeader,{children:[(0,l.jsx)(o.DialogTitle,{children:"确认删除"}),(0,l.jsxs)(o.DialogDescription,{children:["确定要删除群 ",(0,l.jsx)("strong",{children:ed?.groupName||ed?.groupId})," 的配置吗？此操作不可撤销。"]})]}),(0,l.jsxs)(o.DialogFooter,{className:"gap-2 sm:gap-0",children:[(0,l.jsx)(t.Button,{variant:"outline",onClick:()=>er(!1),children:"取消"}),(0,l.jsxs)(t.Button,{variant:"destructive",onClick:eT,disabled:en,children:[en&&(0,l.jsx)(v.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"删除"]})]})]})})]})}e.s(["default",()=>X],19468)}]);