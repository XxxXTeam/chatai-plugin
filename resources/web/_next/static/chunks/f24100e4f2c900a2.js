(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,87126,e=>{"use strict";var a=e.i(33169),s=e.i(17171);function t({className:e,...t}){return(0,a.jsx)("div",{"data-slot":"skeleton",className:(0,s.cn)("bg-accent animate-pulse rounded-md",e),...t})}e.s(["Skeleton",()=>t])},97058,e=>{"use strict";let a=(0,e.i(50974).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>a],97058)},84141,e=>{"use strict";var a=e.i(94316);e.s(["Check",()=>a.default])},46048,e=>{"use strict";var a=e.i(33169),s=e.i(17171);function t({className:e,...t}){return(0,a.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,a.jsx)("table",{"data-slot":"table",className:(0,s.cn)("w-full caption-bottom text-sm",e),...t})})}function r({className:e,...t}){return(0,a.jsx)("thead",{"data-slot":"table-header",className:(0,s.cn)("[&_tr]:border-b",e),...t})}function l({className:e,...t}){return(0,a.jsx)("tbody",{"data-slot":"table-body",className:(0,s.cn)("[&_tr:last-child]:border-0",e),...t})}function n({className:e,...t}){return(0,a.jsx)("tr",{"data-slot":"table-row",className:(0,s.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...t})}function c({className:e,...t}){return(0,a.jsx)("th",{"data-slot":"table-head",className:(0,s.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function i({className:e,...t}){return(0,a.jsx)("td",{"data-slot":"table-cell",className:(0,s.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}e.s(["Table",()=>t,"TableBody",()=>l,"TableCell",()=>i,"TableHead",()=>c,"TableHeader",()=>r,"TableRow",()=>n])},85876,e=>{"use strict";let a=(0,e.i(50974).default)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);e.s(["Copy",()=>a],85876)},86868,e=>{"use strict";let a=(0,e.i(50974).default)("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);e.s(["Key",()=>a],86868)},3489,e=>{"use strict";var a=e.i(33169),s=e.i(60844),t=e.i(51200),r=e.i(30243),l=e.i(72029),n=e.i(87126),c=e.i(16195),i=e.i(46048),o=e.i(75979),d=e.i(79342),x=e.i(60713),h=e.i(89908),m=e.i(35771),u=e.i(85876),j=e.i(23359),p=e.i(48352),k=e.i(86868),b=e.i(97058),f=e.i(84141),y=e.i(71355),N=e.i(50974);let w=(0,N.default)("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),g=(0,N.default)("shield-off",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71",key:"1jlk70"}],["path",{d:"M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264",key:"18rp1v"}]]);function v(){let[e,N]=(0,s.useState)([]),[v,C]=(0,s.useState)(!0),[T,L]=(0,s.useState)(!1),[U,S]=(0,s.useState)(""),[A,B]=(0,s.useState)(""),[H,R]=(0,s.useState)(null),[I,M]=(0,s.useState)(!1),[F,D]=(0,s.useState)(!1),[P,z]=(0,s.useState)(null),[K,$]=(0,s.useState)(""),[E,O]=(0,s.useState)(!1),_=async()=>{try{C(!0);let e=await o.configApi.get();e?.data?.web?.loginLinks&&N(e.data.web.loginLinks),e?.data?.web?.permanentAuthToken&&R(e.data.web.permanentAuthToken),e?.data?.web?.publicUrl&&$(e.data.web.publicUrl)}catch(e){console.error("Failed to fetch config:",e),d.toast.error("获取配置失败")}finally{C(!1)}};(0,s.useEffect)(()=>{_()},[]);let q=async()=>{if(!U.trim()||!A.trim())return void d.toast.error("请填写名称和地址");try{new URL(A)}catch{d.toast.error("请输入有效的URL地址");return}L(!0);try{let a={id:"u">typeof crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let a=16*Math.random()|0;return("x"===e?a:3&a|8).toString(16)}),label:U.trim(),baseUrl:A.trim().replace(/\/$/,"")},s=[...e,a];await o.configApi.update({web:{loginLinks:s}}),N(s),S(""),B(""),d.toast.success("添加成功")}catch(e){console.error("Failed to add link:",e),d.toast.error("添加失败")}finally{L(!1)}},V=async a=>{try{let s=e.filter(e=>e.id!==a);await o.configApi.update({web:{loginLinks:s}}),N(s),d.toast.success("删除成功")}catch(e){console.error("Failed to delete link:",e),d.toast.error("删除失败")}},G=async(e,a)=>{try{await navigator.clipboard.writeText(e),z(a),d.toast.success("已复制到剪贴板"),setTimeout(()=>z(null),2e3)}catch{d.toast.error("复制失败")}},J=async(e=!1)=>{D(!0);try{let a=await o.tokenApi.generatePermanent(e);a?.data?.token?(R(a.data.token),d.toast.success(e?"已重新生成永久Token":"永久Token已生成")):(await _(),d.toast.success("永久Token已生成"))}catch(e){console.error("Failed to generate token:",e),d.toast.error("生成Token失败")}finally{D(!1)}},Q=async()=>{M(!0);try{await o.tokenApi.revokePermanent(),R(null),d.toast.success("永久Token已撤销")}catch(e){console.error("Failed to revoke token:",e),d.toast.error("撤销Token失败")}finally{M(!1)}},W=async()=>{O(!0);try{if(K.trim())try{new URL(K.trim())}catch{d.toast.error("请输入有效的URL地址"),O(!1);return}await o.configApi.update({web:{publicUrl:K.trim()?K.trim().replace(/\/$/,""):""}}),d.toast.success("公网地址已保存")}catch(e){console.error("Failed to save public URL:",e),d.toast.error("保存失败")}finally{O(!1)}};return v?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"登录链接"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"管理面板登录链接和永久Token"})]}),(0,a.jsxs)(t.Card,{children:[(0,a.jsxs)(t.CardHeader,{children:[(0,a.jsx)(n.Skeleton,{className:"h-6 w-32"}),(0,a.jsx)(n.Skeleton,{className:"h-4 w-64"})]}),(0,a.jsx)(t.CardContent,{children:(0,a.jsx)("div",{className:"space-y-4",children:[1,2,3].map(e=>(0,a.jsx)(n.Skeleton,{className:"h-12 w-full"},e))})})]})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"登录链接"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"管理面板登录链接和永久Token，用于从不同地址访问面板"})]}),(0,a.jsxs)(t.Card,{children:[(0,a.jsxs)(t.CardHeader,{children:[(0,a.jsxs)(t.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(k.Key,{className:"h-5 w-5"}),"永久Token"]}),(0,a.jsx)(t.CardDescription,{children:"永久Token可用于生成不过期的登录链接，请妥善保管"})]}),(0,a.jsx)(t.CardContent,{className:"space-y-4",children:H?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(w,{className:"h-5 w-5 text-green-500"}),(0,a.jsx)("span",{className:"text-sm text-green-600 dark:text-green-400",children:"永久Token已启用"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(r.Input,{value:H,readOnly:!0,className:"font-mono text-sm"}),(0,a.jsx)(l.Button,{variant:"outline",size:"icon",onClick:()=>G(H,"token"),children:"token"===P?(0,a.jsx)(f.Check,{className:"h-4 w-4 text-green-500"}):(0,a.jsx)(u.Copy,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(l.Button,{variant:"outline",onClick:()=>J(!0),disabled:F,children:[F?(0,a.jsx)(h.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}):(0,a.jsx)(b.RefreshCw,{className:"h-4 w-4 mr-2"}),"重新生成"]}),(0,a.jsxs)(l.Button,{variant:"destructive",onClick:Q,disabled:I,children:[I?(0,a.jsx)(h.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}):(0,a.jsx)(g,{className:"h-4 w-4 mr-2"}),"撤销Token"]})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(g,{className:"h-5 w-5 text-muted-foreground"}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"永久Token未启用"})]}),(0,a.jsxs)(l.Button,{onClick:()=>J(!1),disabled:F,children:[F?(0,a.jsx)(h.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}):(0,a.jsx)(k.Key,{className:"h-4 w-4 mr-2"}),"生成永久Token"]})]})})]}),(0,a.jsxs)(t.Card,{children:[(0,a.jsxs)(t.CardHeader,{children:[(0,a.jsxs)(t.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(p.ExternalLink,{className:"h-5 w-5"}),"公网地址"]}),(0,a.jsx)(t.CardDescription,{children:"手动配置公网访问地址，用于 #ai管理面板 命令显示"})]}),(0,a.jsxs)(t.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(r.Input,{value:K,onChange:e=>$(e.target.value),placeholder:"http://your-public-ip:3000",className:"flex-1"}),(0,a.jsx)(l.Button,{onClick:W,disabled:E,children:E?(0,a.jsx)(h.Loader2,{className:"h-4 w-4 animate-spin"}):"保存"})]}),(0,a.jsxs)(c.Alert,{children:[(0,a.jsx)(y.Info,{className:"h-4 w-4"}),(0,a.jsx)(c.AlertDescription,{children:"如果自动检测公网 IP 不可靠，可以手动配置公网地址。留空则使用自动检测。"})]})]})]}),(0,a.jsxs)(t.Card,{children:[(0,a.jsxs)(t.CardHeader,{children:[(0,a.jsxs)(t.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(j.Link,{className:"h-5 w-5"}),"自定义登录地址"]}),(0,a.jsx)(t.CardDescription,{children:"添加自定义域名或地址，用于生成对应的登录链接"})]}),(0,a.jsxs)(t.CardContent,{className:"space-y-4",children:[!H&&(0,a.jsxs)(c.Alert,{children:[(0,a.jsx)(y.Info,{className:"h-4 w-4"}),(0,a.jsx)(c.AlertDescription,{children:"请先生成永久Token，才能使用自定义登录链接"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(r.Input,{placeholder:"名称，如：公网地址",value:U,onChange:e=>S(e.target.value),className:"w-40"}),(0,a.jsx)(r.Input,{placeholder:"地址，如：https://example.com:3000",value:A,onChange:e=>B(e.target.value),className:"flex-1"}),(0,a.jsx)(l.Button,{onClick:q,disabled:T||!U||!A,children:T?(0,a.jsx)(h.Loader2,{className:"h-4 w-4 animate-spin"}):(0,a.jsx)(x.Plus,{className:"h-4 w-4"})})]}),e.length>0?(0,a.jsxs)(i.Table,{children:[(0,a.jsx)(i.TableHeader,{children:(0,a.jsxs)(i.TableRow,{children:[(0,a.jsx)(i.TableHead,{children:"名称"}),(0,a.jsx)(i.TableHead,{children:"地址"}),(0,a.jsx)(i.TableHead,{children:"登录链接"}),(0,a.jsx)(i.TableHead,{className:"w-24 text-right",children:"操作"})]})}),(0,a.jsx)(i.TableBody,{children:e.map(e=>{var s;let t=(s=e.baseUrl,H?`${s}/login/token?token=${H}`:null);return(0,a.jsxs)(i.TableRow,{children:[(0,a.jsx)(i.TableCell,{className:"font-medium",children:e.label||"(未命名)"}),(0,a.jsx)(i.TableCell,{className:"text-muted-foreground",children:(0,a.jsxs)("a",{href:e.baseUrl,target:"_blank",rel:"noopener noreferrer",className:"hover:text-primary hover:underline flex items-center gap-1",children:[e.baseUrl,(0,a.jsx)(p.ExternalLink,{className:"h-3 w-3"})]})}),(0,a.jsx)(i.TableCell,{children:t?(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("code",{className:"text-xs bg-muted px-2 py-1 rounded max-w-xs truncate block",children:t}),(0,a.jsx)(l.Button,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>G(t,e.id),children:P===e.id?(0,a.jsx)(f.Check,{className:"h-3 w-3 text-green-500"}):(0,a.jsx)(u.Copy,{className:"h-3 w-3"})})]}):(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"需要永久Token"})}),(0,a.jsx)(i.TableCell,{className:"text-right",children:(0,a.jsx)(l.Button,{variant:"ghost",size:"icon",onClick:()=>V(e.id),children:(0,a.jsx)(m.Trash2,{className:"h-4 w-4 text-destructive"})})})]},e.id)})})]}):(0,a.jsxs)("div",{className:"text-center py-6 text-muted-foreground",children:[(0,a.jsx)(j.Link,{className:"h-10 w-10 mx-auto mb-3 opacity-50"}),(0,a.jsx)("p",{children:"暂无自定义登录地址"}),(0,a.jsx)("p",{className:"text-sm mt-1",children:"添加你的域名或公网IP地址"})]})]})]})]})}e.s(["default",()=>v],3489)}]);