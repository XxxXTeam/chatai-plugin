(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,65984,e=>{"use strict";var a=e.i(69287),t=e.i(39048);function s({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,a.jsx)("table",{"data-slot":"table",className:(0,t.cn)("w-full caption-bottom text-sm",e),...s})})}function r({className:e,...s}){return(0,a.jsx)("thead",{"data-slot":"table-header",className:(0,t.cn)("[&_tr]:border-b",e),...s})}function l({className:e,...s}){return(0,a.jsx)("tbody",{"data-slot":"table-body",className:(0,t.cn)("[&_tr:last-child]:border-0",e),...s})}function n({className:e,...s}){return(0,a.jsx)("tr",{"data-slot":"table-row",className:(0,t.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...s})}function i({className:e,...s}){return(0,a.jsx)("th",{"data-slot":"table-head",className:(0,t.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...s})}function c({className:e,...s}){return(0,a.jsx)("td",{"data-slot":"table-cell",className:(0,t.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...s})}e.s(["Table",()=>s,"TableBody",()=>l,"TableCell",()=>c,"TableHead",()=>i,"TableHeader",()=>r,"TableRow",()=>n])},35771,e=>{"use strict";let a=(0,e.i(50974).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>a],35771)},97058,e=>{"use strict";let a=(0,e.i(50974).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>a],97058)},39124,e=>{"use strict";var a=e.i(69287),t=e.i(39048);function s({className:e,type:s,...r}){return(0,a.jsx)("input",{type:s,"data-slot":"input",className:(0,t.cn)("file:text-foreground placeholder:text-muted-foreground/60 selection:bg-primary selection:text-primary-foreground","dark:bg-input/30 border-input h-10 w-full min-w-0 rounded-lg border bg-background/50 px-3 py-2 text-base shadow-xs","transition-all duration-200 outline-none","file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium","disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50","hover:border-ring/50 hover:bg-background","focus-visible:border-primary focus-visible:ring-primary/20 focus-visible:ring-[3px] focus-visible:bg-background","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive","md:text-sm",e),...r})}e.s(["Input",()=>s])},39079,e=>{"use strict";var a=e.i(69287),t=e.i(39048);function s({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"card",className:(0,t.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm transition-all duration-200","hover:shadow-md dark:border-border/50 dark:shadow-none dark:hover:border-border",e),...s})}function r({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,t.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...s})}function l({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,t.cn)("leading-none font-semibold",e),...s})}function n({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"card-description",className:(0,t.cn)("text-muted-foreground text-sm",e),...s})}function i({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,t.cn)("px-6",e),...s})}e.s(["Card",()=>s,"CardContent",()=>i,"CardDescription",()=>n,"CardHeader",()=>r,"CardTitle",()=>l])},89908,e=>{"use strict";var a=e.i(79333);e.s(["Loader2",()=>a.default])},69895,e=>{"use strict";var a=e.i(69287),t=e.i(39048);function s({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"skeleton",className:(0,t.cn)("bg-accent animate-pulse rounded-md",e),...s})}e.s(["Skeleton",()=>s])},60713,e=>{"use strict";let a=(0,e.i(50974).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>a],60713)},85876,e=>{"use strict";let a=(0,e.i(50974).default)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);e.s(["Copy",()=>a],85876)},71355,e=>{"use strict";var a=e.i(48569);e.s(["Info",()=>a.default])},86868,e=>{"use strict";let a=(0,e.i(50974).default)("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);e.s(["Key",()=>a],86868)},23359,e=>{"use strict";let a=(0,e.i(50974).default)("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);e.s(["Link",()=>a],23359)},84141,e=>{"use strict";var a=e.i(94316);e.s(["Check",()=>a.default])},26812,e=>{"use strict";var a=e.i(69287),t=e.i(94237),s=e.i(39048);let r=(0,t.cva)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function l({className:e,variant:t,...l}){return(0,a.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,s.cn)(r({variant:t}),e),...l})}function n({className:e,...t}){return(0,a.jsx)("div",{"data-slot":"alert-description",className:(0,s.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",e),...t})}e.s(["Alert",()=>l,"AlertDescription",()=>n])},35987,e=>{"use strict";var a=e.i(69287),t=e.i(71317),s=e.i(39079),r=e.i(39124),l=e.i(64022),n=e.i(69895),i=e.i(26812),c=e.i(65984),d=e.i(98509),o=e.i(79342),x=e.i(60713),u=e.i(89908),h=e.i(35771),m=e.i(85876),p=e.i(23359),f=e.i(50974);let j=(0,f.default)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);var b=e.i(86868),g=e.i(97058),v=e.i(84141),k=e.i(71355);let y=(0,f.default)("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),w=(0,f.default)("shield-off",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71",key:"1jlk70"}],["path",{d:"M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264",key:"18rp1v"}]]);function N(){let[e,f]=(0,t.useState)([]),[N,C]=(0,t.useState)(!0),[T,L]=(0,t.useState)(!1),[M,U]=(0,t.useState)(""),[A,S]=(0,t.useState)(""),[H,B]=(0,t.useState)(null),[I,R]=(0,t.useState)(!1),[D,F]=(0,t.useState)(!1),[P,_]=(0,t.useState)(null),[q,z]=(0,t.useState)(""),[V,K]=(0,t.useState)(!1),$=async()=>{try{C(!0);let e=await d.configApi.get();e?.data?.web?.loginLinks&&f(e.data.web.loginLinks),e?.data?.web?.permanentAuthToken&&B(e.data.web.permanentAuthToken),e?.data?.web?.publicUrl&&z(e.data.web.publicUrl)}catch(e){console.error("Failed to fetch config:",e),o.toast.error("获取配置失败")}finally{C(!1)}};(0,t.useEffect)(()=>{$()},[]);let O=async()=>{if(!M.trim()||!A.trim())return void o.toast.error("请填写名称和地址");try{new URL(A)}catch{o.toast.error("请输入有效的URL地址");return}L(!0);try{let a={id:"undefined"!=typeof crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let a=16*Math.random()|0;return("x"===e?a:3&a|8).toString(16)}),label:M.trim(),baseUrl:A.trim().replace(/\/$/,"")},t=[...e,a];await d.configApi.update({web:{loginLinks:t}}),f(t),U(""),S(""),o.toast.success("添加成功")}catch(e){console.error("Failed to add link:",e),o.toast.error("添加失败")}finally{L(!1)}},E=async a=>{try{let t=e.filter(e=>e.id!==a);await d.configApi.update({web:{loginLinks:t}}),f(t),o.toast.success("删除成功")}catch(e){console.error("Failed to delete link:",e),o.toast.error("删除失败")}},G=async(e,a)=>{try{await navigator.clipboard.writeText(e),_(a),o.toast.success("已复制到剪贴板"),setTimeout(()=>_(null),2e3)}catch{o.toast.error("复制失败")}},J=async(e=!1)=>{F(!0);try{let a=await d.tokenApi.generatePermanent(e);a?.data?.token?(B(a.data.token),o.toast.success(e?"已重新生成永久Token":"永久Token已生成")):(await $(),o.toast.success("永久Token已生成"))}catch(e){console.error("Failed to generate token:",e),o.toast.error("生成Token失败")}finally{F(!1)}},Q=async()=>{R(!0);try{await d.tokenApi.revokePermanent(),B(null),o.toast.success("永久Token已撤销")}catch(e){console.error("Failed to revoke token:",e),o.toast.error("撤销Token失败")}finally{R(!1)}},W=async()=>{K(!0);try{if(q.trim())try{new URL(q.trim())}catch{o.toast.error("请输入有效的URL地址"),K(!1);return}await d.configApi.update({web:{publicUrl:q.trim()?q.trim().replace(/\/$/,""):""}}),o.toast.success("公网地址已保存")}catch(e){console.error("Failed to save public URL:",e),o.toast.error("保存失败")}finally{K(!1)}};return N?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"登录链接"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"管理面板登录链接和永久Token"})]}),(0,a.jsxs)(s.Card,{children:[(0,a.jsxs)(s.CardHeader,{children:[(0,a.jsx)(n.Skeleton,{className:"h-6 w-32"}),(0,a.jsx)(n.Skeleton,{className:"h-4 w-64"})]}),(0,a.jsx)(s.CardContent,{children:(0,a.jsx)("div",{className:"space-y-4",children:[1,2,3].map(e=>(0,a.jsx)(n.Skeleton,{className:"h-12 w-full"},e))})})]})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"登录链接"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"管理面板登录链接和永久Token，用于从不同地址访问面板"})]}),(0,a.jsxs)(s.Card,{children:[(0,a.jsxs)(s.CardHeader,{children:[(0,a.jsxs)(s.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(b.Key,{className:"h-5 w-5"}),"永久Token"]}),(0,a.jsx)(s.CardDescription,{children:"永久Token可用于生成不过期的登录链接，请妥善保管"})]}),(0,a.jsx)(s.CardContent,{className:"space-y-4",children:H?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(y,{className:"h-5 w-5 text-green-500"}),(0,a.jsx)("span",{className:"text-sm text-green-600 dark:text-green-400",children:"永久Token已启用"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(r.Input,{value:H,readOnly:!0,className:"font-mono text-sm"}),(0,a.jsx)(l.Button,{variant:"outline",size:"icon",onClick:()=>G(H,"token"),children:"token"===P?(0,a.jsx)(v.Check,{className:"h-4 w-4 text-green-500"}):(0,a.jsx)(m.Copy,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(l.Button,{variant:"outline",onClick:()=>J(!0),disabled:D,children:[D?(0,a.jsx)(u.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}):(0,a.jsx)(g.RefreshCw,{className:"h-4 w-4 mr-2"}),"重新生成"]}),(0,a.jsxs)(l.Button,{variant:"destructive",onClick:Q,disabled:I,children:[I?(0,a.jsx)(u.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}):(0,a.jsx)(w,{className:"h-4 w-4 mr-2"}),"撤销Token"]})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(w,{className:"h-5 w-5 text-muted-foreground"}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"永久Token未启用"})]}),(0,a.jsxs)(l.Button,{onClick:()=>J(!1),disabled:D,children:[D?(0,a.jsx)(u.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}):(0,a.jsx)(b.Key,{className:"h-4 w-4 mr-2"}),"生成永久Token"]})]})})]}),(0,a.jsxs)(s.Card,{children:[(0,a.jsxs)(s.CardHeader,{children:[(0,a.jsxs)(s.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(j,{className:"h-5 w-5"}),"公网地址"]}),(0,a.jsx)(s.CardDescription,{children:"手动配置公网访问地址，用于 #ai管理面板 命令显示"})]}),(0,a.jsxs)(s.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(r.Input,{value:q,onChange:e=>z(e.target.value),placeholder:"http://your-public-ip:3000",className:"flex-1"}),(0,a.jsx)(l.Button,{onClick:W,disabled:V,children:V?(0,a.jsx)(u.Loader2,{className:"h-4 w-4 animate-spin"}):"保存"})]}),(0,a.jsxs)(i.Alert,{children:[(0,a.jsx)(k.Info,{className:"h-4 w-4"}),(0,a.jsx)(i.AlertDescription,{children:"如果自动检测公网 IP 不可靠，可以手动配置公网地址。留空则使用自动检测。"})]})]})]}),(0,a.jsxs)(s.Card,{children:[(0,a.jsxs)(s.CardHeader,{children:[(0,a.jsxs)(s.CardTitle,{className:"flex items-center gap-2",children:[(0,a.jsx)(p.Link,{className:"h-5 w-5"}),"自定义登录地址"]}),(0,a.jsx)(s.CardDescription,{children:"添加自定义域名或地址，用于生成对应的登录链接"})]}),(0,a.jsxs)(s.CardContent,{className:"space-y-4",children:[!H&&(0,a.jsxs)(i.Alert,{children:[(0,a.jsx)(k.Info,{className:"h-4 w-4"}),(0,a.jsx)(i.AlertDescription,{children:"请先生成永久Token，才能使用自定义登录链接"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(r.Input,{placeholder:"名称，如：公网地址",value:M,onChange:e=>U(e.target.value),className:"w-40"}),(0,a.jsx)(r.Input,{placeholder:"地址，如：https://example.com:3000",value:A,onChange:e=>S(e.target.value),className:"flex-1"}),(0,a.jsx)(l.Button,{onClick:O,disabled:T||!M||!A,children:T?(0,a.jsx)(u.Loader2,{className:"h-4 w-4 animate-spin"}):(0,a.jsx)(x.Plus,{className:"h-4 w-4"})})]}),e.length>0?(0,a.jsxs)(c.Table,{children:[(0,a.jsx)(c.TableHeader,{children:(0,a.jsxs)(c.TableRow,{children:[(0,a.jsx)(c.TableHead,{children:"名称"}),(0,a.jsx)(c.TableHead,{children:"地址"}),(0,a.jsx)(c.TableHead,{children:"登录链接"}),(0,a.jsx)(c.TableHead,{className:"w-24 text-right",children:"操作"})]})}),(0,a.jsx)(c.TableBody,{children:e.map(e=>{var t;let s=(t=e.baseUrl,H?`${t}/login/token?token=${H}`:null);return(0,a.jsxs)(c.TableRow,{children:[(0,a.jsx)(c.TableCell,{className:"font-medium",children:e.label}),(0,a.jsx)(c.TableCell,{className:"text-muted-foreground",children:(0,a.jsxs)("a",{href:e.baseUrl,target:"_blank",rel:"noopener noreferrer",className:"hover:text-primary hover:underline flex items-center gap-1",children:[e.baseUrl,(0,a.jsx)(j,{className:"h-3 w-3"})]})}),(0,a.jsx)(c.TableCell,{children:s?(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("code",{className:"text-xs bg-muted px-2 py-1 rounded max-w-xs truncate block",children:s}),(0,a.jsx)(l.Button,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>G(s,e.id),children:P===e.id?(0,a.jsx)(v.Check,{className:"h-3 w-3 text-green-500"}):(0,a.jsx)(m.Copy,{className:"h-3 w-3"})})]}):(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"需要永久Token"})}),(0,a.jsx)(c.TableCell,{className:"text-right",children:(0,a.jsx)(l.Button,{variant:"ghost",size:"icon",onClick:()=>E(e.id),children:(0,a.jsx)(h.Trash2,{className:"h-4 w-4 text-destructive"})})})]},e.id)})})]}):(0,a.jsxs)("div",{className:"text-center py-6 text-muted-foreground",children:[(0,a.jsx)(p.Link,{className:"h-10 w-10 mx-auto mb-3 opacity-50"}),(0,a.jsx)("p",{children:"暂无自定义登录地址"}),(0,a.jsx)("p",{className:"text-sm mt-1",children:"添加你的域名或公网IP地址"})]})]})]})]})}e.s(["default",()=>N],35987)}]);