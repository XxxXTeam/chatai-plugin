(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,5945,e=>{"use strict";var a=e.i(33169),i=e.i(60844),l=e.i(8422),s=e.i(51200),t=e.i(72029),n=e.i(30243),r=e.i(99573),o=e.i(13107),d=e.i(20308),c=e.i(20650),m=e.i(81080),h=e.i(10201),b=e.i(79342),x=e.i(64625),g=e.i(89908),u=e.i(5850),p=e.i(40204),y=e.i(96173),j=e.i(15204),v=e.i(63959),C=e.i(98858),f=e.i(74940),N=e.i(17286),P=e.i(10273),T=e.i(70620),E=e.i(32308),w=e.i(79923),M=e.i(10148),S=e.i(57345),k=e.i(36393),I=e.i(72024),L=e.i(60001),_=e.i(60713),G=e.i(35771),R=e.i(14775);let K=(0,e.i(50974).default)("mouse-pointer-2",[["path",{d:"M4.037 4.688a.495.495 0 0 1 .651-.651l16 6.5a.5.5 0 0 1-.063.947l-6.124 1.58a2 2 0 0 0-1.438 1.435l-1.579 6.126a.5.5 0 0 1-.947.063z",key:"edeuup"}]]);var V=e.i(82251),U=e.i(75979);function B({icon:e,title:i,desc:l,value:s,onChange:t,children:n}){return(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 rounded-md bg-muted",children:e}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:i}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:l})]})]}),(0,a.jsxs)(h.Select,{value:s,onValueChange:t,children:[(0,a.jsx)(h.SelectTrigger,{className:"w-24",children:(0,a.jsx)(h.SelectValue,{})}),(0,a.jsxs)(h.SelectContent,{children:[(0,a.jsx)(h.SelectItem,{value:"inherit",children:"ç»§æ‰¿"}),(0,a.jsx)(h.SelectItem,{value:"on",children:"å¼€å¯"}),(0,a.jsx)(h.SelectItem,{value:"off",children:"å…³é—­"})]})]})]}),n]})}var A=e.i(84519);function H({label:e="æ¦‚çŽ‡",value:i,onChange:l,disabled:s=!1,className:t}){let n="inherit"===i?1:i;return(0,a.jsxs)("div",{className:`flex items-center gap-2 ${t} ${s?"opacity-50 pointer-events-none":""}`,children:[(0,a.jsx)(r.Label,{className:"text-xs w-16",children:e}),(0,a.jsx)(A.Slider,{value:[n],onValueChange:([e])=>l(e),min:0,max:1,step:.05,disabled:s,className:"flex-1"}),(0,a.jsxs)("span",{className:"text-xs w-10 text-right",children:[Math.round(100*n),"%"]})]})}function z({icon:e,title:i,enabled:l,onEnabledChange:s,probability:t,onProbabilityChange:n,children:r}){return(0,a.jsxs)("div",{className:"rounded-lg border overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-muted/30",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[e,(0,a.jsx)("span",{className:"text-sm font-medium",children:i})]}),(0,a.jsxs)(h.Select,{value:l,onValueChange:s,children:[(0,a.jsx)(h.SelectTrigger,{className:"w-24 h-8",children:(0,a.jsx)(h.SelectValue,{})}),(0,a.jsxs)(h.SelectContent,{children:[(0,a.jsx)(h.SelectItem,{value:"inherit",children:"ç»§æ‰¿"}),(0,a.jsx)(h.SelectItem,{value:"on",children:"å¼€å¯"}),(0,a.jsx)(h.SelectItem,{value:"off",children:"å…³é—­"})]})]})]}),"on"===l&&(0,a.jsxs)("div",{className:"p-3 space-y-3 border-t",children:[(0,a.jsx)(H,{value:t,onChange:n}),r]})]})}var D=e.i(17171);function F({label:e,value:i,onChange:l,min:s,max:t,step:o,placeholder:d,className:c,containerClassName:m,description:h,...b}){return(0,a.jsxs)("div",{className:(0,D.cn)("space-y-1",m),children:[(0,a.jsx)(r.Label,{className:"text-xs",children:e}),(0,a.jsx)(n.Input,{type:"number",value:i,onChange:l,min:s,max:t,step:o,placeholder:d,className:(0,D.cn)("h-8",c),...b}),h&&(0,a.jsx)("p",{className:"text-[10px] text-muted-foreground",children:h})]})}function Q({label:e,value:i,models:l,onChange:s,placeholder:t="ä½¿ç”¨å…¨å±€é…ç½®",className:n}){return(0,a.jsxs)("div",{className:(0,D.cn)("space-y-1",n),children:[(0,a.jsx)(r.Label,{className:"text-xs",children:e}),(0,a.jsxs)(h.Select,{value:i||"__default__",onValueChange:e=>s("__default__"===e?"":e),children:[(0,a.jsx)(h.SelectTrigger,{children:(0,a.jsx)(h.SelectValue,{placeholder:t})}),(0,a.jsxs)(h.SelectContent,{className:"max-h-[200px]",children:[(0,a.jsx)(h.SelectItem,{value:"__default__",children:t}),l.map(e=>(0,a.jsx)(h.SelectItem,{value:e,children:e},e))]})]})]})}var O=e.i(13795);function $({id:e}){let A=(0,l.useRouter)(),D="new"===e,[$,q]=(0,i.useState)(!D),[X,Z]=(0,i.useState)(!1),[J,W]=(0,i.useState)([]),[Y,ee]=(0,i.useState)([]),[ea,ei]=(0,i.useState)([]),[el,es]=(0,i.useState)(!1),[et,en]=(0,i.useState)(null),[er,eo]=(0,i.useState)({name:"",baseUrl:"",apiKey:"",adapterType:"openai",models:"",enabled:!0,priority:0,modelsPath:"",chatPath:"",imageTransferMode:"auto",imageCompress:!0,imageQuality:85,imageMaxSize:4096}),[ed,ec]=(0,i.useState)({groupId:"",groupName:"",enabled:!0,presetId:"",systemPrompt:"",triggerMode:"default",customPrefix:"",chatModel:"",summaryModel:"",bymModel:"",gameModel:"",imageGenModel:"",gameProbability:"inherit",gameEnableTools:"inherit",gameTemperature:"inherit",gameMaxTokens:"inherit",toolsEnabled:"inherit",imageGenEnabled:"inherit",summaryEnabled:"inherit",eventEnabled:"inherit",bymEnabled:"inherit",bymPresetId:"",bymPrompt:"",bymProbability:"inherit",bymTemperature:"inherit",bymMaxTokens:"inherit",bymReplyLength:"medium",bymUseEmoji:!0,proactiveChatEnabled:"inherit",proactiveChatProbability:"inherit",proactiveChatCooldown:"inherit",proactiveChatMaxDaily:"inherit",proactiveChatMinMessages:5,proactiveChatTimeStart:8,proactiveChatTimeEnd:23,welcomeEnabled:"inherit",welcomeMessage:"",welcomePrompt:"",welcomeProbability:"inherit",goodbyeEnabled:"inherit",goodbyePrompt:"",goodbyeProbability:"inherit",pokeEnabled:"inherit",pokeBack:!1,pokeProbability:"inherit",recallEnabled:"inherit",recallProbability:"inherit",banEnabled:"inherit",banProbability:"inherit",luckyKingEnabled:"inherit",luckyKingProbability:"inherit",honorEnabled:"inherit",honorProbability:"inherit",essenceEnabled:"inherit",essenceProbability:"inherit",adminEnabled:"inherit",adminProbability:"inherit",emojiThiefEnabled:"inherit",emojiThiefSeparateFolder:!0,emojiThiefMaxCount:500,emojiThiefStealRate:1,emojiThiefTriggerRate:.05,emojiThiefTriggerMode:"off",chatContextLength:20,chatStreamReply:!0,chatQuoteReply:!1,chatShowThinking:!0,listMode:"none",blacklist:[],whitelist:[],summaryPushEnabled:!1,summaryPushIntervalType:"day",summaryPushIntervalValue:1,summaryPushHour:20,summaryPushMessageCount:100,independentChannels:[],forbidGlobalModel:!1,dailyGroupLimit:0,dailyUserLimit:0,usageLimitMessage:"",knowledgeIds:[]});(0,i.useEffect)(()=>{em()},[e]);let em=async()=>{try{let[a,i,l]=await Promise.all([U.presetsApi.list(),U.channelsApi.list(),U.knowledgeApi.list()]);W(a?.data||[]),ee((l?.data||[]).map(e=>({id:e.id,name:e.name})));let s=new Set;if((i?.data||[]).forEach(e=>{Array.isArray(e.models)&&e.models.forEach(e=>s.add(e))}),ei(Array.from(s).sort()),!D){let a=await U.scopeApi.getGroups(),i=(a?.data||[]).find(a=>a.groupId===e);if(i){let e=i.settings||{};ec({groupId:i.groupId,groupName:i.groupName||"",enabled:!1!==i.enabled,presetId:i.presetId||"",systemPrompt:i.systemPrompt||"",triggerMode:e.triggerMode||"default",customPrefix:e.customPrefix||"",chatModel:e.chatModel||"",summaryModel:e.summaryModel||"",bymModel:e.bymModel||"",gameModel:e.gameModel||"",imageGenModel:e.imageGenModel||"",gameProbability:void 0===e.gameProbability||"inherit"===e.gameProbability?"inherit":Number(e.gameProbability),gameEnableTools:void 0===e.gameEnableTools?"inherit":e.gameEnableTools?"on":"off",gameTemperature:void 0===e.gameTemperature||"inherit"===e.gameTemperature?"inherit":Number(e.gameTemperature),gameMaxTokens:void 0===e.gameMaxTokens||"inherit"===e.gameMaxTokens?"inherit":Number(e.gameMaxTokens),toolsEnabled:void 0===e.toolsEnabled?"inherit":e.toolsEnabled?"on":"off",imageGenEnabled:void 0===e.imageGenEnabled?"inherit":e.imageGenEnabled?"on":"off",summaryEnabled:void 0===e.summaryEnabled?"inherit":e.summaryEnabled?"on":"off",eventEnabled:void 0===e.eventEnabled?"inherit":e.eventEnabled?"on":"off",bymEnabled:void 0===e.bymEnabled?"inherit":e.bymEnabled?"on":"off",bymPresetId:e.bymPresetId||"",bymPrompt:e.bymPrompt||"",bymProbability:void 0===e.bymProbability||"inherit"===e.bymProbability?"inherit":Number(e.bymProbability),bymTemperature:void 0===e.bymTemperature||"inherit"===e.bymTemperature?"inherit":Number(e.bymTemperature),bymMaxTokens:void 0===e.bymMaxTokens||"inherit"===e.bymMaxTokens?"inherit":Number(e.bymMaxTokens),proactiveChatEnabled:void 0===e.proactiveChatEnabled?"inherit":e.proactiveChatEnabled?"on":"off",proactiveChatProbability:e.proactiveChatProbability??"inherit",proactiveChatCooldown:e.proactiveChatCooldown??"inherit",proactiveChatMaxDaily:e.proactiveChatMaxDaily??"inherit",welcomeEnabled:void 0===e.welcomeEnabled?"inherit":e.welcomeEnabled?"on":"off",welcomeMessage:e.welcomeMessage||"",welcomePrompt:e.welcomePrompt||"",welcomeProbability:e.welcomeProbability??"inherit",goodbyeEnabled:void 0===e.goodbyeEnabled?"inherit":e.goodbyeEnabled?"on":"off",goodbyePrompt:e.goodbyePrompt||"",goodbyeProbability:e.goodbyeProbability??"inherit",pokeEnabled:void 0===e.pokeEnabled?"inherit":e.pokeEnabled?"on":"off",pokeBack:e.pokeBack||!1,pokeProbability:e.pokeProbability??"inherit",recallEnabled:void 0===e.recallEnabled?"inherit":e.recallEnabled?"on":"off",recallProbability:e.recallProbability??"inherit",banEnabled:void 0===e.banEnabled?"inherit":e.banEnabled?"on":"off",banProbability:e.banProbability??"inherit",luckyKingEnabled:void 0===e.luckyKingEnabled?"inherit":e.luckyKingEnabled?"on":"off",luckyKingProbability:e.luckyKingProbability??"inherit",honorEnabled:void 0===e.honorEnabled?"inherit":e.honorEnabled?"on":"off",honorProbability:e.honorProbability??"inherit",essenceEnabled:void 0===e.essenceEnabled?"inherit":e.essenceEnabled?"on":"off",essenceProbability:e.essenceProbability??"inherit",adminEnabled:void 0===e.adminEnabled?"inherit":e.adminEnabled?"on":"off",adminProbability:e.adminProbability??"inherit",emojiThiefEnabled:void 0===e.emojiThiefEnabled?"inherit":e.emojiThiefEnabled?"on":"off",emojiThiefSeparateFolder:e.emojiThiefSeparateFolder??!0,emojiThiefMaxCount:e.emojiThiefMaxCount??500,emojiThiefStealRate:e.emojiThiefStealRate??1,emojiThiefTriggerRate:e.emojiThiefTriggerRate??.05,emojiThiefTriggerMode:e.emojiThiefTriggerMode||"off",bymReplyLength:e.bymReplyLength||"medium",bymUseEmoji:e.bymUseEmoji??!0,proactiveChatMinMessages:e.proactiveChatMinMessages??5,proactiveChatTimeStart:e.proactiveChatTimeStart??8,proactiveChatTimeEnd:e.proactiveChatTimeEnd??23,chatContextLength:e.chatContextLength??20,chatStreamReply:e.chatStreamReply??!0,chatQuoteReply:e.chatQuoteReply??!1,chatShowThinking:e.chatShowThinking??!0,listMode:e.listMode||"none",blacklist:e.blacklist||[],whitelist:e.whitelist||[],summaryPushEnabled:e.summaryPushEnabled??!1,summaryPushIntervalType:e.summaryPushIntervalType||"day",summaryPushIntervalValue:e.summaryPushIntervalValue??1,summaryPushHour:e.summaryPushHour??20,summaryPushMessageCount:e.summaryPushMessageCount??100,independentChannels:e.independentChannels||[],forbidGlobalModel:e.forbidGlobalModel||!1,dailyGroupLimit:e.usageLimit?.dailyGroupLimit||0,dailyUserLimit:e.usageLimit?.dailyUserLimit||0,usageLimitMessage:e.usageLimit?.limitMessage||"",knowledgeIds:i.knowledgeIds||[]})}}}catch(e){console.error("åŠ è½½æ•°æ®å¤±è´¥",e),b.toast.error("åŠ è½½æ•°æ®å¤±è´¥")}finally{q(!1)}},eh=async()=>{if(!ed.groupId)return void b.toast.error("è¯·å¡«å†™ç¾¤å·");Z(!0);try{await U.scopeApi.updateGroup(ed.groupId,{groupName:ed.groupName,presetId:ed.presetId||void 0,systemPrompt:ed.systemPrompt||void 0,enabled:ed.enabled,knowledgeIds:ed.knowledgeIds.length>0?ed.knowledgeIds:void 0,triggerMode:ed.triggerMode,customPrefix:ed.customPrefix||void 0,chatModel:ed.chatModel||void 0,summaryModel:ed.summaryModel||void 0,bymModel:ed.bymModel||void 0,gameModel:ed.gameModel||void 0,imageGenModel:ed.imageGenModel||void 0,gameProbability:"inherit"===ed.gameProbability?void 0:ed.gameProbability,gameEnableTools:"inherit"===ed.gameEnableTools?void 0:"on"===ed.gameEnableTools,gameTemperature:"inherit"===ed.gameTemperature?void 0:ed.gameTemperature,gameMaxTokens:"inherit"===ed.gameMaxTokens?void 0:ed.gameMaxTokens,toolsEnabled:"inherit"===ed.toolsEnabled?void 0:"on"===ed.toolsEnabled,imageGenEnabled:"inherit"===ed.imageGenEnabled?void 0:"on"===ed.imageGenEnabled,summaryEnabled:"inherit"===ed.summaryEnabled?void 0:"on"===ed.summaryEnabled,eventEnabled:"inherit"===ed.eventEnabled?void 0:"on"===ed.eventEnabled,bymEnabled:"inherit"===ed.bymEnabled?void 0:"on"===ed.bymEnabled,bymPresetId:ed.bymPresetId||void 0,bymPrompt:ed.bymPrompt||void 0,bymProbability:"inherit"===ed.bymProbability?void 0:ed.bymProbability,bymTemperature:"inherit"===ed.bymTemperature?void 0:ed.bymTemperature,bymMaxTokens:"inherit"===ed.bymMaxTokens?void 0:ed.bymMaxTokens,proactiveChatEnabled:"inherit"===ed.proactiveChatEnabled?void 0:"on"===ed.proactiveChatEnabled,proactiveChatProbability:"inherit"===ed.proactiveChatProbability?void 0:ed.proactiveChatProbability,proactiveChatCooldown:"inherit"===ed.proactiveChatCooldown?void 0:ed.proactiveChatCooldown,proactiveChatMaxDaily:"inherit"===ed.proactiveChatMaxDaily?void 0:ed.proactiveChatMaxDaily,welcomeEnabled:"inherit"===ed.welcomeEnabled?void 0:"on"===ed.welcomeEnabled,welcomeMessage:ed.welcomeMessage||void 0,welcomePrompt:ed.welcomePrompt||void 0,welcomeProbability:"inherit"===ed.welcomeProbability?void 0:ed.welcomeProbability,goodbyeEnabled:"inherit"===ed.goodbyeEnabled?void 0:"on"===ed.goodbyeEnabled,goodbyePrompt:ed.goodbyePrompt||void 0,goodbyeProbability:"inherit"===ed.goodbyeProbability?void 0:ed.goodbyeProbability,pokeEnabled:"inherit"===ed.pokeEnabled?void 0:"on"===ed.pokeEnabled,pokeBack:ed.pokeBack,pokeProbability:"inherit"===ed.pokeProbability?void 0:ed.pokeProbability,recallEnabled:"inherit"===ed.recallEnabled?void 0:"on"===ed.recallEnabled,recallProbability:"inherit"===ed.recallProbability?void 0:ed.recallProbability,banEnabled:"inherit"===ed.banEnabled?void 0:"on"===ed.banEnabled,banProbability:"inherit"===ed.banProbability?void 0:ed.banProbability,luckyKingEnabled:"inherit"===ed.luckyKingEnabled?void 0:"on"===ed.luckyKingEnabled,luckyKingProbability:"inherit"===ed.luckyKingProbability?void 0:ed.luckyKingProbability,honorEnabled:"inherit"===ed.honorEnabled?void 0:"on"===ed.honorEnabled,honorProbability:"inherit"===ed.honorProbability?void 0:ed.honorProbability,essenceEnabled:"inherit"===ed.essenceEnabled?void 0:"on"===ed.essenceEnabled,essenceProbability:"inherit"===ed.essenceProbability?void 0:ed.essenceProbability,adminEnabled:"inherit"===ed.adminEnabled?void 0:"on"===ed.adminEnabled,adminProbability:"inherit"===ed.adminProbability?void 0:ed.adminProbability,emojiThiefEnabled:"inherit"===ed.emojiThiefEnabled?void 0:"on"===ed.emojiThiefEnabled,emojiThiefSeparateFolder:ed.emojiThiefSeparateFolder,emojiThiefMaxCount:ed.emojiThiefMaxCount,emojiThiefStealRate:ed.emojiThiefStealRate,emojiThiefTriggerRate:ed.emojiThiefTriggerRate,emojiThiefTriggerMode:ed.emojiThiefTriggerMode,bymReplyLength:ed.bymReplyLength,bymUseEmoji:ed.bymUseEmoji,proactiveChatMinMessages:ed.proactiveChatMinMessages,proactiveChatTimeStart:ed.proactiveChatTimeStart,proactiveChatTimeEnd:ed.proactiveChatTimeEnd,chatContextLength:ed.chatContextLength,chatStreamReply:ed.chatStreamReply,chatQuoteReply:ed.chatQuoteReply,chatShowThinking:ed.chatShowThinking,listMode:"none"!==ed.listMode?ed.listMode:void 0,blacklist:ed.blacklist.length>0?ed.blacklist:void 0,whitelist:ed.whitelist.length>0?ed.whitelist:void 0,summaryPushEnabled:ed.summaryPushEnabled,summaryPushIntervalType:ed.summaryPushIntervalType,summaryPushIntervalValue:ed.summaryPushIntervalValue,summaryPushHour:ed.summaryPushHour,summaryPushMessageCount:ed.summaryPushMessageCount,independentChannels:ed.independentChannels.length>0?ed.independentChannels:void 0,forbidGlobalModel:ed.forbidGlobalModel,usageLimit:{dailyGroupLimit:ed.dailyGroupLimit,dailyUserLimit:ed.dailyUserLimit,limitMessage:ed.usageLimitMessage||void 0}}),b.toast.success("ä¿å­˜æˆåŠŸ"),D&&A.push("/groups")}catch(e){console.error("ä¿å­˜å¤±è´¥",e),b.toast.error("ä¿å­˜å¤±è´¥")}finally{Z(!1)}};return $?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)(g.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):(0,a.jsxs)("div",{className:"container max-w-4xl px-4 sm:px-6 py-4 sm:py-6 space-y-4 sm:space-y-6 flex-1 h-full flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0",children:[(0,a.jsx)(t.Button,{variant:"ghost",size:"icon",className:"shrink-0",onClick:()=>A.push("/groups"),children:(0,a.jsx)(x.ArrowLeft,{className:"h-5 w-5"})}),(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsx)("h1",{className:"text-xl sm:text-2xl font-bold truncate",children:D?"æ·»åŠ ç¾¤ç»„":"ç¼–è¾‘ç¾¤ç»„"}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-muted-foreground truncate",children:D?"é…ç½®æ–°ç¾¤ç»„çš„ä¸ªæ€§åŒ–è®¾ç½®":`ç¾¤å·: ${ed.groupId}`})]})]}),(0,a.jsxs)(t.Button,{onClick:eh,disabled:X,size:"sm",className:"shrink-0",children:[X?(0,a.jsx)(g.Loader2,{className:"h-4 w-4 sm:mr-2 animate-spin"}):(0,a.jsx)(u.Save,{className:"h-4 w-4 sm:mr-2"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"ä¿å­˜"})]})]}),(0,a.jsxs)(m.Tabs,{defaultValue:"basic",className:"space-y-4",children:[(0,a.jsxs)(m.TabsList,{className:"grid w-full grid-cols-5 h-auto",children:[(0,a.jsxs)(m.TabsTrigger,{value:"basic",className:"text-xs sm:text-sm px-1 sm:px-3 py-2",children:[(0,a.jsx)(p.Settings,{className:"h-4 w-4 sm:mr-1"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"åŸºç¡€"})]}),(0,a.jsxs)(m.TabsTrigger,{value:"features",className:"text-xs sm:text-sm px-1 sm:px-3 py-2",children:[(0,a.jsx)(y.Zap,{className:"h-4 w-4 sm:mr-1"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"åŠŸèƒ½"})]}),(0,a.jsxs)(m.TabsTrigger,{value:"bym",className:"text-xs sm:text-sm px-1 sm:px-3 py-2",children:[(0,a.jsx)(k.Smile,{className:"h-4 w-4 sm:mr-1"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"ä¼ªäºº"})]}),(0,a.jsxs)(m.TabsTrigger,{value:"game",className:"text-xs sm:text-sm px-1 sm:px-3 py-2",children:[(0,a.jsx)(V.Gamepad2,{className:"h-4 w-4 sm:mr-1"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"æ¸¸æˆ"})]}),(0,a.jsxs)(m.TabsTrigger,{value:"channel",className:"text-xs sm:text-sm px-1 sm:px-3 py-2",children:[(0,a.jsx)(I.Server,{className:"h-4 w-4 sm:mr-1"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"æ¸ é“"})]}),(0,a.jsxs)(m.TabsTrigger,{value:"advanced",className:"text-xs sm:text-sm px-1 sm:px-3 py-2",children:[(0,a.jsx)(j.Sparkles,{className:"h-4 w-4 sm:mr-1"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"é«˜çº§"})]})]}),(0,a.jsxs)(m.TabsContent,{value:"basic",className:"space-y-4",children:[(0,a.jsxs)(s.Card,{children:[(0,a.jsx)(s.CardHeader,{children:(0,a.jsxs)(s.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(E.Users,{className:"h-4 w-4"}),"åŸºæœ¬ä¿¡æ¯"]})}),(0,a.jsxs)(s.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"ç¾¤å· *"}),(0,a.jsx)(n.Input,{value:ed.groupId,onChange:e=>ec({...ed,groupId:e.target.value}),placeholder:"è¾“å…¥ç¾¤å·",disabled:!D})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"ç¾¤åç§°"}),(0,a.jsx)(n.Input,{value:ed.groupName,onChange:e=>ec({...ed,groupName:e.target.value}),placeholder:"ç¾¤åç§°ï¼ˆå¯é€‰ï¼‰"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(C.Power,{className:"h-4 w-4 text-green-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:"å¯ç”¨æœ¬ç¾¤"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"å…³é—­åŽæœºå™¨äººå°†ä¸å“åº”æœ¬ç¾¤æ¶ˆæ¯"})]})]}),(0,a.jsx)(d.Switch,{checked:ed.enabled,onCheckedChange:e=>ec({...ed,enabled:e})})]})]})]}),(0,a.jsxs)(s.Card,{children:[(0,a.jsx)(s.CardHeader,{children:(0,a.jsxs)(s.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(P.MessageSquare,{className:"h-4 w-4"}),"è§¦å‘è®¾ç½®"]})}),(0,a.jsxs)(s.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"è§¦å‘æ¨¡å¼"}),(0,a.jsxs)(h.Select,{value:ed.triggerMode,onValueChange:e=>ec({...ed,triggerMode:e}),children:[(0,a.jsx)(h.SelectTrigger,{children:(0,a.jsx)(h.SelectValue,{})}),(0,a.jsxs)(h.SelectContent,{children:[(0,a.jsx)(h.SelectItem,{value:"default",children:"é»˜è®¤ï¼ˆ@æˆ–å‰ç¼€ï¼‰"}),(0,a.jsx)(h.SelectItem,{value:"at",children:"ä»…@è§¦å‘"}),(0,a.jsx)(h.SelectItem,{value:"prefix",children:"ä»…å‰ç¼€è§¦å‘"}),(0,a.jsx)(h.SelectItem,{value:"all",children:"æ‰€æœ‰æ¶ˆæ¯è§¦å‘"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"è‡ªå®šä¹‰å‰ç¼€"}),(0,a.jsx)(n.Input,{value:ed.customPrefix,onChange:e=>ec({...ed,customPrefix:e.target.value}),placeholder:"ç•™ç©ºä½¿ç”¨å…¨å±€å‰ç¼€"})]})]})]}),(0,a.jsxs)(s.Card,{children:[(0,a.jsx)(s.CardHeader,{children:(0,a.jsxs)(s.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(v.BookOpen,{className:"h-4 w-4"}),"äººè®¾ä¸Žé¢„è®¾"]})}),(0,a.jsxs)(s.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"é€‰æ‹©é¢„è®¾"}),(0,a.jsxs)(h.Select,{value:ed.presetId||"__none__",onValueChange:e=>ec({...ed,presetId:"__none__"===e?"":e}),children:[(0,a.jsx)(h.SelectTrigger,{children:(0,a.jsx)(h.SelectValue,{placeholder:"ä¸ä½¿ç”¨é¢„è®¾"})}),(0,a.jsxs)(h.SelectContent,{children:[(0,a.jsx)(h.SelectItem,{value:"__none__",children:"ä¸ä½¿ç”¨é¢„è®¾"}),J.map(e=>(0,a.jsx)(h.SelectItem,{value:e.id,children:e.name},e.id))]})]})]}),(0,a.jsx)("div",{className:"space-y-2",children:(0,a.jsx)(Q,{label:"å¯¹è¯æ¨¡åž‹",value:ed.chatModel,models:ea,onChange:e=>ec({...ed,chatModel:e}),placeholder:"ä½¿ç”¨å…¨å±€"})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"ç³»ç»Ÿæç¤ºè¯"}),(0,a.jsx)(c.Textarea,{value:ed.systemPrompt,onChange:e=>ec({...ed,systemPrompt:e.target.value}),placeholder:"ç•™ç©ºä½¿ç”¨é¢„è®¾æˆ–å…¨å±€æç¤ºè¯",rows:3})]})]})]}),(0,a.jsxs)(s.Card,{children:[(0,a.jsx)(s.CardHeader,{children:(0,a.jsxs)(s.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(P.MessageSquare,{className:"h-4 w-4"}),"èŠå¤©é…ç½®"]})}),(0,a.jsx)(s.CardContent,{className:"space-y-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-3",children:[(0,a.jsx)(F,{label:"ä¸Šä¸‹æ–‡é•¿åº¦",min:1,max:100,value:ed.chatContextLength,onChange:e=>ec({...ed,chatContextLength:parseInt(e.target.value)||20})}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(r.Label,{className:"text-xs",children:"æµå¼å›žå¤"}),(0,a.jsx)(d.Switch,{checked:ed.chatStreamReply,onCheckedChange:e=>ec({...ed,chatStreamReply:e})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(r.Label,{className:"text-xs",children:"å¼•ç”¨å›žå¤"}),(0,a.jsx)(d.Switch,{checked:ed.chatQuoteReply,onCheckedChange:e=>ec({...ed,chatQuoteReply:e})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(r.Label,{className:"text-xs",children:"æ˜¾ç¤ºæ€è€ƒ"}),(0,a.jsx)(d.Switch,{checked:ed.chatShowThinking,onCheckedChange:e=>ec({...ed,chatShowThinking:e})})]})]})})]})]}),(0,a.jsxs)(m.TabsContent,{value:"features",className:"space-y-4",children:[(0,a.jsxs)(s.Card,{children:[(0,a.jsx)(s.CardHeader,{children:(0,a.jsx)(s.CardTitle,{className:"text-base",children:"åŠŸèƒ½å¼€å…³"})}),(0,a.jsxs)(s.CardContent,{className:"space-y-3",children:[(0,a.jsx)(B,{icon:(0,a.jsx)(y.Zap,{className:"h-4 w-4 text-yellow-500"}),title:"å·¥å…·è°ƒç”¨",desc:"å…è®¸AIè°ƒç”¨å¤–éƒ¨å·¥å…·",value:ed.toolsEnabled,onChange:e=>ec({...ed,toolsEnabled:e})}),(0,a.jsx)(B,{icon:(0,a.jsx)(N.Image,{className:"h-4 w-4 text-pink-500"}),title:"ç»˜å›¾åŠŸèƒ½",desc:"æ–‡ç”Ÿå›¾ã€å›¾ç”Ÿå›¾ç­‰",value:ed.imageGenEnabled,onChange:e=>ec({...ed,imageGenEnabled:e})}),"on"===ed.imageGenEnabled&&(0,a.jsx)("div",{className:"ml-12 p-3 rounded-lg bg-muted/50 space-y-2",children:(0,a.jsx)(Q,{label:"ç»˜å›¾æ¨¡åž‹",value:ed.imageGenModel,models:ea.filter(e=>e.includes("dall")||e.includes("flux")||e.includes("image")),onChange:e=>ec({...ed,imageGenModel:e}),placeholder:"ç»§æ‰¿å…¨å±€"})}),(0,a.jsx)(B,{icon:(0,a.jsx)(v.BookOpen,{className:"h-4 w-4 text-blue-500"}),title:"ç¾¤èŠæ€»ç»“",desc:"è‡ªåŠ¨æ€»ç»“ç¾¤èŠå†…å®¹",value:ed.summaryEnabled,onChange:e=>ec({...ed,summaryEnabled:e})}),"on"===ed.summaryEnabled&&(0,a.jsxs)("div",{className:"ml-12 p-3 rounded-lg bg-muted/50 space-y-3",children:[(0,a.jsx)("div",{className:"space-y-2",children:(0,a.jsx)(Q,{label:"æ€»ç»“æ¨¡åž‹",value:ed.summaryModel,models:ea,onChange:e=>ec({...ed,summaryModel:e}),placeholder:"ç»§æ‰¿å…¨å±€"})}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:"å®šæ—¶æŽ¨é€"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"è‡ªåŠ¨å®šæ—¶æŽ¨é€ç¾¤èŠæ€»ç»“"})]}),(0,a.jsx)(d.Switch,{checked:ed.summaryPushEnabled,onCheckedChange:e=>ec({...ed,summaryPushEnabled:e})})]}),ed.summaryPushEnabled&&(0,a.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(r.Label,{className:"text-xs",children:"é—´éš”ç±»åž‹"}),(0,a.jsxs)(h.Select,{value:ed.summaryPushIntervalType,onValueChange:e=>ec({...ed,summaryPushIntervalType:e}),children:[(0,a.jsx)(h.SelectTrigger,{className:"h-9",children:(0,a.jsx)(h.SelectValue,{})}),(0,a.jsxs)(h.SelectContent,{children:[(0,a.jsx)(h.SelectItem,{value:"hour",children:"æ¯Xå°æ—¶"}),(0,a.jsx)(h.SelectItem,{value:"day",children:"æ¯Xå¤©"})]})]})]}),(0,a.jsx)(F,{label:"é—´éš”å€¼",min:1,value:ed.summaryPushIntervalValue,onChange:e=>ec({...ed,summaryPushIntervalValue:parseInt(e.target.value)||1})}),"day"===ed.summaryPushIntervalType&&(0,a.jsx)(F,{label:"æŽ¨é€æ—¶é—´(ç‚¹)",min:0,max:23,value:ed.summaryPushHour,onChange:e=>ec({...ed,summaryPushHour:parseInt(e.target.value)||20})}),(0,a.jsx)(F,{label:"æ¶ˆæ¯æ•°é‡",min:10,value:ed.summaryPushMessageCount,onChange:e=>ec({...ed,summaryPushMessageCount:parseInt(e.target.value)||100})})]})]}),(0,a.jsx)(B,{icon:(0,a.jsx)(j.Sparkles,{className:"h-4 w-4 text-purple-500"}),title:"äº‹ä»¶å“åº”",desc:"å…¥ç¾¤ã€é€€ç¾¤ã€æˆ³ä¸€æˆ³ç­‰ï¼ˆå¼€å¯åŽåœ¨ä¸‹æ–¹é…ç½®è¯¦æƒ…ï¼‰",value:ed.eventEnabled,onChange:e=>ec({...ed,eventEnabled:e})}),(0,a.jsx)(B,{icon:(0,a.jsx)(R.Palette,{className:"h-4 w-4 text-cyan-500"}),title:"è¡¨æƒ…åŒ…å°å·",desc:"è‡ªåŠ¨æ”¶é›†å’Œå‘é€è¡¨æƒ…åŒ…",value:ed.emojiThiefEnabled,onChange:e=>ec({...ed,emojiThiefEnabled:e})}),"on"===ed.emojiThiefEnabled&&(0,a.jsxs)("div",{className:"ml-12 p-4 rounded-lg bg-muted/30 border space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border bg-card",children:[(0,a.jsxs)("div",{className:"space-y-0.5",children:[(0,a.jsx)(r.Label,{className:"text-sm font-medium",children:"ç‹¬ç«‹å­˜å‚¨"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"æœ¬ç¾¤è¡¨æƒ…åŒ…ç‹¬ç«‹å­˜å‚¨ï¼Œä¸ä¸Žå…¶ä»–ç¾¤å…±äº«"})]}),(0,a.jsx)(d.Switch,{checked:ed.emojiThiefSeparateFolder,onCheckedChange:e=>ec({...ed,emojiThiefSeparateFolder:e})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)(F,{label:"æœ€å¤§æ”¶é›†æ•°",min:10,max:5e3,value:ed.emojiThiefMaxCount,onChange:e=>ec({...ed,emojiThiefMaxCount:parseInt(e.target.value)||500})}),(0,a.jsx)("div",{className:"flex items-end h-full pb-1",children:(0,a.jsx)(H,{label:"æ”¶é›†æ¦‚çŽ‡",value:ed.emojiThiefStealRate,onChange:e=>ec({...ed,emojiThiefStealRate:e}),className:"w-full"})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{className:"text-xs",children:"éšæœºå‘å›¾æ¨¡å¼"}),(0,a.jsxs)(h.Select,{value:ed.emojiThiefTriggerMode,onValueChange:e=>ec({...ed,emojiThiefTriggerMode:e}),children:[(0,a.jsx)(h.SelectTrigger,{className:"h-9",children:(0,a.jsx)(h.SelectValue,{})}),(0,a.jsxs)(h.SelectContent,{children:[(0,a.jsx)(h.SelectItem,{value:"off",children:"å…³é—­è‡ªåŠ¨å‘é€"}),(0,a.jsx)(h.SelectItem,{value:"chat_follow",children:"å¯¹è¯è·Ÿéš"}),(0,a.jsx)(h.SelectItem,{value:"chat_random",children:"å¯¹è¯éšæœº"}),(0,a.jsx)(h.SelectItem,{value:"bym_follow",children:"ä¼ªäººè·Ÿéš"}),(0,a.jsx)(h.SelectItem,{value:"bym_random",children:"ä¼ªäººéšæœº"})]})]})]}),(0,a.jsx)("div",{className:"flex items-end h-full pb-1",children:(0,a.jsx)(H,{label:"å‘é€æ¦‚çŽ‡",value:ed.emojiThiefTriggerRate,onChange:e=>ec({...ed,emojiThiefTriggerRate:e}),disabled:"off"===ed.emojiThiefTriggerMode||"chat_follow"===ed.emojiThiefTriggerMode||"bym_follow"===ed.emojiThiefTriggerMode,className:"w-full"})})]}),(0,a.jsx)("p",{className:"text-[10px] text-muted-foreground bg-muted/50 p-2 rounded",children:"ðŸ’¡ è§¦å‘æ¨¡å¼100%å‘é€ï¼Œéšæœºæ¨¡å¼æŒ‰æ¦‚çŽ‡å‘é€ã€‚"})]})]})]}),"off"!==ed.eventEnabled&&(0,a.jsxs)(s.Card,{children:[(0,a.jsxs)(s.CardHeader,{children:[(0,a.jsxs)(s.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(j.Sparkles,{className:"h-4 w-4"}),"äº‹ä»¶é…ç½®"]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"æ¯ä¸ªäº‹ä»¶å¯ç‹¬ç«‹é…ç½®å“åº”æ¦‚çŽ‡ï¼Œå¼€å¯åŽé»˜è®¤100%"})]}),(0,a.jsxs)(s.CardContent,{className:"space-y-4",children:[(0,a.jsxs)(z,{icon:(0,a.jsx)(M.UserPlus,{className:"h-4 w-4 text-green-500"}),title:"å…¥ç¾¤æ¬¢è¿Ž",enabled:ed.welcomeEnabled,onEnabledChange:e=>{let a={welcomeEnabled:e};"on"===e&&"inherit"===ed.welcomeProbability&&(a.welcomeProbability=1),ec({...ed,...a})},probability:ed.welcomeProbability,onProbabilityChange:e=>ec({...ed,welcomeProbability:e}),children:[(0,a.jsx)(n.Input,{value:ed.welcomeMessage,onChange:e=>ec({...ed,welcomeMessage:e.target.value}),placeholder:"å›ºå®šæ¬¢è¿Žè¯­ï¼ˆç•™ç©ºä½¿ç”¨AIç”Ÿæˆï¼‰",className:"h-8 text-sm"}),(0,a.jsx)(c.Textarea,{value:ed.welcomePrompt,onChange:e=>ec({...ed,welcomePrompt:e.target.value}),placeholder:"AIæ¬¢è¿Žæç¤ºè¯",rows:2,className:"text-sm"})]}),(0,a.jsx)(z,{icon:(0,a.jsx)(S.UserMinus,{className:"h-4 w-4 text-red-500"}),title:"é€€ç¾¤å‘Šåˆ«",enabled:ed.goodbyeEnabled,onEnabledChange:e=>{let a={goodbyeEnabled:e};"on"===e&&"inherit"===ed.goodbyeProbability&&(a.goodbyeProbability=1),ec({...ed,...a})},probability:ed.goodbyeProbability,onProbabilityChange:e=>ec({...ed,goodbyeProbability:e}),children:(0,a.jsx)(c.Textarea,{value:ed.goodbyePrompt,onChange:e=>ec({...ed,goodbyePrompt:e.target.value}),placeholder:"AIå‘Šåˆ«æç¤ºè¯",rows:2,className:"text-sm"})}),(0,a.jsx)(z,{icon:(0,a.jsx)(K,{className:"h-4 w-4 text-orange-500"}),title:"æˆ³ä¸€æˆ³",enabled:ed.pokeEnabled,onEnabledChange:e=>{let a={pokeEnabled:e};"on"===e&&"inherit"===ed.pokeProbability&&(a.pokeProbability=1),ec({...ed,...a})},probability:ed.pokeProbability,onProbabilityChange:e=>ec({...ed,pokeProbability:e}),children:(0,a.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t",children:[(0,a.jsx)(r.Label,{className:"text-xs",children:"æˆ³å›žåŽ»"}),(0,a.jsx)(d.Switch,{checked:ed.pokeBack,onCheckedChange:e=>ec({...ed,pokeBack:e})})]})}),(0,a.jsx)(z,{icon:(0,a.jsx)("span",{className:"text-sm",children:"ðŸ”„"}),title:"æ’¤å›žå“åº”",enabled:ed.recallEnabled,onEnabledChange:e=>{let a={recallEnabled:e};"on"===e&&"inherit"===ed.recallProbability&&(a.recallProbability=1),ec({...ed,...a})},probability:ed.recallProbability,onProbabilityChange:e=>ec({...ed,recallProbability:e})}),(0,a.jsx)(z,{icon:(0,a.jsx)("span",{className:"text-sm",children:"ðŸ”‡"}),title:"ç¦è¨€å“åº”",enabled:ed.banEnabled,onEnabledChange:e=>{let a={banEnabled:e};"on"===e&&"inherit"===ed.banProbability&&(a.banProbability=1),ec({...ed,...a})},probability:ed.banProbability,onProbabilityChange:e=>ec({...ed,banProbability:e})}),(0,a.jsx)(z,{icon:(0,a.jsx)("span",{className:"text-sm",children:"ðŸ§§"}),title:"è¿æ°”çŽ‹å“åº”",enabled:ed.luckyKingEnabled,onEnabledChange:e=>{let a={luckyKingEnabled:e};"on"===e&&"inherit"===ed.luckyKingProbability&&(a.luckyKingProbability=1),ec({...ed,...a})},probability:ed.luckyKingProbability,onProbabilityChange:e=>ec({...ed,luckyKingProbability:e})}),(0,a.jsx)(z,{icon:(0,a.jsx)("span",{className:"text-sm",children:"ðŸ†"}),title:"è£èª‰å˜æ›´",enabled:ed.honorEnabled,onEnabledChange:e=>{let a={honorEnabled:e};"on"===e&&"inherit"===ed.honorProbability&&(a.honorProbability=1),ec({...ed,...a})},probability:ed.honorProbability,onProbabilityChange:e=>ec({...ed,honorProbability:e})}),(0,a.jsx)(z,{icon:(0,a.jsx)("span",{className:"text-sm",children:"â­"}),title:"ç²¾åŽæ¶ˆæ¯",enabled:ed.essenceEnabled,onEnabledChange:e=>{let a={essenceEnabled:e};"on"===e&&"inherit"===ed.essenceProbability&&(a.essenceProbability=1),ec({...ed,...a})},probability:ed.essenceProbability,onProbabilityChange:e=>ec({...ed,essenceProbability:e})}),(0,a.jsx)(z,{icon:(0,a.jsx)("span",{className:"text-sm",children:"ðŸ‘‘"}),title:"ç®¡ç†å‘˜å˜æ›´",enabled:ed.adminEnabled,onEnabledChange:e=>{let a={adminEnabled:e};"on"===e&&"inherit"===ed.adminProbability&&(a.adminProbability=1),ec({...ed,...a})},probability:ed.adminProbability,onProbabilityChange:e=>ec({...ed,adminProbability:e})})]})]})]}),(0,a.jsx)(m.TabsContent,{value:"bym",className:"space-y-4",children:(0,a.jsxs)(s.Card,{children:[(0,a.jsxs)(s.CardHeader,{children:[(0,a.jsxs)(s.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(k.Smile,{className:"h-4 w-4"}),"ä¼ªäººæ¨¡å¼"]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"æ¨¡æ‹ŸçœŸäººèŠå¤©é£Žæ ¼ï¼Œéšæœºå‚ä¸Žç¾¤èŠ"})]}),(0,a.jsxs)(s.CardContent,{className:"space-y-4",children:[(0,a.jsx)(B,{icon:(0,a.jsx)(k.Smile,{className:"h-4 w-4 text-orange-500"}),title:"å¯ç”¨ä¼ªäºº",desc:"å¼€å¯åŽæœºå™¨äººä¼šéšæœºå›žå¤ç¾¤æ¶ˆæ¯",value:ed.bymEnabled,onChange:e=>ec({...ed,bymEnabled:e})}),"off"!==ed.bymEnabled&&(0,a.jsxs)("div",{className:"space-y-4 ml-4 pl-4 border-l-2 border-muted",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"ä¼ªäººé¢„è®¾"}),(0,a.jsxs)(h.Select,{value:ed.bymPresetId||"__none__",onValueChange:e=>ec({...ed,bymPresetId:"__none__"===e?"":e}),children:[(0,a.jsx)(h.SelectTrigger,{children:(0,a.jsx)(h.SelectValue,{placeholder:"ä¸ä½¿ç”¨é¢„è®¾"})}),(0,a.jsxs)(h.SelectContent,{children:[(0,a.jsx)(h.SelectItem,{value:"__none__",children:"ä¸ä½¿ç”¨é¢„è®¾"}),J.map(e=>(0,a.jsx)(h.SelectItem,{value:e.id,children:e.name},e.id))]})]})]}),(0,a.jsx)("div",{className:"space-y-2",children:(0,a.jsx)(Q,{label:"ä¼ªäººæ¨¡åž‹",value:ed.bymModel,models:ea,onChange:e=>ec({...ed,bymModel:e}),placeholder:"ä½¿ç”¨å…¨å±€"})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"ä¼ªäººæç¤ºè¯"}),(0,a.jsx)(c.Textarea,{value:ed.bymPrompt,onChange:e=>ec({...ed,bymPrompt:e.target.value}),placeholder:"è‡ªå®šä¹‰ä¼ªäººäººè®¾ï¼ˆç•™ç©ºä½¿ç”¨é¢„è®¾æˆ–å…¨å±€ï¼‰",rows:2})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-3",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(r.Label,{className:"text-xs",children:"å›žå¤æ¦‚çŽ‡"}),(0,a.jsx)(t.Button,{variant:"ghost",size:"sm",className:"h-4 text-[10px] px-1",onClick:()=>ec({...ed,bymProbability:"inherit"===ed.bymProbability?.02:"inherit"}),children:"inherit"===ed.bymProbability?"ç»§æ‰¿":"è‡ªå®šä¹‰"})]}),"inherit"!==ed.bymProbability&&(0,a.jsx)(H,{label:"",value:ed.bymProbability,onChange:e=>ec({...ed,bymProbability:e}),className:"pt-1"}),"inherit"===ed.bymProbability&&(0,a.jsx)("div",{className:"text-xs text-muted-foreground h-8 flex items-center",children:"ä½¿ç”¨å…¨å±€è®¾ç½®"})]}),(0,a.jsx)(F,{label:"æ¸©åº¦",min:0,max:2,step:.1,value:"inherit"===ed.bymTemperature?"":ed.bymTemperature,onChange:e=>ec({...ed,bymTemperature:""===e.target.value?"inherit":Number(e.target.value)}),placeholder:"ç»§æ‰¿"}),(0,a.jsx)(F,{label:"æœ€å¤§Token",min:0,value:"inherit"===ed.bymMaxTokens?"":ed.bymMaxTokens,onChange:e=>ec({...ed,bymMaxTokens:""===e.target.value?"inherit":Number(e.target.value)}),placeholder:"ç»§æ‰¿"}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(r.Label,{className:"text-xs",children:"å›žå¤é•¿åº¦"}),(0,a.jsxs)(h.Select,{value:ed.bymReplyLength,onValueChange:e=>ec({...ed,bymReplyLength:e}),children:[(0,a.jsx)(h.SelectTrigger,{children:(0,a.jsx)(h.SelectValue,{})}),(0,a.jsxs)(h.SelectContent,{children:[(0,a.jsx)(h.SelectItem,{value:"short",children:"ç®€çŸ­"}),(0,a.jsx)(h.SelectItem,{value:"medium",children:"é€‚ä¸­"}),(0,a.jsx)(h.SelectItem,{value:"long",children:"è¯¦ç»†"})]})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(r.Label,{className:"text-sm",children:"ä½¿ç”¨è¡¨æƒ…"}),(0,a.jsx)(d.Switch,{checked:ed.bymUseEmoji,onCheckedChange:e=>ec({...ed,bymUseEmoji:e})})]})]}),(0,a.jsx)(B,{icon:(0,a.jsx)(w.Clock,{className:"h-4 w-4 text-blue-500"}),title:"ä¸»åŠ¨å‘è¨€",desc:"æ ¹æ®ç¾¤èŠå†…å®¹ä¸»åŠ¨å‚ä¸Žè®¨è®º",value:ed.proactiveChatEnabled,onChange:e=>ec({...ed,proactiveChatEnabled:e})}),"off"!==ed.proactiveChatEnabled&&(0,a.jsxs)("div",{className:"space-y-3 ml-4 pl-4 border-l-2 border-muted",children:[(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(r.Label,{className:"text-xs",children:"è§¦å‘æ¦‚çŽ‡"}),(0,a.jsx)(t.Button,{variant:"ghost",size:"sm",className:"h-6 text-xs px-2",onClick:()=>ec({...ed,proactiveChatProbability:"inherit"===ed.proactiveChatProbability?.05:"inherit"}),children:"inherit"===ed.proactiveChatProbability?"ç»§æ‰¿":"è‡ªå®šä¹‰"})]}),"inherit"!==ed.proactiveChatProbability&&(0,a.jsx)(H,{label:"",value:ed.proactiveChatProbability,onChange:e=>ec({...ed,proactiveChatProbability:e}),className:"pt-1"})]}),(0,a.jsx)(F,{label:"å†·å´æ—¶é—´(ç§’)",min:0,value:"inherit"===ed.proactiveChatCooldown?"":ed.proactiveChatCooldown,onChange:e=>ec({...ed,proactiveChatCooldown:""===e.target.value?"inherit":Number(e.target.value)}),placeholder:"ç»§æ‰¿"}),(0,a.jsx)(F,{label:"æ¯æ—¥ä¸Šé™",min:0,value:"inherit"===ed.proactiveChatMaxDaily?"":ed.proactiveChatMaxDaily,onChange:e=>ec({...ed,proactiveChatMaxDaily:""===e.target.value?"inherit":Number(e.target.value)}),placeholder:"ç»§æ‰¿"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-3 pt-2 border-t",children:[(0,a.jsx)(F,{label:"æœ€å°‘æ¶ˆæ¯æ•°",min:1,value:ed.proactiveChatMinMessages,onChange:e=>ec({...ed,proactiveChatMinMessages:parseInt(e.target.value)||5})}),(0,a.jsx)(F,{label:"å¼€å§‹æ—¶é—´",min:0,max:23,value:ed.proactiveChatTimeStart,onChange:e=>ec({...ed,proactiveChatTimeStart:parseInt(e.target.value)||8})}),(0,a.jsx)(F,{label:"ç»“æŸæ—¶é—´",min:0,max:23,value:ed.proactiveChatTimeEnd,onChange:e=>ec({...ed,proactiveChatTimeEnd:parseInt(e.target.value)||23})})]})]})]})]})}),(0,a.jsx)(m.TabsContent,{value:"game",className:"space-y-4",children:(0,a.jsxs)(s.Card,{children:[(0,a.jsxs)(s.CardHeader,{children:[(0,a.jsxs)(s.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(V.Gamepad2,{className:"h-4 w-4 text-green-500"}),"æ¸¸æˆæ¨¡å¼"]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Galgameç­‰äº’åŠ¨æ¸¸æˆçš„ç¾¤ç»„ç‹¬ç«‹é…ç½®"})]}),(0,a.jsxs)(s.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)(H,{label:"è§¦å‘æ¦‚çŽ‡",value:ed.gameProbability,onChange:e=>ec({...ed,gameProbability:e})}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(r.Label,{className:"text-xs",children:"æ¸¸æˆæ¨¡åž‹"}),(0,a.jsxs)(h.Select,{value:ed.gameModel,onValueChange:e=>ec({...ed,gameModel:e}),children:[(0,a.jsx)(h.SelectTrigger,{children:(0,a.jsx)(h.SelectValue,{placeholder:"ç»§æ‰¿å…¨å±€"})}),(0,a.jsxs)(h.SelectContent,{children:[(0,a.jsx)(h.SelectItem,{value:"",children:"ç»§æ‰¿å…¨å±€"}),ea.map(e=>(0,a.jsx)(h.SelectItem,{value:e,children:e},e))]})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)(F,{label:"æ¸©åº¦",min:0,max:2,step:.1,value:"inherit"===ed.gameTemperature?"":ed.gameTemperature,onChange:e=>ec({...ed,gameTemperature:e.target.value?parseFloat(e.target.value):"inherit"}),placeholder:"ç»§æ‰¿"}),(0,a.jsx)(F,{label:"æœ€å¤§Token",min:100,max:8e3,value:"inherit"===ed.gameMaxTokens?"":ed.gameMaxTokens,onChange:e=>ec({...ed,gameMaxTokens:e.target.value?parseInt(e.target.value):"inherit"}),placeholder:"ç»§æ‰¿"})]}),(0,a.jsx)(B,{icon:(0,a.jsx)(y.Zap,{className:"h-4 w-4 text-yellow-500"}),title:"å¯ç”¨å·¥å…·",desc:"å…è®¸æ¸¸æˆæ¨¡å¼ä½¿ç”¨MCPå·¥å…·",value:ed.gameEnableTools,onChange:e=>ec({...ed,gameEnableTools:e})})]})]})}),(0,a.jsxs)(m.TabsContent,{value:"channel",className:"space-y-4",children:[(0,a.jsxs)(s.Card,{children:[(0,a.jsx)(s.CardHeader,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(s.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(I.Server,{className:"h-4 w-4"}),"ç¾¤ç‹¬ç«‹æ¸ é“"]}),(0,a.jsxs)(t.Button,{size:"sm",onClick:()=>{en(null),eo({name:`æ¸ é“${ed.independentChannels.length+1}`,baseUrl:"",apiKey:"",adapterType:"openai",models:"",enabled:!0,priority:ed.independentChannels.length,modelsPath:"",chatPath:"",imageTransferMode:"auto",imageCompress:!0,imageQuality:85,imageMaxSize:4096}),es(!0)},children:[(0,a.jsx)(_.Plus,{className:"h-4 w-4 mr-1"}),"æ·»åŠ æ¸ é“"]})]})}),(0,a.jsxs)(s.CardContent,{className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"ä¸ºæœ¬ç¾¤é…ç½®ç‹¬ç«‹çš„APIæ¸ é“ï¼Œæ”¯æŒå¤šä¸ªæ¸ é“å’ŒèŽ·å–æ¨¡åž‹åˆ—è¡¨"}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border bg-muted/20",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 rounded-md bg-orange-500/10",children:(0,a.jsx)(I.Server,{className:"h-4 w-4 text-orange-500"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:"å¼ºåˆ¶ä½¿ç”¨æœ¬ç¾¤æ¸ é“"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"å¼€å¯åŽæœ¬ç¾¤å°†å®Œå…¨éš”ç¦»å…¨å±€æ¨¡åž‹ï¼Œä»…ä½¿ç”¨ä¸‹æ–¹ç‹¬ç«‹é…ç½®"})]})]}),(0,a.jsx)(d.Switch,{checked:ed.forbidGlobalModel,onCheckedChange:e=>ec({...ed,forbidGlobalModel:e})})]}),0===ed.independentChannels.length?(0,a.jsxs)("div",{className:"text-center py-8 text-muted-foreground border rounded-lg border-dashed",children:[(0,a.jsx)(I.Server,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),(0,a.jsx)("p",{children:"æš‚æ— ç‹¬ç«‹æ¸ é“"}),(0,a.jsx)("p",{className:"text-xs",children:"ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æ·»åŠ æ¸ é“"})]}):(0,a.jsx)("div",{className:"space-y-3",children:ed.independentChannels.map((e,i)=>(0,a.jsx)("div",{className:"p-4 rounded-lg border bg-card",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h4",{className:"font-medium",children:e.name}),(0,a.jsx)(o.Badge,{variant:e.enabled?"default":"secondary",children:e.enabled?"å¯ç”¨":"ç¦ç”¨"}),(0,a.jsx)(o.Badge,{variant:"outline",children:e.adapterType})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1 truncate",children:e.baseUrl||"ä½¿ç”¨é»˜è®¤åœ°å€"}),e.models.length>0&&(0,a.jsxs)("div",{className:"flex flex-wrap gap-1 mt-2",children:[e.models.slice(0,3).map(e=>(0,a.jsx)(o.Badge,{variant:"outline",className:"text-xs",children:e},e)),e.models.length>3&&(0,a.jsxs)(o.Badge,{variant:"outline",className:"text-xs",children:["+",e.models.length-3]})]})]}),(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)(t.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>{en(i),eo({name:e.name,baseUrl:e.baseUrl,apiKey:e.apiKey,adapterType:e.adapterType,models:e.models.join(", "),enabled:e.enabled,priority:e.priority,modelsPath:e.modelsPath||"",chatPath:e.chatPath||"",imageTransferMode:e.imageConfig?.transferMode||"auto",imageCompress:e.imageConfig?.compress??!0,imageQuality:e.imageConfig?.quality??85,imageMaxSize:e.imageConfig?.maxSize??4096}),es(!0)},children:(0,a.jsx)(p.Settings,{className:"h-4 w-4"})}),(0,a.jsx)(t.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive",onClick:()=>{ec({...ed,independentChannels:ed.independentChannels.filter((e,a)=>a!==i)})},children:(0,a.jsx)(G.Trash2,{className:"h-4 w-4"})})]})]})},e.id))})]})]}),(0,a.jsx)(O.ChannelDialog,{open:el,onOpenChange:es,channelForm:er,onChannelFormChange:eo,isEditing:null!==et,onSave:()=>{if(!er.name)return void b.toast.error("è¯·å¡«å†™æ¸ é“åç§°");let e={id:null!==et?ed.independentChannels[et].id:`ch_${Date.now()}`,name:er.name,baseUrl:er.baseUrl,apiKey:er.apiKey,adapterType:er.adapterType,models:er.models.split(",").map(e=>e.trim()).filter(Boolean),enabled:er.enabled,priority:er.priority,modelsPath:er.modelsPath||void 0,chatPath:er.chatPath||void 0,imageConfig:{transferMode:er.imageTransferMode,compress:er.imageCompress,quality:er.imageQuality,maxSize:er.imageMaxSize}};if(null!==et){let a=[...ed.independentChannels];a[et]=e,ec({...ed,independentChannels:a})}else ec({...ed,independentChannels:[...ed.independentChannels,e]});es(!1),b.toast.success(null!==et?"æ¸ é“å·²æ›´æ–°":"æ¸ é“å·²æ·»åŠ ")},onFetchModels:async()=>{if(!er.apiKey)return void b.toast.error("è¯·å…ˆå¡«å†™ API Key");try{let e=await U.channelsApi.fetchModels({adapterType:er.adapterType,baseUrl:er.baseUrl||"",apiKey:er.apiKey}),a=e?.data?.models||e?.models||[];if(!Array.isArray(a)||!(a.length>0))return b.toast.error("æœªèŽ·å–åˆ°æ¨¡åž‹åˆ—è¡¨"),[];{let e=a.map(e=>"string"==typeof e?e:e?.id||e?.name).filter(Boolean);return b.toast.success(`èŽ·å–åˆ° ${e.length} ä¸ªæ¨¡åž‹`),e}}catch(e){return b.toast.error(e.response?.data?.message||"èŽ·å–æ¨¡åž‹å¤±è´¥"),[]}}}),(0,a.jsxs)(s.Card,{children:[(0,a.jsx)(s.CardHeader,{children:(0,a.jsxs)(s.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(L.Gauge,{className:"h-4 w-4"}),"ä½¿ç”¨é™åˆ¶"]})}),(0,a.jsxs)(s.CardContent,{className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"è®¾ç½®æœ¬ç¾¤æ¯æ—¥ä½¿ç”¨æ¬¡æ•°é™åˆ¶ï¼ˆ0è¡¨ç¤ºæ— é™åˆ¶ï¼‰"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"ç¾¤æ¯æ—¥é™åˆ¶"}),(0,a.jsx)(n.Input,{type:"number",min:0,value:ed.dailyGroupLimit,onChange:e=>ec({...ed,dailyGroupLimit:parseInt(e.target.value)||0}),placeholder:"0 = æ— é™åˆ¶"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"ç”¨æˆ·æ¯æ—¥é™åˆ¶"}),(0,a.jsx)(n.Input,{type:"number",min:0,value:ed.dailyUserLimit,onChange:e=>ec({...ed,dailyUserLimit:parseInt(e.target.value)||0}),placeholder:"0 = æ— é™åˆ¶"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(r.Label,{children:"è¾¾åˆ°é™åˆ¶æ—¶çš„æç¤º"}),(0,a.jsx)(c.Textarea,{value:ed.usageLimitMessage,onChange:e=>ec({...ed,usageLimitMessage:e.target.value}),placeholder:"ä»Šæ—¥ä½¿ç”¨æ¬¡æ•°å·²è¾¾ä¸Šé™ï¼Œè¯·æ˜Žå¤©å†è¯•",rows:2})]})]})]})]}),(0,a.jsxs)(m.TabsContent,{value:"advanced",className:"space-y-4",children:[(0,a.jsxs)(s.Card,{children:[(0,a.jsx)(s.CardHeader,{children:(0,a.jsxs)(s.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(T.Bot,{className:"h-4 w-4"}),"æ¨¡åž‹é…ç½®"]})}),(0,a.jsxs)(s.CardContent,{className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"ä¸ºæœ¬ç¾¤é…ç½®å„åœºæ™¯ç‹¬ç«‹æ¨¡åž‹ï¼ˆç•™ç©ºä½¿ç”¨å…¨å±€é…ç½®ï¼‰"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsx)(Q,{label:"å¯¹è¯æ¨¡åž‹",value:ed.chatModel,models:ea,onChange:e=>ec({...ed,chatModel:e})}),(0,a.jsx)(Q,{label:"æ€»ç»“æ¨¡åž‹",value:ed.summaryModel,models:ea,onChange:e=>ec({...ed,summaryModel:e})}),(0,a.jsx)(Q,{label:"ä¼ªäººæ¨¡åž‹",value:ed.bymModel,models:ea,onChange:e=>ec({...ed,bymModel:e})}),(0,a.jsx)(Q,{label:"ç»˜å›¾æ¨¡åž‹",value:ed.imageGenModel,models:ea,onChange:e=>ec({...ed,imageGenModel:e})})]})]})]}),(0,a.jsxs)(s.Card,{children:[(0,a.jsx)(s.CardHeader,{children:(0,a.jsxs)(s.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,a.jsx)(v.BookOpen,{className:"h-4 w-4"}),"ç¾¤ç»„çŸ¥è¯†åº“"]})}),(0,a.jsxs)(s.CardContent,{className:"space-y-3",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"ä¸ºæœ¬ç¾¤é…ç½®ä¸“å±žçŸ¥è¯†åº“"}),ed.knowledgeIds.length>0&&(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:ed.knowledgeIds.map(e=>{let i=Y.find(a=>a.id===e);return(0,a.jsxs)(o.Badge,{variant:"secondary",className:"gap-1",children:[i?.name||e,(0,a.jsx)("button",{onClick:()=>ec({...ed,knowledgeIds:ed.knowledgeIds.filter(a=>a!==e)}),children:(0,a.jsx)(f.X,{className:"h-3 w-3"})})]},e)})}),(0,a.jsxs)(h.Select,{value:"",onValueChange:e=>e&&!ed.knowledgeIds.includes(e)&&ec({...ed,knowledgeIds:[...ed.knowledgeIds,e]}),children:[(0,a.jsx)(h.SelectTrigger,{children:(0,a.jsx)(h.SelectValue,{placeholder:"æ·»åŠ çŸ¥è¯†åº“..."})}),(0,a.jsx)(h.SelectContent,{children:Y.filter(e=>!ed.knowledgeIds.includes(e.id)).map(e=>(0,a.jsx)(h.SelectItem,{value:e.id,children:e.name},e.id))})]})]})]})]})]})]})}e.s(["GroupEditor",()=>$],5945)}]);