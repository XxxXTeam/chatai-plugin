(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,58088,e=>{"use strict";var s=e.i(52542),a=e.i(40418),l=e.i(44728),r=e.i(51200),t=e.i(30243),n=e.i(72029),i=e.i(99573),d=e.i(20308),c=e.i(81080),x=e.i(87126),o=e.i(59475),h=e.i(84519),m=e.i(20650),u=e.i(16195),j=e.i(10201),g=e.i(13107),p=e.i(74940),f=e.i(60713),b=e.i(17171);function v({value:e=[],onChange:l,placeholder:r="输入后按回车添加",className:i,disabled:d=!1,variant:c="secondary"}){let[x,o]=(0,a.useState)(""),h=()=>{let s=x.trim();s&&!e.includes(s)&&(l([...e,s]),o(""))};return(0,s.jsxs)("div",{className:(0,b.cn)("space-y-2",i),children:[(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:e.map(a=>(0,s.jsxs)(g.Badge,{variant:c,className:"gap-1 pr-1",children:[a,!d&&(0,s.jsx)("button",{type:"button",onClick:s=>{s.preventDefault(),s.stopPropagation(),l(e.filter(e=>e!==a))},className:"ml-1 rounded-full hover:bg-destructive/20 p-0.5",children:(0,s.jsx)(p.X,{className:"h-3 w-3 cursor-pointer hover:text-destructive"})})]},a))}),!d&&(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(t.Input,{value:x,onChange:e=>o(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),h())},placeholder:r,className:"flex-1"}),(0,s.jsx)(n.Button,{type:"button",variant:"outline",size:"icon",onClick:h,disabled:!x.trim(),children:(0,s.jsx)(f.Plus,{className:"h-4 w-4"})})]})]})}var C=e.i(23759),y=e.i(94518),N=e.i(21350),k=e.i(75979),w=e.i(79342),S=e.i(5850),L=e.i(89908),T=e.i(71355),I=e.i(97058),_=e.i(43939),P=e.i(84141),M=e.i(40204),A=e.i(96173),R=e.i(70620),F=e.i(83949),H=e.i(64775),D=e.i(15204),V=e.i(10273),E=e.i(48832);let O={basic:{commandPrefix:"#ai",debug:!1,showThinkingMessage:!0,debugToConsoleOnly:!0,quoteReply:!0,autoRecall:{enabled:!1,delay:60,recallError:!0}},admin:{loginNotifyPrivate:!0,sensitiveCommandMasterOnly:!0},llm:{defaultModel:"",models:{chat:"",tool:"",dispatch:"",image:"",draw:"",roleplay:"",search:""},fallback:{enabled:!1,models:[],maxRetries:3,retryDelay:500,notifyOnFallback:!1}},context:{maxMessages:20,autoEnd:{enabled:!1,maxRounds:50},groupContextSharing:!0,globalSystemPrompt:""},bym:{enable:!1,probability:.02,temperature:.9,maxTokens:100,recall:!1,model:"",presetId:"",systemPrompt:"",inheritPersonality:!0},tools:{showCallLogs:!0,useForwardMsg:!0,parallelExecution:!0,sendIntermediateReply:!0,useToolGroups:!1,dispatchFirst:!1},personality:{isolateContext:{enabled:!1,clearOnSwitch:!1}},thinking:{enabled:!0,showThinkingContent:!0,useForwardMsg:!0},features:{groupSummary:{enabled:!0,maxMessages:100,model:""},userPortrait:{enabled:!0,minMessages:10,model:""},poke:{enabled:!1,pokeBack:!1,message:"别戳了~",prompt:""},reaction:{enabled:!1,prompt:"",removePrompt:""},recall:{enabled:!1,aiResponse:!0,prompt:""},welcome:{enabled:!1,message:"",prompt:""},goodbye:{enabled:!1,aiResponse:!1,prompt:""},ban:{enabled:!1,aiResponse:!0,prompt:""},admin:{enabled:!1,prompt:""},luckyKing:{enabled:!1,congratulate:!1,prompt:""},honor:{enabled:!1,prompt:""},essence:{enabled:!1,prompt:""},imageGen:{enabled:!0,apis:[],model:"gemini-3-pro-image",videoModel:"veo-2.0-generate-001"},autoCleanOnError:{enabled:!1,notifyUser:!0}},memory:{enabled:!1,autoExtract:!0},trigger:{private:{enabled:!0,mode:"always"},group:{enabled:!0,at:!0,prefix:!0,keyword:!1,random:!1,randomRate:.05},prefixes:["#chat"],prefixPersonas:[],keywords:[],collectGroupMsg:!0,blacklistUsers:[],whitelistUsers:[],blacklistGroups:[],whitelistGroups:[]}},B={default:"默认模型",chat:"对话模型",tool:"工具模型",dispatch:"调度模型",image:"图像理解模型",draw:"绘图模型",roleplay:"伪人模型",search:"搜索模型",fallback:"备选模型"},G={default:"其他模型未配置时使用",chat:"普通对话，不传递工具",tool:"执行工具调用",dispatch:"选择工具组（轻量快速）",image:"分析理解图片内容",draw:"生成图片（如DALL-E）",roleplay:"伪人模式回复",search:"联网搜索",fallback:"主模型失败时使用"};function U(){var e;let f=(0,l.useSearchParams)(),b=f.get("tab")||"trigger",[U,K]=(0,a.useState)(b),[Q,z]=(0,a.useState)(null),[q,J]=(0,a.useState)(!0),[X,$]=(0,a.useState)(!1),[W,Y]=(0,a.useState)([]),[Z,ee]=(0,a.useState)([]),[es,ea]=(0,a.useState)(!1),[el,er]=(0,a.useState)([]),[et,en]=(0,a.useState)(!1),[ei,ed]=(0,a.useState)("chat"),[ec,ex]=(0,a.useState)([]),[eo,eh]=(0,a.useState)("idle"),em=(0,a.useRef)(!0),eu=(0,a.useRef)(null);(0,a.useEffect)(()=>{let e=f.get("tab");e&&K(e)},[f]);let ej=(0,a.useCallback)(async e=>{eu.current&&clearTimeout(eu.current),eu.current=setTimeout(async()=>{eh("saving");try{await k.configApi.update(e),eh("saved"),setTimeout(()=>eh("idle"),2e3)}catch(e){w.toast.error("自动保存失败"),console.error(e),eh("idle")}},800)},[]);(0,a.useEffect)(()=>{!em.current&&Q&&ej(Q)},[Q,ej]),(0,a.useEffect)(()=>{(async()=>{try{let[e,s,a]=await Promise.all([k.configApi.get(),k.channelsApi.list().catch(()=>({data:[]})),k.presetsApi.list().catch(()=>({data:[]}))]),l=e.data||{},r=JSON.parse(JSON.stringify(O)),t=(e,s)=>{Object.keys(s).forEach(a=>{s[a]&&"object"==typeof s[a]&&!Array.isArray(s[a])?(e[a]||(e[a]={}),t(e[a],s[a])):void 0!==s[a]&&(e[a]=s[a])})};t(r,l),r.llm||(r.llm={defaultModel:"",models:{},fallback:{enabled:!1,models:[],maxRetries:3,retryDelay:500,notifyOnFallback:!1}}),r.llm.models||(r.llm.models={chat:"",tool:"",dispatch:"",image:"",draw:"",roleplay:"",search:""}),r.llm.fallback||(r.llm.fallback={enabled:!1,models:[],maxRetries:3,retryDelay:500,notifyOnFallback:!1}),Array.isArray(r.trigger?.prefixPersonas)||(r.trigger.prefixPersonas=[]),r.llm?.fallback&&!Array.isArray(r.llm.fallback.models)&&(r.llm.fallback.models=[]),z(r),setTimeout(()=>{em.current=!1},100);let n=s?.data||[],i=new Set;n.forEach(e=>{Array.isArray(e.models)&&e.models.forEach(e=>i.add(e))});let d=Array.from(i).sort();Y(d),ee(d);let c=a?.data||[];er(c)}catch(e){w.toast.error("加载配置失败"),console.error(e)}finally{J(!1)}})()},[]);let eg=async()=>{ea(!0);try{let e=await k.channelsApi.list(),s=e?.data||[],a=new Set;s.forEach(e=>{Array.isArray(e.models)&&e.models.forEach(e=>a.add(e))});let l=Array.from(a).sort();ee(l),Y(l),w.toast.success(`获取到 ${l.length} 个模型`)}catch(e){w.toast.error("获取模型列表失败"),console.error(e)}finally{ea(!1)}},ep=e=>{if(!Q)return;ed(e);let s=[];if("default"===e)s=Q.llm?.defaultModel?[Q.llm.defaultModel]:[];else if("fallback"===e)s=Q.llm?.fallback?.models||[];else{let a=Q.llm?.models?.[e];s=a?[a]:[]}ex(s),en(!0)},ef=()=>"default"===ei||"chat"===ei||"tool"===ei||"dispatch"===ei||"image"===ei||"roleplay"===ei||"search"===ei,eb=async()=>{if(Q){$(!0);try{await k.configApi.update(Q),eh("saved"),w.toast.success("配置已保存"),setTimeout(()=>eh("idle"),2e3)}catch(e){w.toast.error("保存失败"),console.error(e)}finally{$(!1)}}},ev=(e,s)=>{if(!Q)return;let a=e.split("."),l=JSON.parse(JSON.stringify(Q)),r=l;for(let e=0;e<a.length-1;e++)(void 0===r[a[e]]||null===r[a[e]])&&(r[a[e]]={}),r=r[a[e]];r[a[a.length-1]]=s,z(l)};return q?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)(x.Skeleton,{className:"h-10 w-48"}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsx)(x.Skeleton,{className:"h-6 w-32"})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsx)(x.Skeleton,{className:"h-10 w-full"}),(0,s.jsx)(x.Skeleton,{className:"h-10 w-full"})]})]})]}):Q?(0,s.jsxs)(N.PageContainer,{children:[(0,s.jsx)(N.PageHeader,{title:"系统设置",description:"配置插件的核心功能和行为",icon:M.Settings,actions:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("span",{className:"text-sm text-muted-foreground hidden sm:inline-flex items-center",children:["saving"===eo&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(L.Loader2,{className:"h-4 w-4 animate-spin mr-1"}),"保存中"]}),"saved"===eo&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(P.Check,{className:"h-4 w-4 text-green-500 mr-1"}),"已保存"]}),"idle"===eo&&"自动保存"]}),(0,s.jsxs)(n.Button,{onClick:eb,disabled:X,size:"sm",children:[X?(0,s.jsx)(L.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):(0,s.jsx)(S.Save,{className:"mr-2 h-4 w-4"}),"保存"]})]})}),(0,s.jsxs)(c.Tabs,{value:U,onValueChange:K,className:"w-full",children:[(0,s.jsxs)(c.TabsList,{className:"w-full justify-start flex-wrap h-auto gap-1.5 bg-muted/50 p-1.5 rounded-xl mb-4",children:[(0,s.jsxs)(c.TabsTrigger,{value:"trigger",className:"data-[state=active]:bg-background data-[state=active]:shadow-sm rounded-lg px-3 py-1.5 text-sm transition-all",children:[(0,s.jsx)(A.Zap,{className:"h-4 w-4 mr-1.5"}),"触发"]}),(0,s.jsxs)(c.TabsTrigger,{value:"basic",className:"data-[state=active]:bg-background data-[state=active]:shadow-sm rounded-lg px-3 py-1.5 text-sm transition-all",children:[(0,s.jsx)(M.Settings,{className:"h-4 w-4 mr-1.5"}),"基础"]}),(0,s.jsxs)(c.TabsTrigger,{value:"admin",className:"data-[state=active]:bg-background data-[state=active]:shadow-sm rounded-lg px-3 py-1.5 text-sm transition-all",children:[(0,s.jsx)(E.Shield,{className:"h-4 w-4 mr-1.5"}),"管理"]}),(0,s.jsxs)(c.TabsTrigger,{value:"llm",className:"data-[state=active]:bg-background data-[state=active]:shadow-sm rounded-lg px-3 py-1.5 text-sm transition-all",children:[(0,s.jsx)(R.Bot,{className:"h-4 w-4 mr-1.5"}),"模型"]}),(0,s.jsxs)(c.TabsTrigger,{value:"bym",className:"data-[state=active]:bg-background data-[state=active]:shadow-sm rounded-lg px-3 py-1.5 text-sm transition-all",children:[(0,s.jsx)(V.MessageSquare,{className:"h-4 w-4 mr-1.5"}),"伪人"]}),(0,s.jsxs)(c.TabsTrigger,{value:"tools",className:"data-[state=active]:bg-background data-[state=active]:shadow-sm rounded-lg px-3 py-1.5 text-sm transition-all",children:[(0,s.jsx)(F.Wrench,{className:"h-4 w-4 mr-1.5"}),"工具"]}),(0,s.jsxs)(c.TabsTrigger,{value:"thinking",className:"data-[state=active]:bg-background data-[state=active]:shadow-sm rounded-lg px-3 py-1.5 text-sm transition-all",children:[(0,s.jsx)(H.Brain,{className:"h-4 w-4 mr-1.5"}),"思考"]}),(0,s.jsxs)(c.TabsTrigger,{value:"features",className:"data-[state=active]:bg-background data-[state=active]:shadow-sm rounded-lg px-3 py-1.5 text-sm transition-all",children:[(0,s.jsx)(D.Sparkles,{className:"h-4 w-4 mr-1.5"}),"高级"]})]}),(0,s.jsxs)(c.TabsContent,{value:"trigger",className:"space-y-4",children:[(0,s.jsxs)(u.Alert,{children:[(0,s.jsx)(T.Info,{className:"h-4 w-4"}),(0,s.jsx)(u.AlertDescription,{children:"配置机器人何时响应消息。私聊和群聊可独立配置触发方式。"})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsx)(r.CardTitle,{children:"私聊触发"})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(i.Label,{children:"响应私聊"}),(0,s.jsx)(d.Switch,{checked:Q.trigger?.private?.enabled??!0,onCheckedChange:e=>ev("trigger.private.enabled",e)})]}),Q.trigger?.private?.enabled&&(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"私聊模式"}),(0,s.jsxs)(j.Select,{value:Q.trigger?.private?.mode||"always",onValueChange:e=>ev("trigger.private.mode",e),children:[(0,s.jsx)(j.SelectTrigger,{children:(0,s.jsx)(j.SelectValue,{})}),(0,s.jsxs)(j.SelectContent,{children:[(0,s.jsx)(j.SelectItem,{value:"always",children:"总是响应"}),(0,s.jsx)(j.SelectItem,{value:"prefix",children:"需要前缀"}),(0,s.jsx)(j.SelectItem,{value:"off",children:"关闭"})]})]})]})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsx)(r.CardTitle,{children:"群聊触发"})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(i.Label,{children:"响应群聊"}),(0,s.jsx)(d.Switch,{checked:Q.trigger?.group?.enabled??!0,onCheckedChange:e=>ev("trigger.group.enabled",e)})]}),Q.trigger?.group?.enabled&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(i.Label,{children:"@机器人触发"}),(0,s.jsx)(d.Switch,{checked:Q.trigger?.group?.at??!0,onCheckedChange:e=>ev("trigger.group.at",e)})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(i.Label,{children:"前缀触发"}),(0,s.jsx)(d.Switch,{checked:Q.trigger?.group?.prefix??!0,onCheckedChange:e=>ev("trigger.group.prefix",e)})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(i.Label,{children:"关键词触发"}),(0,s.jsx)(d.Switch,{checked:Q.trigger?.group?.keyword??!1,onCheckedChange:e=>ev("trigger.group.keyword",e)})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"随机触发"}),Q.trigger?.group?.random&&(0,s.jsxs)("span",{className:"ml-2 text-sm text-muted-foreground",children:[(100*(Q.trigger?.group?.randomRate||.05)).toFixed(0),"%"]})]}),(0,s.jsx)(d.Switch,{checked:Q.trigger?.group?.random??!1,onCheckedChange:e=>ev("trigger.group.random",e)})]}),Q.trigger?.group?.random&&(0,s.jsx)(h.Slider,{value:[Q.trigger?.group?.randomRate||.05],min:0,max:.5,step:.01,onValueChange:e=>ev("trigger.group.randomRate",e[0])})]})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsx)(r.CardTitle,{children:"触发词"})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{children:"触发前缀"}),(0,s.jsx)(v,{value:Q.trigger?.prefixes||[],onChange:e=>ev("trigger.prefixes",e),placeholder:"输入前缀后按回车，如: #chat"})]}),Q.trigger?.group?.keyword&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{children:"触发关键词"}),(0,s.jsx)(v,{value:Q.trigger?.keywords||[],onChange:e=>ev("trigger.keywords",e),placeholder:"消息包含这些词时触发"})]})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsxs)(r.CardHeader,{children:[(0,s.jsx)(r.CardTitle,{children:"前缀人格"}),(0,s.jsx)(r.CardDescription,{children:"为不同的触发前缀绑定不同的预设人格"})]}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(Q.trigger?.prefixPersonas||[]).map((e,a)=>(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,s.jsx)(t.Input,{value:e.prefix,onChange:e=>{let s=[...Q.trigger?.prefixPersonas||[]];s[a]={...s[a],prefix:e.target.value},ev("trigger.prefixPersonas",s)},placeholder:"前缀，如: #猫娘",className:"flex-1"}),(0,s.jsx)(t.Input,{value:e.preset,onChange:e=>{let s=[...Q.trigger?.prefixPersonas||[]];s[a]={...s[a],preset:e.target.value},ev("trigger.prefixPersonas",s)},placeholder:"预设名称",className:"flex-1"}),(0,s.jsx)(n.Button,{variant:"ghost",size:"icon",onClick:()=>{ev("trigger.prefixPersonas",(Q.trigger?.prefixPersonas||[]).filter((e,s)=>s!==a))},children:(0,s.jsx)(p.X,{className:"h-4 w-4"})})]},a)),(0,s.jsx)(n.Button,{variant:"outline",size:"sm",onClick:()=>{ev("trigger.prefixPersonas",[...Q.trigger?.prefixPersonas||[],{prefix:"",preset:""}])},children:"添加前缀人格"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"使用特定前缀触发时，会自动切换到对应的预设人格"})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsx)(r.CardTitle,{children:"访问控制"})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{children:"群白名单"}),(0,s.jsx)(v,{value:Q.trigger?.whitelistGroups||[],onChange:e=>ev("trigger.whitelistGroups",e),placeholder:"群号"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{children:"群黑名单"}),(0,s.jsx)(v,{value:Q.trigger?.blacklistGroups||[],onChange:e=>ev("trigger.blacklistGroups",e),placeholder:"群号",variant:"destructive"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{children:"用户白名单"}),(0,s.jsx)(v,{value:Q.trigger?.whitelistUsers||[],onChange:e=>ev("trigger.whitelistUsers",e),placeholder:"QQ号"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{children:"用户黑名单"}),(0,s.jsx)(v,{value:Q.trigger?.blacklistUsers||[],onChange:e=>ev("trigger.blacklistUsers",e),placeholder:"QQ号",variant:"destructive"})]})]}),(0,s.jsx)(o.Separator,{}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"采集群消息"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"用于记忆和上下文分析"})]}),(0,s.jsx)(d.Switch,{checked:Q.trigger?.collectGroupMsg??!0,onCheckedChange:e=>ev("trigger.collectGroupMsg",e)})]})]})]})]}),(0,s.jsx)(c.TabsContent,{value:"basic",className:"space-y-4",children:(0,s.jsxs)(r.Card,{children:[(0,s.jsxs)(r.CardHeader,{children:[(0,s.jsx)(r.CardTitle,{children:"基础配置"}),(0,s.jsx)(r.CardDescription,{children:"插件基础功能设置"})]}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"命令前缀"}),(0,s.jsx)(t.Input,{value:Q.basic?.commandPrefix||"#ai",onChange:e=>ev("basic.commandPrefix",e.target.value),placeholder:"#ai"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"管理命令的前缀，如 #ai帮助、#ai状态 等"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"思考提示"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:'AI处理时发送"思考中..."提示'})]}),(0,s.jsx)(d.Switch,{checked:Q.basic?.showThinkingMessage??!0,onCheckedChange:e=>ev("basic.showThinkingMessage",e)})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"引用回复"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"AI回复会引用触发消息"})]}),(0,s.jsx)(d.Switch,{checked:Q.basic?.quoteReply??!0,onCheckedChange:e=>ev("basic.quoteReply",e)})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(i.Label,{children:"调试模式"}),(0,s.jsx)(d.Switch,{checked:Q.basic?.debug??!1,onCheckedChange:e=>ev("basic.debug",e)})]}),Q.basic?.debug&&(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(i.Label,{children:"调试仅控制台"}),(0,s.jsx)(d.Switch,{checked:Q.basic?.debugToConsoleOnly??!0,onCheckedChange:e=>ev("basic.debugToConsoleOnly",e)})]}),(0,s.jsx)(o.Separator,{}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"自动撤回"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"自动撤回AI回复消息"})]}),(0,s.jsx)(d.Switch,{checked:Q.basic?.autoRecall?.enabled??!1,onCheckedChange:e=>ev("basic.autoRecall.enabled",e)})]}),Q.basic?.autoRecall?.enabled&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"撤回延迟（秒）"}),(0,s.jsx)(t.Input,{type:"number",value:Q.basic?.autoRecall?.delay||60,onChange:e=>ev("basic.autoRecall.delay",parseInt(e.target.value))})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(i.Label,{children:"撤回错误消息"}),(0,s.jsx)(d.Switch,{checked:Q.basic?.autoRecall?.recallError??!0,onCheckedChange:e=>ev("basic.autoRecall.recallError",e)})]})]})]})]})}),(0,s.jsx)(c.TabsContent,{value:"admin",className:"space-y-4",children:(0,s.jsxs)(r.Card,{children:[(0,s.jsxs)(r.CardHeader,{children:[(0,s.jsx)(r.CardTitle,{children:"管理配置"}),(0,s.jsx)(r.CardDescription,{children:"管理员和权限设置"})]}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)(u.Alert,{children:[(0,s.jsx)(T.Info,{className:"h-4 w-4"}),(0,s.jsxs)(u.AlertDescription,{children:["主人列表使用 Yunzai 框架配置，请编辑"," ",(0,s.jsx)("code",{className:"bg-muted px-1 rounded",children:"config/config/other.yaml"})," 中的"," ",(0,s.jsx)("code",{className:"bg-muted px-1 rounded",children:"masterQQ"})," 字段。 更多权限设置请前往"," ",(0,s.jsx)("a",{href:"/permissions",className:"text-primary underline",children:"权限管理"})," ","页面。"]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"登录链接私聊推送"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"群聊中触发管理面板命令时私聊推送登录链接"})]}),(0,s.jsx)(d.Switch,{checked:Q.admin?.loginNotifyPrivate??!0,onCheckedChange:e=>ev("admin.loginNotifyPrivate",e)})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"敏感命令仅主人"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"敏感命令（如管理面板）仅限主人使用"})]}),(0,s.jsx)(d.Switch,{checked:Q.admin?.sensitiveCommandMasterOnly??!0,onCheckedChange:e=>ev("admin.sensitiveCommandMasterOnly",e)})]})]})]})}),(0,s.jsxs)(c.TabsContent,{value:"llm",className:"space-y-4",children:[(0,s.jsxs)(r.Card,{children:[(0,s.jsxs)(r.CardHeader,{children:[(0,s.jsx)(r.CardTitle,{children:"模型配置"}),(0,s.jsx)(r.CardDescription,{children:"模型选择和映射设置"})]}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)(i.Label,{children:"可用模型"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"从已配置的渠道获取模型列表"})]}),(0,s.jsxs)(n.Button,{variant:"outline",size:"sm",onClick:eg,disabled:es,children:[es?(0,s.jsx)(L.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):(0,s.jsx)(I.RefreshCw,{className:"mr-2 h-4 w-4"}),"获取模型 (",Z.length,")"]})]}),(0,s.jsx)(o.Separator,{}),(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)(i.Label,{children:"默认模型"}),(0,s.jsx)("div",{className:"flex items-center gap-2 mt-1",children:Q.llm?.defaultModel?(0,s.jsx)(g.Badge,{variant:"secondary",children:Q.llm.defaultModel}):(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"未配置"})}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"未配置分类模型时使用的默认模型"})]}),(0,s.jsxs)(n.Button,{variant:"outline",size:"sm",onClick:()=>ep("default"),disabled:0===Z.length,children:[(0,s.jsx)(_.Settings2,{className:"mr-2 h-4 w-4"}),"配置"]})]})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsxs)(r.CardHeader,{children:[(0,s.jsx)(r.CardTitle,{className:"text-base",children:"模型分类"}),(0,s.jsx)(r.CardDescription,{children:"为不同场景配置专用模型（同一模型配置多个渠道时自动轮询）"})]}),(0,s.jsx)(r.CardContent,{className:"space-y-3",children:["chat","tool","dispatch","image","draw","roleplay","search"].map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:B[e]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:G[e]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:Q.llm?.models?.[e]||"使用默认模型"})]}),(0,s.jsxs)(n.Button,{variant:"outline",size:"sm",onClick:()=>ep(e),disabled:0===Z.length,children:[(0,s.jsx)(_.Settings2,{className:"mr-2 h-4 w-4"}),"配置"]})]},e))})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsxs)(r.CardHeader,{children:[(0,s.jsx)(r.CardTitle,{className:"text-base",children:"备选模型轮询"}),(0,s.jsx)(r.CardDescription,{children:"当主模型失败时自动切换到备选模型"})]}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"启用备选模型"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"主模型调用失败时自动尝试备选模型"})]}),(0,s.jsx)(d.Switch,{checked:Q.llm?.fallback?.enabled??!1,onCheckedChange:e=>ev("llm.fallback.enabled",e)})]}),Q.llm?.fallback?.enabled&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"备选模型列表"}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-1 mt-1",children:[(Q.llm?.fallback?.models||[]).slice(0,3).map(e=>(0,s.jsx)(g.Badge,{variant:"secondary",className:"text-xs",children:e},e)),(Q.llm?.fallback?.models?.length||0)>3&&(0,s.jsxs)(g.Badge,{variant:"outline",className:"text-xs",children:["+",(Q.llm?.fallback?.models?.length||0)-3]}),!Q.llm?.fallback?.models?.length&&(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:"未配置备选模型"})]})]}),(0,s.jsxs)(n.Button,{variant:"outline",size:"sm",onClick:()=>ep("fallback"),disabled:0===Z.length,children:[(0,s.jsx)(_.Settings2,{className:"mr-2 h-4 w-4"}),"配置 (",(e="fallback",Q&&Q.llm?.fallback?.models?.length||0),")"]})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"最大重试次数"}),(0,s.jsx)(t.Input,{type:"number",value:Q.llm?.fallback?.maxRetries||3,onChange:e=>ev("llm.fallback.maxRetries",parseInt(e.target.value)),min:1,max:10})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"重试延迟 (ms)"}),(0,s.jsx)(t.Input,{type:"number",value:Q.llm?.fallback?.retryDelay||500,onChange:e=>ev("llm.fallback.retryDelay",parseInt(e.target.value)),min:0,step:100})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"切换通知"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"切换到备选模型时通知用户"})]}),(0,s.jsx)(d.Switch,{checked:Q.llm?.fallback?.notifyOnFallback??!1,onCheckedChange:e=>ev("llm.fallback.notifyOnFallback",e)})]})]})]})]})]}),(0,s.jsxs)(c.TabsContent,{value:"bym",className:"space-y-4",children:[(0,s.jsxs)(r.Card,{children:[(0,s.jsxs)(r.CardHeader,{children:[(0,s.jsx)(r.CardTitle,{children:"伪人模式"}),(0,s.jsx)(r.CardDescription,{children:"随机模拟真人回复，使机器人更像真人"})]}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"启用伪人模式"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"AI回复更像真人"})]}),(0,s.jsx)(d.Switch,{checked:Q.bym?.enable??!1,onCheckedChange:e=>ev("bym.enable",e)})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)(i.Label,{children:"触发概率"}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:[((Q.bym?.probability??.02)*100).toFixed(0),"%"]})]}),(0,s.jsx)(h.Slider,{value:[Q.bym?.probability??.02],min:.01,max:1,step:.01,onValueChange:e=>ev("bym.probability",e[0])}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"全局默认概率，群组可继承此值"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)(i.Label,{children:"回复温度"}),(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:Q.bym?.temperature||.9})]}),(0,s.jsx)(h.Slider,{value:[Q.bym?.temperature||.9],min:0,max:2,step:.1,onValueChange:e=>ev("bym.temperature",e[0])})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"最大Token"}),(0,s.jsx)(t.Input,{type:"number",value:Q.bym?.maxTokens||100,onChange:e=>ev("bym.maxTokens",parseInt(e.target.value))})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(i.Label,{children:"启用记忆"}),(0,s.jsx)(d.Switch,{checked:Q.bym?.recall??!1,onCheckedChange:e=>ev("bym.recall",e)})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"使用模型"}),(0,s.jsxs)(j.Select,{value:Q.bym?.model||"__default__",onValueChange:e=>ev("bym.model","__default__"===e?"":e),children:[(0,s.jsx)(j.SelectTrigger,{children:(0,s.jsx)(j.SelectValue,{placeholder:"使用默认模型"})}),(0,s.jsxs)(j.SelectContent,{className:"max-h-[200px] overflow-y-auto",children:[(0,s.jsx)(j.SelectItem,{value:"__default__",children:"使用默认模型"}),W.map(e=>(0,s.jsx)(j.SelectItem,{value:e,children:e},e))]})]})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"伪人预设"}),(0,s.jsxs)(j.Select,{value:Q.bym?.presetId||"__default__",onValueChange:e=>ev("bym.presetId","__default__"===e?"":e),children:[(0,s.jsx)(j.SelectTrigger,{children:(0,s.jsx)(j.SelectValue,{placeholder:"选择预设..."})}),(0,s.jsxs)(j.SelectContent,{className:"max-h-[200px] overflow-y-auto",children:[(0,s.jsx)(j.SelectItem,{value:"__default__",children:"使用默认人设"}),el.map(e=>(0,s.jsx)(j.SelectItem,{value:e.id,children:e.name},e.id))]})]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"选择预设后将覆盖下方的系统提示词"})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"系统提示词"}),(0,s.jsx)(m.Textarea,{value:Q.bym?.systemPrompt||"",onChange:e=>ev("bym.systemPrompt",e.target.value),placeholder:"伪人模式的系统提示词（选择预设后此项无效）",rows:3})]})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsxs)(r.CardHeader,{children:[(0,s.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(D.Sparkles,{className:"h-4 w-4"}),"主动聊天",(0,s.jsx)(g.Badge,{variant:"secondary",className:"text-xs",children:"伪人扩展"})]}),(0,s.jsx)(r.CardDescription,{children:"让机器人在群聊中随机主动发言，根据聊天内容自然参与讨论"})]}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"启用主动聊天"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"允许机器人在群聊中主动发言"})]}),(0,s.jsx)(d.Switch,{checked:Q?.proactiveChat?.enabled??!1,onCheckedChange:e=>ev("proactiveChat.enabled",e)})]}),Q?.proactiveChat?.enabled&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.Separator,{}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{className:"text-xs",children:"轮询间隔(分钟)"}),(0,s.jsx)(t.Input,{type:"number",min:1,max:60,value:Q?.proactiveChat?.pollInterval??5,onChange:e=>ev("proactiveChat.pollInterval",parseInt(e.target.value))})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{className:"text-xs",children:"冷却时间(分钟)"}),(0,s.jsx)(t.Input,{type:"number",min:1,max:1440,value:Q?.proactiveChat?.cooldownMinutes??30,onChange:e=>ev("proactiveChat.cooldownMinutes",parseInt(e.target.value))})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{className:"text-xs",children:"每日最大次数"}),(0,s.jsx)(t.Input,{type:"number",min:1,max:100,value:Q?.proactiveChat?.maxDailyMessages??20,onChange:e=>ev("proactiveChat.maxDailyMessages",parseInt(e.target.value))})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{className:"text-xs",children:"最少消息数"}),(0,s.jsx)(t.Input,{type:"number",min:1,max:100,value:Q?.proactiveChat?.minMessagesBeforeTrigger??10,onChange:e=>ev("proactiveChat.minMessagesBeforeTrigger",parseInt(e.target.value))})]})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)(i.Label,{className:"text-xs",children:"基础触发概率"}),(0,s.jsxs)("span",{className:"text-xs text-muted-foreground",children:[Math.round((Q?.proactiveChat?.baseProbability??.05)*100),"%"]})]}),(0,s.jsx)(h.Slider,{value:[Q?.proactiveChat?.baseProbability??.05],onValueChange:([e])=>ev("proactiveChat.baseProbability",e),min:0,max:.5,step:.01})]})]})]})]})]}),(0,s.jsxs)(c.TabsContent,{value:"tools",className:"space-y-4",children:[(0,s.jsxs)(r.Card,{children:[(0,s.jsxs)(r.CardHeader,{children:[(0,s.jsx)(r.CardTitle,{children:"工具调用配置"}),(0,s.jsx)(r.CardDescription,{children:"配置AI工具调用的行为"})]}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"显示调用日志"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"显示工具调用的详细日志"})]}),(0,s.jsx)(d.Switch,{checked:Q.tools?.showCallLogs??!0,onCheckedChange:e=>ev("tools.showCallLogs",e)})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"日志合并转发"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"工具调用日志使用合并转发发送"})]}),(0,s.jsx)(d.Switch,{checked:Q.tools?.useForwardMsg??!0,onCheckedChange:e=>ev("tools.useForwardMsg",e)})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"并行执行"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"多个无依赖的工具调用会并行执行"})]}),(0,s.jsx)(d.Switch,{checked:Q.tools?.parallelExecution??!0,onCheckedChange:e=>ev("tools.parallelExecution",e)})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"发送中间回复"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"工具调用前先发送模型的文本回复"})]}),(0,s.jsx)(d.Switch,{checked:Q.tools?.sendIntermediateReply??!0,onCheckedChange:e=>ev("tools.sendIntermediateReply",e)})]})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsxs)(r.CardHeader,{children:[(0,s.jsx)(r.CardTitle,{children:"工具组调度"}),(0,s.jsx)(r.CardDescription,{children:"使用调度模型选择工具组，减少上下文消耗"})]}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"启用工具组模式"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"将工具按功能分组，调度时只传组摘要"})]}),(0,s.jsx)(d.Switch,{checked:Q.tools?.useToolGroups??!1,onCheckedChange:e=>ev("tools.useToolGroups",e)})]}),Q.tools?.useToolGroups&&(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"调度优先"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"先用调度模型选择工具组，再用工具模型执行"})]}),(0,s.jsx)(d.Switch,{checked:Q.tools?.dispatchFirst??!1,onCheckedChange:e=>ev("tools.dispatchFirst",e)})]}),Q.tools?.useToolGroups&&(0,s.jsxs)(u.Alert,{children:[(0,s.jsx)(T.Info,{className:"h-4 w-4"}),(0,s.jsx)(u.AlertDescription,{children:"工具组配置请在「MCP工具」页面管理。调度模型和工具模型请在上方「模型」标签页配置。"})]})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsxs)(r.CardHeader,{children:[(0,s.jsx)(r.CardTitle,{children:"人格上下文"}),(0,s.jsx)(r.CardDescription,{children:"配置独立人格的上下文隔离行为"})]}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"独立上下文"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"不同人格的对话历史相互独立"})]}),(0,s.jsx)(d.Switch,{checked:Q.personality?.isolateContext?.enabled??!1,onCheckedChange:e=>ev("personality.isolateContext.enabled",e)})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"切换时清除"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"切换人格时清除原人格的上下文"})]}),(0,s.jsx)(d.Switch,{checked:Q.personality?.isolateContext?.clearOnSwitch??!1,onCheckedChange:e=>ev("personality.isolateContext.clearOnSwitch",e),disabled:!Q.personality?.isolateContext?.enabled})]})]})]})]}),(0,s.jsx)(c.TabsContent,{value:"thinking",className:"space-y-4",children:(0,s.jsxs)(r.Card,{children:[(0,s.jsxs)(r.CardHeader,{children:[(0,s.jsx)(r.CardTitle,{children:"深度思考"}),(0,s.jsx)(r.CardDescription,{children:"配置AI思考过程的显示和适配"})]}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"启用思考适配"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"开启后会解析和处理模型的思考内容 (如 reasoning_content 或 <think> 标签)"})]}),(0,s.jsx)(d.Switch,{checked:Q.thinking?.enabled??!0,onCheckedChange:e=>ev("thinking.enabled",e)})]}),(0,s.jsx)(o.Separator,{}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"显示思考内容"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:Q.thinking?.enabled?"显示AI的思考过程":"需先启用思考适配"})]}),(0,s.jsx)(d.Switch,{checked:Q.thinking?.showThinkingContent??!0,onCheckedChange:e=>ev("thinking.showThinkingContent",e)})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"思考合并转发"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:Q.thinking?.enabled?"思考内容使用合并转发发送":"需先启用思考适配"})]}),(0,s.jsx)(d.Switch,{checked:Q.thinking?.useForwardMsg??!0,onCheckedChange:e=>ev("thinking.useForwardMsg",e)})]}),!Q.thinking?.enabled&&(0,s.jsxs)(u.Alert,{children:[(0,s.jsx)(T.Info,{className:"h-4 w-4"}),(0,s.jsx)(u.AlertDescription,{children:'思考适配已关闭，上方的显示和转发设置将不会生效。如需显示思考内容，请先开启"启用思考适配"。'})]})]})]})}),(0,s.jsxs)(c.TabsContent,{value:"features",className:"space-y-4",children:[(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsx)(r.CardTitle,{children:"群聊总结"})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(i.Label,{children:"启用"}),(0,s.jsx)(d.Switch,{checked:Q.features?.groupSummary?.enabled??!0,onCheckedChange:e=>ev("features.groupSummary.enabled",e)})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"最大消息数"}),(0,s.jsx)(t.Input,{type:"number",value:Q.features?.groupSummary?.maxMessages||100,onChange:e=>ev("features.groupSummary.maxMessages",parseInt(e.target.value))}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"总结时分析的最大消息数量"})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"总结模型"}),(0,s.jsxs)(j.Select,{value:Q.features?.groupSummary?.model||"__default__",onValueChange:e=>ev("features.groupSummary.model","__default__"===e?"":e),children:[(0,s.jsx)(j.SelectTrigger,{children:(0,s.jsx)(j.SelectValue,{placeholder:"使用默认模型"})}),(0,s.jsxs)(j.SelectContent,{className:"max-h-[200px] overflow-y-auto",children:[(0,s.jsx)(j.SelectItem,{value:"__default__",children:"使用默认模型"}),W.map(e=>(0,s.jsx)(j.SelectItem,{value:e,children:e},e))]})]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"指定用于群聊总结的模型"})]})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsx)(r.CardTitle,{children:"个人画像"})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(i.Label,{children:"启用"}),(0,s.jsx)(d.Switch,{checked:Q.features?.userPortrait?.enabled??!0,onCheckedChange:e=>ev("features.userPortrait.enabled",e)})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"最少消息数"}),(0,s.jsx)(t.Input,{type:"number",value:Q.features?.userPortrait?.minMessages||10,onChange:e=>ev("features.userPortrait.minMessages",parseInt(e.target.value))}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"生成画像需要的最少消息数量"})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"画像模型"}),(0,s.jsxs)(j.Select,{value:Q.features?.userPortrait?.model||"__default__",onValueChange:e=>ev("features.userPortrait.model","__default__"===e?"":e),children:[(0,s.jsx)(j.SelectTrigger,{children:(0,s.jsx)(j.SelectValue,{placeholder:"使用默认模型"})}),(0,s.jsxs)(j.SelectContent,{className:"max-h-[200px] overflow-y-auto",children:[(0,s.jsx)(j.SelectItem,{value:"__default__",children:"使用默认模型"}),W.map(e=>(0,s.jsx)(j.SelectItem,{value:e,children:e},e))]})]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"指定用于生成用户画像的模型"})]})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsx)(r.CardTitle,{children:"戳一戳响应"})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"启用"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"被戳时使用AI人设回复"})]}),(0,s.jsx)(d.Switch,{checked:Q.features?.poke?.enabled??!1,onCheckedChange:e=>ev("features.poke.enabled",e)})]}),Q.features?.poke?.enabled&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(i.Label,{children:"响应概率"}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:[Math.round((Q.features?.poke?.probability??1)*100),"%"]})]}),(0,s.jsx)(h.Slider,{value:[Q.features?.poke?.probability??1],onValueChange:([e])=>ev("features.poke.probability",e),min:0,max:1,step:.05}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"全局默认概率，群组可覆盖"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(i.Label,{children:"自动回戳"}),(0,s.jsx)(d.Switch,{checked:Q.features?.poke?.pokeBack??!1,onCheckedChange:e=>ev("features.poke.pokeBack",e)})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"备用回复"}),(0,s.jsx)(t.Input,{value:Q.features?.poke?.message||"",onChange:e=>ev("features.poke.message",e.target.value),placeholder:"AI回复失败时的备用回复"})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"自定义提示词"}),(0,s.jsx)(m.Textarea,{value:Q.features?.poke?.prompt||"",onChange:e=>ev("features.poke.prompt",e.target.value),placeholder:"[事件通知] {nickname} 戳了你一下。请根据你的人设性格，给出一个简短自然的回应。",rows:2}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["支持占位符: ","{nickname}"," - 用户昵称"]})]})]})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsx)(r.CardTitle,{children:"表情回应"})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"启用"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"收到表情回应时使用AI人设处理"})]}),(0,s.jsx)(d.Switch,{checked:Q.features?.reaction?.enabled??!1,onCheckedChange:e=>ev("features.reaction.enabled",e)})]}),Q.features?.reaction?.enabled&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"添加回应提示词"}),(0,s.jsx)(m.Textarea,{value:Q.features?.reaction?.prompt||"",onChange:e=>ev("features.reaction.prompt",e.target.value),placeholder:'[事件通知] {nickname} 对你之前的消息做出了"{emoji}"的表情回应。{context}这是对你消息的反馈，你可以简短回应表示感谢或互动，也可以选择不回复。',rows:2}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"留空使用默认模板"})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"取消回应提示词"}),(0,s.jsx)(m.Textarea,{value:Q.features?.reaction?.removePrompt||"",onChange:e=>ev("features.reaction.removePrompt",e.target.value),placeholder:'[事件通知] {nickname} 取消了对你之前消息的"{emoji}"表情回应。{context}你可以忽略这个事件，也可以简短回应。',rows:2}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"留空使用默认模板"})]}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["支持占位符: ","{nickname}"," 用户昵称, ","{emoji}"," 表情, ","{message}"," 原消息,"," ","{context}"," 上下文, ","{action}"," 动作类型, ","{action_text}"," 动作描述,"," ","{user_id}"," 用户ID, ","{group_id}"," 群号"]})]})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsx)(r.CardTitle,{children:"消息撤回响应"})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"启用"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"群成员撤回消息时响应"})]}),(0,s.jsx)(d.Switch,{checked:Q.features?.recall?.enabled??!1,onCheckedChange:e=>ev("features.recall.enabled",e)})]}),Q.features?.recall?.enabled&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(i.Label,{children:"响应概率"}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:[Math.round((Q.features?.recall?.probability??1)*100),"%"]})]}),(0,s.jsx)(h.Slider,{value:[Q.features?.recall?.probability??1],onValueChange:([e])=>ev("features.recall.probability",e),min:0,max:1,step:.05})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"AI响应"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"使用AI人设调侃撤回"})]}),(0,s.jsx)(d.Switch,{checked:Q.features?.recall?.aiResponse??!0,onCheckedChange:e=>ev("features.recall.aiResponse",e)})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"自定义提示词"}),(0,s.jsx)(m.Textarea,{value:Q.features?.recall?.prompt||"",onChange:e=>ev("features.recall.prompt",e.target.value),placeholder:"[事件通知] {nickname} 刚刚撤回了一条消息{message_hint}。你可以调侃一下，也可以忽略。",rows:2}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["支持占位符: ","{nickname}",", ","{message}"," 撤回的消息内容, ","{message_hint}"," ","智能消息提示, ","{time}"," 时间, ","{group_name}"]})]})]})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsx)(r.CardTitle,{children:"入群欢迎"})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"启用"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"新成员入群时发送欢迎消息"})]}),(0,s.jsx)(d.Switch,{checked:Q.features?.welcome?.enabled??!1,onCheckedChange:e=>ev("features.welcome.enabled",e)})]}),Q.features?.welcome?.enabled&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(i.Label,{children:"响应概率"}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:[Math.round((Q.features?.welcome?.probability??1)*100),"%"]})]}),(0,s.jsx)(h.Slider,{value:[Q.features?.welcome?.probability??1],onValueChange:([e])=>ev("features.welcome.probability",e),min:0,max:1,step:.05}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"全局默认概率，群组可覆盖"})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"默认欢迎语"}),(0,s.jsx)(t.Input,{value:Q.features?.welcome?.message||"",onChange:e=>ev("features.welcome.message",e.target.value),placeholder:"留空则使用AI生成"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"留空时使用AI人设生成欢迎语"})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"自定义提示词"}),(0,s.jsx)(m.Textarea,{value:Q.features?.welcome?.prompt||"",onChange:e=>ev("features.welcome.prompt",e.target.value),placeholder:"[事件通知] {nickname} 刚刚加入了群聊。请用你的人设性格给出一个简短友好的欢迎语。",rows:2}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["支持占位符: ","{nickname}"," 用户昵称, ","{user_id}"," 用户ID, ","{group_name}"," ","群名"]})]})]})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsx)(r.CardTitle,{children:"退群通知"})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"启用"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"成员退群时发送通知"})]}),(0,s.jsx)(d.Switch,{checked:Q.features?.goodbye?.enabled??!1,onCheckedChange:e=>ev("features.goodbye.enabled",e)})]}),Q.features?.goodbye?.enabled&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(i.Label,{children:"响应概率"}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:[Math.round((Q.features?.goodbye?.probability??1)*100),"%"]})]}),(0,s.jsx)(h.Slider,{value:[Q.features?.goodbye?.probability??1],onValueChange:([e])=>ev("features.goodbye.probability",e),min:0,max:1,step:.05}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"全局默认概率，群组可覆盖"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"AI响应"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"使用AI人设表达"})]}),(0,s.jsx)(d.Switch,{checked:Q.features?.goodbye?.aiResponse??!1,onCheckedChange:e=>ev("features.goodbye.aiResponse",e)})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"自定义提示词"}),(0,s.jsx)(m.Textarea,{value:Q.features?.goodbye?.prompt||"",onChange:e=>ev("features.goodbye.prompt",e.target.value),placeholder:"[事件通知] {nickname} {action}了群聊。你可以简短表达一下，也可以忽略。",rows:2}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["支持占位符: ","{nickname}",", ","{action}"," (退出/被踢出), ","{operator}"," ","踢人者, ","{leave_reason}"," 智能原因, ","{group_name}"]})]})]})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsx)(r.CardTitle,{children:"禁言事件响应"})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"启用"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"群成员被禁言/解禁时响应"})]}),(0,s.jsx)(d.Switch,{checked:Q.features?.ban?.enabled??!1,onCheckedChange:e=>ev("features.ban.enabled",e)})]}),Q.features?.ban?.enabled&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(i.Label,{children:"响应概率"}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:[Math.round((Q.features?.ban?.probability??1)*100),"%"]})]}),(0,s.jsx)(h.Slider,{value:[Q.features?.ban?.probability??1],onValueChange:([e])=>ev("features.ban.probability",e),min:0,max:1,step:.05})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"AI响应"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"使用AI人设评论禁言事件"})]}),(0,s.jsx)(d.Switch,{checked:Q.features?.ban?.aiResponse??!0,onCheckedChange:e=>ev("features.ban.aiResponse",e)})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"自定义提示词"}),(0,s.jsx)(m.Textarea,{value:Q.features?.ban?.prompt||"",onChange:e=>ev("features.ban.prompt",e.target.value),placeholder:"[事件通知] {nickname} 被 {operator} {action}。你可以简短评论一下，也可以忽略。",rows:2}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["支持占位符: ","{nickname}"," 被禁言者, ","{operator}"," 操作者, ","{action}",","," ","{duration_text}",", ","{sub_type}"," (ban/lift_ban)"]})]})]})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsx)(r.CardTitle,{children:"运气王响应"})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"启用"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"机器人成为运气王时庆祝"})]}),(0,s.jsx)(d.Switch,{checked:Q.features?.luckyKing?.enabled??!1,onCheckedChange:e=>ev("features.luckyKing.enabled",e)})]}),Q.features?.luckyKing?.enabled&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(i.Label,{children:"响应概率"}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:[Math.round((Q.features?.luckyKing?.probability??1)*100),"%"]})]}),(0,s.jsx)(h.Slider,{value:[Q.features?.luckyKing?.probability??1],onValueChange:([e])=>ev("features.luckyKing.probability",e),min:0,max:1,step:.05})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"祝贺他人"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"其他人成为运气王时也祝贺"})]}),(0,s.jsx)(d.Switch,{checked:Q.features?.luckyKing?.congratulate??!1,onCheckedChange:e=>ev("features.luckyKing.congratulate",e)})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"自定义提示词"}),(0,s.jsx)(m.Textarea,{value:Q.features?.luckyKing?.prompt||"",onChange:e=>ev("features.luckyKing.prompt",e.target.value),placeholder:"[事件通知] {nickname} 成为了红包运气王！{action}",rows:2}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["支持占位符: ","{nickname}",", ","{action}"," (机器人:请表达开心/他人:可以祝贺)"]})]})]})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsx)(r.CardTitle,{children:"荣誉变更响应"})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"启用"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"机器人获得龙王、群聊之火等荣誉时响应"})]}),(0,s.jsx)(d.Switch,{checked:Q.features?.honor?.enabled??!1,onCheckedChange:e=>ev("features.honor.enabled",e)})]}),Q.features?.honor?.enabled&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(i.Label,{children:"响应概率"}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:[Math.round((Q.features?.honor?.probability??1)*100),"%"]})]}),(0,s.jsx)(h.Slider,{value:[Q.features?.honor?.probability??1],onValueChange:([e])=>ev("features.honor.probability",e),min:0,max:1,step:.05})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"自定义提示词"}),(0,s.jsx)(m.Textarea,{value:Q.features?.honor?.prompt||"",onChange:e=>ev("features.honor.prompt",e.target.value),placeholder:'[事件通知] 你获得了群荣誉"{honor}"！请简短表达一下。',rows:2}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["支持占位符: ","{honor}"," 荣誉名称(龙王/群聊之火等), ","{group_name}"]})]})]})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsx)(r.CardTitle,{children:"精华消息响应"})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"启用"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"机器人的消息被设为精华时响应"})]}),(0,s.jsx)(d.Switch,{checked:Q.features?.essence?.enabled??!1,onCheckedChange:e=>ev("features.essence.enabled",e)})]}),Q.features?.essence?.enabled&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(i.Label,{children:"响应概率"}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:[Math.round((Q.features?.essence?.probability??1)*100),"%"]})]}),(0,s.jsx)(h.Slider,{value:[Q.features?.essence?.probability??1],onValueChange:([e])=>ev("features.essence.probability",e),min:0,max:1,step:.05})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"自定义提示词"}),(0,s.jsx)(m.Textarea,{value:Q.features?.essence?.prompt||"",onChange:e=>ev("features.essence.prompt",e.target.value),placeholder:"[事件通知] {operator} 把你之前发的消息设置成了精华消息！请简短表达一下。",rows:2}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["支持占位符: ","{operator}"," 操作者昵称, ","{group_name}"]})]})]})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsx)(r.CardTitle,{children:"管理员变更响应"})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"启用"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"机器人成为/取消管理员时响应"})]}),(0,s.jsx)(d.Switch,{checked:Q.features?.admin?.enabled??!1,onCheckedChange:e=>ev("features.admin.enabled",e)})]}),Q.features?.admin?.enabled&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(i.Label,{children:"响应概率"}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:[Math.round((Q.features?.admin?.probability??1)*100),"%"]})]}),(0,s.jsx)(h.Slider,{value:[Q.features?.admin?.probability??1],onValueChange:([e])=>ev("features.admin.probability",e),min:0,max:1,step:.05})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"自定义提示词"}),(0,s.jsx)(m.Textarea,{value:Q.features?.admin?.prompt||"",onChange:e=>ev("features.admin.prompt",e.target.value),placeholder:"[事件通知] 你{action}！请简短表达一下。",rows:2}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["支持占位符: ","{action}"," (被设置成了群管理员/的管理员身份被取消了)"]})]})]})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsx)(r.CardTitle,{children:"错误处理"})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"错误时自动结清"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"API返回错误时自动删除对话历史"})]}),(0,s.jsx)(d.Switch,{checked:Q.features?.autoCleanOnError?.enabled??!1,onCheckedChange:e=>ev("features.autoCleanOnError.enabled",e)})]}),Q.features?.autoCleanOnError?.enabled&&(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(i.Label,{children:"提示用户"}),(0,s.jsx)(d.Switch,{checked:Q.features?.autoCleanOnError?.notifyUser??!0,onCheckedChange:e=>ev("features.autoCleanOnError.notifyUser",e)})]})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsx)(r.CardTitle,{children:"长期记忆"})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"启用记忆"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"AI会记住用户透露的个人信息和偏好"})]}),(0,s.jsx)(d.Switch,{checked:Q.memory?.enabled??!1,onCheckedChange:e=>ev("memory.enabled",e)})]}),Q.memory?.enabled&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"自动提取"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"自动从对话中提取值得记忆的信息"})]}),(0,s.jsx)(d.Switch,{checked:Q.memory?.autoExtract??!0,onCheckedChange:e=>ev("memory.autoExtract",e)})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"记忆提取模型"}),(0,s.jsx)(t.Input,{value:Q.memory?.model||"",onChange:e=>ev("memory.model",e.target.value),placeholder:"留空使用默认模型"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"用于记忆提取和总结的模型，留空则使用全局默认模型"})]})]})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsxs)(r.CardHeader,{children:[(0,s.jsx)(r.CardTitle,{children:"定时总结推送"}),(0,s.jsx)(r.CardDescription,{children:"按设定间隔自动向群聊推送消息总结，跳过已关闭的群"})]}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"全局启用"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"启用定时群聊总结推送功能"})]}),(0,s.jsx)(d.Switch,{checked:Q.memory?.summaryPush?.enabled??!1,onCheckedChange:e=>ev("memory.summaryPush.enabled",e)})]}),Q.memory?.summaryPush?.enabled&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.Separator,{}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{children:"间隔类型"}),(0,s.jsxs)(j.Select,{value:Q.memory?.summaryPush?.intervalType||"day",onValueChange:e=>ev("memory.summaryPush.intervalType",e),children:[(0,s.jsx)(j.SelectTrigger,{children:(0,s.jsx)(j.SelectValue,{})}),(0,s.jsxs)(j.SelectContent,{children:[(0,s.jsx)(j.SelectItem,{value:"day",children:"按天"}),(0,s.jsx)(j.SelectItem,{value:"hour",children:"按小时"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{children:"间隔值"}),(0,s.jsx)(t.Input,{type:"number",min:1,value:Q.memory?.summaryPush?.defaultInterval||1,onChange:e=>ev("memory.summaryPush.defaultInterval",parseInt(e.target.value)||1)})]}),"day"===(Q.memory?.summaryPush?.intervalType||"day")&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{children:"推送时间"}),(0,s.jsxs)(j.Select,{value:String(Q.memory?.summaryPush?.defaultPushHour??22),onValueChange:e=>ev("memory.summaryPush.defaultPushHour",parseInt(e)),children:[(0,s.jsx)(j.SelectTrigger,{children:(0,s.jsx)(j.SelectValue,{})}),(0,s.jsx)(j.SelectContent,{children:Array.from({length:24},(e,a)=>(0,s.jsxs)(j.SelectItem,{value:String(a),children:[a.toString().padStart(2,"0"),":00"]},a))})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{children:"消息数量"}),(0,s.jsx)(t.Input,{type:"number",min:10,max:500,value:Q.memory?.summaryPush?.maxMessages||300,onChange:e=>ev("memory.summaryPush.maxMessages",parseInt(e.target.value)||100)})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{children:"检查间隔（分钟）"}),(0,s.jsx)(t.Input,{type:"number",min:1,value:Q.memory?.summaryPush?.checkInterval||60,onChange:e=>ev("memory.summaryPush.checkInterval",parseInt(e.target.value)||60)}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"检查是否需要推送的间隔"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{children:"总结模型"}),(0,s.jsxs)(j.Select,{value:Q.memory?.summaryPush?.model||"__default__",onValueChange:e=>ev("memory.summaryPush.model","__default__"===e?"":e),children:[(0,s.jsx)(j.SelectTrigger,{children:(0,s.jsx)(j.SelectValue,{placeholder:"使用默认模型"})}),(0,s.jsxs)(j.SelectContent,{children:[(0,s.jsx)(j.SelectItem,{value:"__default__",children:"使用默认总结模型"}),W.map(e=>(0,s.jsx)(j.SelectItem,{value:e,children:e},e))]})]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"未配置则使用「群聊总结」模型或默认模型"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"使用LLM生成总结"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"调用AI模型生成智能总结"})]}),(0,s.jsx)(d.Switch,{checked:Q.memory?.summaryPush?.useLLM??!0,onCheckedChange:e=>ev("memory.summaryPush.useLLM",e)})]})]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"群组独立配置请在「群组管理」中设置，已关闭推送的群将被跳过"})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsx)(r.CardTitle,{children:"表情包小偷"})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"全局启用"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"所有群默认开启表情包收集"})]}),(0,s.jsx)(d.Switch,{checked:Q.features?.emojiThief?.globalEnabled??!1,onCheckedChange:e=>ev("features.emojiThief.globalEnabled",e)})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Label,{children:"群独立文件夹"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"每个群的表情存储到独立文件夹"})]}),(0,s.jsx)(d.Switch,{checked:Q.features?.emojiThief?.separateFolder??!1,onCheckedChange:e=>ev("features.emojiThief.separateFolder",e)})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"每群最大表情数"}),(0,s.jsx)(t.Input,{type:"number",value:Q.features?.emojiThief?.maxCount||1e3,onChange:e=>ev("features.emojiThief.maxCount",parseInt(e.target.value))})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"收集概率 (0-1)"}),(0,s.jsx)(t.Input,{type:"number",step:"0.1",min:0,max:1,value:Q.features?.emojiThief?.stealRate??1,onChange:e=>ev("features.emojiThief.stealRate",parseFloat(e.target.value))}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"看到表情包时收集的概率"})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"触发模式"}),(0,s.jsxs)(j.Select,{value:Q.features?.emojiThief?.triggerMode||"chat_random",onValueChange:e=>ev("features.emojiThief.triggerMode",e),children:[(0,s.jsx)(j.SelectTrigger,{children:(0,s.jsx)(j.SelectValue,{})}),(0,s.jsxs)(j.SelectContent,{children:[(0,s.jsx)(j.SelectItem,{value:"off",children:"仅收集（不发送）"}),(0,s.jsx)(j.SelectItem,{value:"random",children:"随机触发"}),(0,s.jsx)(j.SelectItem,{value:"bym_follow",children:"伪人跟随"}),(0,s.jsx)(j.SelectItem,{value:"bym_random",children:"伪人随机"}),(0,s.jsx)(j.SelectItem,{value:"chat_follow",children:"对话跟随"}),(0,s.jsx)(j.SelectItem,{value:"chat_random",children:"对话随机"})]})]})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"触发概率 (0-1)"}),(0,s.jsx)(t.Input,{type:"number",step:"0.05",min:0,max:1,value:Q.features?.emojiThief?.triggerRate??.1,onChange:e=>ev("features.emojiThief.triggerRate",parseFloat(e.target.value))}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"触发发送表情包的概率"})]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"群组独立配置请在「群组管理」中设置"})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsx)(r.CardTitle,{children:"触发黑白名单"})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"用户黑名单"}),(0,s.jsx)(v,{value:Q.trigger?.blacklistUsers||[],onChange:e=>ev("trigger.blacklistUsers",e),placeholder:"输入QQ号后回车"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"这些用户的消息将被忽略"})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"用户白名单"}),(0,s.jsx)(v,{value:Q.trigger?.whitelistUsers||[],onChange:e=>ev("trigger.whitelistUsers",e),placeholder:"输入QQ号后回车"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"留空表示不限制，有值时仅这些用户可触发"})]}),(0,s.jsx)(o.Separator,{}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"群黑名单"}),(0,s.jsx)(v,{value:Q.trigger?.blacklistGroups||[],onChange:e=>ev("trigger.blacklistGroups",e),placeholder:"输入群号后回车"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"这些群的消息将被忽略"})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(i.Label,{children:"群白名单"}),(0,s.jsx)(v,{value:Q.trigger?.whitelistGroups||[],onChange:e=>ev("trigger.whitelistGroups",e),placeholder:"输入群号后回车"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"留空表示不限制，有值时仅这些群可触发"})]})]})]})]})]}),(0,s.jsx)(y.Dialog,{open:et,onOpenChange:en,children:(0,s.jsxs)(y.DialogContent,{className:"w-[95vw] max-w-2xl max-h-[85vh] sm:max-h-[80vh] flex flex-col overflow-hidden",children:[(0,s.jsxs)(y.DialogHeader,{className:"flex-shrink-0",children:[(0,s.jsxs)(y.DialogTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(_.Settings2,{className:"h-5 w-5"}),"配置",B[ei]]}),(0,s.jsx)(y.DialogDescription,{children:ef()?"选择一个模型（多个渠道支持此模型时自动轮询）":"选择多个备选模型，按优先级排序"})]}),(0,s.jsx)("div",{className:"flex-1 overflow-hidden min-h-0",children:(0,s.jsx)(C.ModelSelector,{value:ec,allModels:Z,onChange:ex,singleSelect:ef()})}),(0,s.jsxs)(y.DialogFooter,{className:"flex-shrink-0 pt-4 border-t mt-2 gap-2 sm:gap-0",children:[(0,s.jsx)(n.Button,{variant:"outline",onClick:()=>en(!1),className:"flex-1 sm:flex-none",children:"取消"}),(0,s.jsxs)(n.Button,{onClick:()=>{Q&&("default"===ei?ev("llm.defaultModel",ec[0]||""):"fallback"===ei?ev("llm.fallback.models",ec):ev(`llm.models.${ei}`,ec[0]||""),en(!1))},className:"flex-1 sm:flex-none",children:["确认选择 (",ec.length,")"]})]})]})})]}):(0,s.jsx)("div",{children:"加载失败"})}e.s(["default",()=>U],58088)}]);